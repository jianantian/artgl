{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/views/scene-panel/scene-node-view.vue?ec7d","webpack:///./src/views/config-panel.vue?edb7","webpack:///./src/components/conf/select.vue?d874","webpack:///./src/assets/artgl.svg","webpack:///./src/views/scene-panel/geometry-view.vue?11ca","webpack:///./src/components/graph/graph-viewer.vue?924f","webpack:///./src/App.vue?926f","webpack:///./src/views/shader-editor.vue?2425","webpack:///./src/views/example/example-page.vue?f4f6","webpack:///./src/views/line-hud-canvas.vue?7f78","webpack:///./src/components/conf/config.vue?560a","webpack:///./src/components/conf/number.vue?9af8","webpack:///./src/views/home.vue?46ec","webpack:///./src/views/object-panel/object-panel.vue?f7ae","webpack:///./src/views/scene-panel/scene-panel.vue?454a","webpack:///./src/components/conf/folder.vue?2287","webpack:///./src/components/conf/item.vue?8f79","webpack:///./src/components/nav/top-nav.vue?faca","webpack:///./src/components/conf/editors.vue?94d7","webpack:///./src/views/viewer-canvas.vue?cae0","webpack:///./src/assets/art.svg","webpack:///./src/views/viewer.vue?c632","webpack:///./src/App.vue?7a39","webpack:///./src/components/nav/top-nav.vue?79ae","webpack:///./src/components/nav/top-nav.vue?655d","webpack:///./src/components/nav/top-nav.vue?6e15","webpack:///./src/components/nav/top-nav.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?bfbe","webpack:///./src/App.vue","webpack:///./src/views/home.vue?cf01","webpack:///./src/views/home.vue","webpack:///./src/views/viewer.vue?ead3","webpack:///./src/views/config-panel.vue?af9a","webpack:///./src/components/conf/config.vue?4fab","webpack:///./src/components/conf/folder.vue?39ce","webpack:///./src/components/conf/item.vue?a87f","webpack:///./src/components/conf/editors.vue?7cc6","webpack:///./src/components/conf/number-slider.vue?08fa","webpack:///./src/components/conf/number-slider.vue?793d","webpack:///./src/components/conf/number-slider.vue?3c5a","webpack:///./src/components/conf/number-slider.vue","webpack:///./src/components/conf/editors.vue?a671","webpack:///./src/components/conf/editors.vue?1ad0","webpack:///./src/components/conf/editors.vue","webpack:///./src/components/conf/number.vue?296d","webpack:///./src/components/conf/number.vue?a266","webpack:///./src/components/conf/number.vue?18ee","webpack:///./src/components/conf/number.vue","webpack:///./src/components/conf/boolean.vue?8a27","webpack:///./src/components/conf/boolean.vue?7b72","webpack:///./src/components/conf/boolean.vue?e141","webpack:///./src/components/conf/boolean.vue","webpack:///./src/components/conf/select.vue?d25f","webpack:///./src/components/conf/select.vue?4aef","webpack:///./src/components/conf/select.vue?0425","webpack:///./src/components/conf/select.vue","webpack:///./src/components/conf/item.vue?e0f7","webpack:///./src/components/conf/item.vue?f29a","webpack:///./src/components/conf/item.vue","webpack:///./src/components/conf/folder.vue?0a40","webpack:///./src/components/conf/folder.vue?0004","webpack:///./src/components/conf/folder.vue","webpack:///./src/components/conf/config.vue?0145","webpack:///../src/webgl/gl-info.ts","webpack:///./src/components/conf/config.vue?ec76","webpack:///./src/components/conf/config.vue","webpack:///../src/webgl/shader.ts","webpack:///../src/math/uuid.ts","webpack:///../src/math/vector3.ts","webpack:///../src/math/vector4.ts","webpack:///../src/math/matrix4.ts","webpack:///../src/math/util.ts","webpack:///../src/math/euler.ts","webpack:///../src/math/quaternion.ts","webpack:///../src/math/vector2.ts","webpack:///../src/webgl/shader-util.ts","webpack:///../src/webgl/uniform/uniform-util.ts","webpack:///../src/webgl/uniform/uniform.ts","webpack:///../src/webgl/attribute.ts","webpack:///../src/webgl/uniform/uniform-texture.ts","webpack:///../src/webgl/const.ts","webpack:///../src/webgl/program.ts","webpack:///../src/webgl/program-manager.ts","webpack:///../src/webgl/attribute-buffer-manager.ts","webpack:///../src/webgl/states/gl-color-buffer.ts","webpack:///../src/webgl/states/gl-depth-buffer.ts","webpack:///../src/webgl/states/gl-texture-slot.ts","webpack:///../src/webgl/states/gl-state.ts","webpack:///../src/webgl/texture-manager.ts","webpack:///../src/core/texture.ts","webpack:///../src/webgl/gl-framebuffer.ts","webpack:///../src/webgl/framebuffer-manager.ts","webpack:///../src/webgl/gl-stat.ts","webpack:///../src/webgl/vao.ts","webpack:///../src/webgl/gl-renderer.ts","webpack:///../src/math/observable/vector3-observable.ts","webpack:///../src/scene/transformation.ts","webpack:///../src/scene/scene-node.ts","webpack:///../src/core/camera.ts","webpack:///../src/camera/perspective-camera.ts","webpack:///../src/engine/uniform-proxy.ts","webpack:///../src/core/observable.ts","webpack:///../src/core/draw-state.ts","webpack:///../src/core/render-object.ts","webpack:///../src/math/entity/sphere.ts","webpack:///../src/object/mesh.ts","webpack:///../src/math/entity/box3.ts","webpack:///../src/core/geometry.ts","webpack:///../src/math/entity/face3.ts","webpack:///../src/math/entity/line3.ts","webpack:///../src/core/buffer-data.ts","webpack:///../src/geometry/standard-geometry.ts","webpack:///../src/geometry/geo-lib/plane-geometry.ts","webpack:///../src/render-graph/quad-source.ts","webpack:///../src/util/file-io.ts","webpack:///../src/util/array.ts","webpack:///../src/shader-graph/util/indent.ts","webpack:///../src/shader-graph/util/code-builder.ts","webpack:///../src/core/dag-node.ts","webpack:///../src/shader-graph/shader-node.ts","webpack:///../src/shader-graph/code-gen.ts","webpack:///../src/shader-graph/parser/shader-function-meta.ts","webpack:///../src/shader-graph/shader-function.ts","webpack:///../src/shader-graph/built-in/transform.ts","webpack:///../src/shader-graph/node-maker.ts","webpack:///../src/shader-graph/shader-graph.ts","webpack:///../src/core/shading.ts","webpack:///../src/shading/pass-lib/copy.ts","webpack:///../src/interact/interactor.ts","webpack:///../src/engine/render-engine.ts","webpack:///../src/util/accumulator.ts","webpack:///../src/engine/framer.ts","webpack:///../src/object/line.ts","webpack:///../src/object/points.ts","webpack:///../src/core/material.ts","webpack:///../src/render-graph/interface.ts","webpack:///../src/engine/render-list.ts","webpack:///../src/scene/scene.ts","webpack:///../src/render-graph/pass.ts","webpack:///../src/render-graph/render-graph.ts","webpack:///../src/render-graph/node/render-target-node.ts","webpack:///../src/render-graph/node/pass-graph-node.ts","webpack:///../src/shading/basic-lib/normal.ts","webpack:///../src/shader-graph/built-in/depth-pack.ts","webpack:///../src/shader-graph/built-in/rand.ts","webpack:///../src/shading/pass-lib/tssao.ts","webpack:///../src/shading/pass-lib/tssao-blend.ts","webpack:///../src/shading/basic-lib/depth.ts","webpack:///../src/shading/pass-lib/taa.ts","webpack:///../src/core/light.ts","webpack:///../src/light/ambient-light.ts","webpack:///../src/light/directional-light.ts","webpack:///../src/light/point-light.ts","webpack:///../src/geometry/geo-lib/sphere-geometry.ts","webpack:///../src/geometry/geo-lib/cube-geometry.ts","webpack:///../src/interact/controller.ts","webpack:///../src/math/spherical.ts","webpack:///../src/interact/orbit-controller.ts","webpack:///../src/util/normal-generation.ts","webpack:///../src/core/loader.ts","webpack:///../src/loader/obj-loader.ts","webpack:///../src/shading/basic-lib/exposurer.ts","webpack:///./src/scene/hierarchy-balls.ts","webpack:///./src/conf.ts","webpack:///./src/RenderPipeline.ts","webpack:///../src/math/entity/ray.ts","webpack:///../src/core/raycaster.ts","webpack:///./src/application.ts","webpack:///./src/views/config-panel.vue?b46a","webpack:///./src/views/config-panel.vue?0f1f","webpack:///./src/views/config-panel.vue","webpack:///./src/views/scene-panel/scene-panel.vue?d3e3","webpack:///./src/model/scene-view.ts","webpack:///./src/model/render-view.ts","webpack:///./src/views/scene-panel/geometry-view.vue?6d57","webpack:///./src/views/scene-panel/geometry-view.vue?b347","webpack:///./src/views/scene-panel/geometry-view.vue?9d76","webpack:///./src/views/scene-panel/geometry-view.vue","webpack:///./src/views/scene-panel/material-view.vue?54b2","webpack:///./src/views/scene-panel/channel-editor.vue?5334","webpack:///./src/views/scene-panel/channel-editor.vue?fdcd","webpack:///./src/views/scene-panel/channel-editor.vue?dff2","webpack:///./src/views/scene-panel/channel-editor.vue","webpack:///./src/views/scene-panel/material-view.vue?b52e","webpack:///./src/views/scene-panel/material-view.vue?11b7","webpack:///./src/views/scene-panel/material-view.vue","webpack:///./src/views/object-panel/object-panel.vue?e8ee","webpack:///./src/views/object-panel/object-panel.vue?e283","webpack:///./src/views/object-panel/object-panel.vue?5887","webpack:///./src/views/object-panel/object-panel.vue","webpack:///./src/views/scene-panel/scene-node-view.vue?1e16","webpack:///./src/views/scene-panel/scene-node-view.vue?a675","webpack:///./src/views/scene-panel/scene-node-view.vue?a9f2","webpack:///./src/views/scene-panel/scene-node-view.vue","webpack:///./src/views/scene-panel/scene-panel.vue?9e66","webpack:///./src/views/scene-panel/scene-panel.vue?6400","webpack:///./src/views/scene-panel/scene-panel.vue","webpack:///./src/views/viewer-canvas.vue?606f","webpack:///./src/components/graph/graph-viewer.vue?1fa4","webpack:///./src/components/graph/graph-viewer.vue?eca9","webpack:///./src/components/graph/graph-viewer.vue?8cac","webpack:///./src/components/graph/graph-viewer.vue","webpack:///./src/components/graph/dag-node.vue?aec6","webpack:///./src/model/graph-view.ts","webpack:///./src/components/graph/dag-node.vue?67ce","webpack:///./src/components/graph/dag-node.vue?02cd","webpack:///./src/components/graph/dag-node.vue","webpack:///./src/views/line-hud-canvas.vue?7abb","webpack:///./src/views/line-hud-canvas.vue?3ab1","webpack:///./src/views/line-hud-canvas.vue?3432","webpack:///./src/views/line-hud-canvas.vue","webpack:///./src/components/graph/nodes/render-target-node.vue?5102","webpack:///./src/components/graph/nodes/render-target-node.vue?65b0","webpack:///./src/components/graph/nodes/render-target-node.vue?01a6","webpack:///./src/components/graph/nodes/render-target-node.vue","webpack:///./src/views/viewer-canvas.vue?96ac","webpack:///./src/views/viewer-canvas.vue?bd6a","webpack:///./src/views/viewer-canvas.vue","webpack:///./src/views/viewer.vue?bd8b","webpack:///./src/views/viewer.vue?dac9","webpack:///./src/views/viewer.vue","webpack:///./src/views/shader-editor.vue?f58f","webpack:///./src/shader-application.ts","webpack:///./src/components/graph/nodes/shader-function-node.vue?df7f","webpack:///./src/components/graph/nodes/shader-function-node.vue?b695","webpack:///./src/components/graph/nodes/shader-function-node.vue?c668","webpack:///./src/components/graph/nodes/shader-function-node.vue","webpack:///./src/views/shader-editor.vue?8b7a","webpack:///./src/views/shader-editor.vue?89f8","webpack:///./src/views/shader-editor.vue","webpack:///./src/views/debug.vue?f79e","webpack:///./src/views/debug.vue?3397","webpack:///./src/views/debug.vue?da2a","webpack:///./src/views/debug.vue","webpack:///./src/views/example/example-page.vue?6fc1","webpack:///./src/views/example/example-page.vue?c633","webpack:///./src/views/example/example-page.vue?7734","webpack:///./src/views/example/example-page.vue","webpack:///./src/views/example/example-item-page.vue?a433","webpack:///../example/contents/test-bridge.ts","webpack:///./src/views/example/example-item-page.vue?4142","webpack:///./src/views/example/example-item-page.vue?6367","webpack:///./src/views/example/example-item-page.vue","webpack:///./src/router.ts","webpack:///../example/contents/render-range.ts","webpack:///../example/contents/draw-primitives.ts","webpack:///../example/contents/exports.ts","webpack:///./src/store.ts","webpack:///./src/main.ts","webpack:///./src/components/graph/dag-node.vue?69ba","webpack:///./src/views/example/example-item-page.vue?7df0"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","jsonpScriptSrc","p","about","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","error","Error","request","undefined","setTimeout","head","appendChild","all","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_scene_node_view_vue_vue_type_style_index_0_id_85464e1a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_scene_node_view_vue_vue_type_style_index_0_id_85464e1a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_config_panel_vue_vue_type_style_index_0_id_035897bd_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_config_panel_vue_vue_type_style_index_0_id_035897bd_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_select_vue_vue_type_style_index_0_id_4d845963_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_select_vue_vue_type_style_index_0_id_4d845963_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_geometry_view_vue_vue_type_style_index_0_id_6d5074e5_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_geometry_view_vue_vue_type_style_index_0_id_6d5074e5_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_graph_viewer_vue_vue_type_style_index_0_id_20b4d88e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_graph_viewer_vue_vue_type_style_index_0_id_20b4d88e_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_shader_editor_vue_vue_type_style_index_0_id_71476dfb_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_shader_editor_vue_vue_type_style_index_0_id_71476dfb_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_example_page_vue_vue_type_style_index_0_id_049970b3_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_example_page_vue_vue_type_style_index_0_id_049970b3_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_line_hud_canvas_vue_vue_type_style_index_0_id_4cfbac3a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_line_hud_canvas_vue_vue_type_style_index_0_id_4cfbac3a_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_config_vue_vue_type_style_index_0_id_2d21bbf9_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_config_vue_vue_type_style_index_0_id_2d21bbf9_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_number_vue_vue_type_style_index_0_id_4393da8d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_number_vue_vue_type_style_index_0_id_4393da8d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_home_vue_vue_type_style_index_0_id_70f84b50_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_home_vue_vue_type_style_index_0_id_70f84b50_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_object_panel_vue_vue_type_style_index_0_id_1d29f434_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_object_panel_vue_vue_type_style_index_0_id_1d29f434_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_scene_panel_vue_vue_type_style_index_0_id_2e8def07_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_scene_panel_vue_vue_type_style_index_0_id_2e8def07_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_folder_vue_vue_type_style_index_0_id_a0e8d0e0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_folder_vue_vue_type_style_index_0_id_a0e8d0e0_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_item_vue_vue_type_style_index_0_id_40003b0d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_item_vue_vue_type_style_index_0_id_40003b0d_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_top_nav_vue_vue_type_style_index_0_id_7f659a97_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_top_nav_vue_vue_type_style_index_0_id_7f659a97_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_editors_vue_vue_type_style_index_0_id_50902bf1_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_editors_vue_vue_type_style_index_0_id_50902bf1_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_viewer_canvas_vue_vue_type_style_index_0_id_0bf133fc_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_viewer_canvas_vue_vue_type_style_index_0_id_0bf133fc_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_viewer_vue_vue_type_style_index_0_id_5760c40d_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_viewer_vue_vue_type_style_index_0_id_5760c40d_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","render","_vm","this","_h","$createElement","_c","_self","attrs","id","_e","staticRenderFns","top_navvue_type_template_id_7f659a97_scoped_true_render","staticClass","alt","on","click","gotoHome","active-class","to","_v","top_navvue_type_template_id_7f659a97_scoped_true_staticRenderFns","top_navvue_type_script_lang_ts_TopNav","vue_property_decorator","[object Object]","$router","tslib_es6","top_navvue_type_script_lang_ts_","nav_top_navvue_type_script_lang_ts_","component","componentNormalizer","top_nav","Appvue_type_script_lang_ts_ViewerApp","showTopNav","$route","components","TopNav","Appvue_type_script_lang_ts_","src_Appvue_type_script_lang_ts_","App_component","App","homevue_type_template_id_70f84b50_scoped_true_render","_m","homevue_type_template_id_70f84b50_scoped_true_staticRenderFns","home_component","home","viewervue_type_template_id_5760c40d_scoped_true_render","$store","state","appConfig","appConf","viewervue_type_template_id_5760c40d_scoped_true_staticRenderFns","config_panelvue_type_template_id_035897bd_scoped_true_render","hide","config","config_panelvue_type_template_id_035897bd_scoped_true_staticRenderFns","configvue_type_template_id_2d21bbf9_scoped_true_render","configvue_type_template_id_2d21bbf9_scoped_true_staticRenderFns","foldervue_type_template_id_a0e8d0e0_scoped_true_render","toggle","expand","_s","_l","subConfig","Array","isArray","model","callback","$$v","$set","expression","foldervue_type_template_id_a0e8d0e0_scoped_true_staticRenderFns","itemvue_type_template_id_40003b0d_scoped_true_render","valueConfig","configValue","list","selectItem","$event","expandEditor","shouldHaveCustomEditor","editorConfig","editors","itemvue_type_template_id_40003b0d_scoped_true_staticRenderFns","editorsvue_type_template_id_50902bf1_scoped_true_render","index","class","active-editor-nav","currentEditor","useEditor","editor","_value","editorsvue_type_template_id_50902bf1_scoped_true_staticRenderFns","number_slidervue_type_template_id_570e1f1b_render","directives","rawName","max","min","step","domProps","__r","number_slidervue_type_template_id_570e1f1b_staticRenderFns","number_slidervue_type_script_lang_ts_NumberSliderEditor","$emit","required","number_slidervue_type_script_lang_ts_","conf_number_slidervue_type_script_lang_ts_","number_slider_component","number_slider","editorsvue_type_script_lang_ts_Editors","isMultiEditor","NumberSliderEditor","editorsvue_type_script_lang_ts_","conf_editorsvue_type_script_lang_ts_","editors_component","numbervue_type_template_id_4393da8d_scoped_true_render","input","composing","numbervue_type_template_id_4393da8d_scoped_true_staticRenderFns","numbervue_type_script_lang_ts_NumberEditor","numbervue_type_script_lang_ts_","conf_numbervue_type_script_lang_ts_","number_component","number","booleanvue_type_template_id_50eb078e_render","checked","_i","change","$$a","$$el","$$c","$$i","concat","booleanvue_type_template_id_50eb078e_staticRenderFns","booleanvue_type_script_lang_ts_BooleanEditor","booleanvue_type_script_lang_ts_","conf_booleanvue_type_script_lang_ts_","boolean_component","conf_boolean","selectvue_type_template_id_4d845963_scoped_true_render","$$selectedVal","filter","options","selected","map","val","multiple","item","selectvue_type_template_id_4d845963_scoped_true_staticRenderFns","selectvue_type_script_lang_ts_SelectEditor","selectvue_type_script_lang_ts_","conf_selectvue_type_script_lang_ts_","select_component","conf_select","itemvue_type_script_lang_ts_ConfigItem","newValue","onChange","Editors","NumberEditor","BooleanEditor","SelectEditor","itemvue_type_script_lang_ts_","conf_itemvue_type_script_lang_ts_","item_component","foldervue_type_script_lang_ts_Folder","isEmptyList","ConfigItem","foldervue_type_script_lang_ts_","conf_foldervue_type_script_lang_ts_","folder_component","folder","configvue_type_script_lang_ts_ConfigPanel","Folder","GLExtList","GLParamList","configvue_type_script_lang_ts_","conf_configvue_type_script_lang_ts_","config_component","conf_config","EXTENSION_LIST","keys","PARAMETER_NAMES","GLInfo","gl","extensions","parameters","createAllExtension","getAllParams","getExtension","OES_element_index_uint","supportUintIndexDraw","ext","createExtension","extName","getParameter","ShaderType","GLShader","renderer","shader","createShader","vertex","VERTEX_SHADER","FRAGMENT_SHADER","source","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","log","getShaderInfoLog","logDebugShaderSource","deleteShader","warn","addLineNumbers","str","lines","split","join","chars","uuid","rnd","generateUUID","Math","random","vector3_Vector3","x","y","z","v","a","b","sqrt","mag","scalar","inv_length","multiplyScalar","abs","ax","ay","az","bx","by","bz","crossVectors","q","qx","qy","qz","qw","w","ix","iy","iz","iw","sinRadius","sin","polar","radius","azim","cos","elements","normalize","matrixWorldInverse","projectionMatrix","applyMatrix4","matrixWorld","tempMatrix","Matrix4","multiplyMatrices","getInverse","distanceToSquared","dx","dy","dz","Float32Array","array","offset","toArray","Vector4","isVector4","acos","minVal","maxVal","tempMin","set","tempMax","clamp","divideScalar","floor","ceil","round","alpha","v1","v2","subVectors","add","angle","epsilon","epsilon2","te","m11","m12","m13","m21","m22","m23","m31","m32","m33","PI","xx","yy","zz","xy","xz","yz","tempX","tempY","tempZ","me","fromArray","matrix","n11","n12","n13","n14","n21","n22","n23","n24","n31","n32","n33","n34","n41","n42","n43","n44","position","quaternion","scale","makeRotationFromQuaternion","setPosition","left","right","top","bottom","near","far","h","ae","be","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","throwOnDegenerate","t11","t12","t13","t14","det","msg","identity","detInv","origin","up","copy","sub","scaleXSq","scaleYSq","scaleZSq","x2","y2","z2","wx","wy","wz","theta","MathUtil","DEG2RAD","RAD2DEG","euclideanModulo","mapLinear","a1","a2","b1","b2","lerp","smoothstep","smootherstep","randInt","low","high","randFloat","randFloatSpread","range","degToRad","degrees","radToDeg","radians","isPowerOfTwo","nearestPowerOfTwo","pow","LN2","nextPowerOfTwo","EulerOrder","euler_tempMatrix","euler_Euler","order","_order","defaultOrder","onChangeCallback","_x","_y","_z","euler","update","XYZ","asin","atan2","YXZ","ZXY","ZYX","YZX","XZY","setFromRotationMatrix","optionalTarget","quaternion_r","EPS","quaternion_Quaternion","_w","axis","halfAngle","vFrom","vTo","dot","trace","c1","c2","c3","s1","s2","s3","Vector2","width","height","vector2_tempMin","vector2_tempMax","anchor","center","GLDataType","shaderStringMap","float","vec2","floatVec2","vec3","floatVec3","vec4","floatVec4","mat2","Mat2","mat3","Mat3","mat4","Mat4","sampler2D","reverseShaderStringMap","forEach","shaderAttributeStringInfo","stride","default","reverseShaderAttributeStringInfo","getShaderTypeStringFromGLDataType","getGLDataTypeStride","AttributeGLDataType2ShaderString","injectVertexShaderHeaders","shaderText","injectText","generateAttributeString","generateUniformString","generateVaryingString","injectFragmentShaderHeaders","generateTextureString","text","textures","texture","attributes","att","uniforms","uni","varyings","vary","findUniformSetter","setValue1f","setValue2fv","setValue3fv","setValue4fv","setValue2m","setValue3m","setValue4m","int","boolean","setValue1i","location","uniform1f","uniform2fv","uniform3fv","uniform4fv","uniform1i","uniformMatrix4fv","differNumber","newVal","oldVal","differArray","copyNumber","_target","copyArray","targetReal","findUniformDiffer","findUniformCopier","findUniformFlattener","flatten","InnerSupportUniform","InnerUniformMap","Map","getInnerUniformDescriptor","des","tempDescriptor","mapInner","descriptor","_innerGlobalUniform","MMatrix","VPMatrix","LastVPMatrix","uniform_GLUniform","program","programChangeId","glProgram","getProgram","getUniformLocation","isActive","flattener","setter","differ","copier","innerGlobal","receiveData","lastReceiveData","stat","uniformUpload","programSwitched","_programChangeId","enableUniformDiff","CommonAttribute","GLTextureType","DrawMode","CullSide","DepthFunction","BlendingMode","GLTextureTypeRaw","TextureFilter","TextureWrap","attribute_GLAttribute","angleInstanceExt","asInstance","getAttribLocation","glInfo","ANGLE_instanced_arrays","useInstance","instanceDivisor","buffer","bindBuffer","ARRAY_BUFFER","vertexAttribPointer","FLOAT","enableVertexAttribArray","vertexAttribDivisorANGLE","GLTextureUniform","webglTexture","slotManager","textureSlot","channel","channelType","currentActiveSlot","updateSlotTexture","fulfillProgramConfig","useIndex","uniformsIncludes","_hasUniformIncludesExpand","ui","program_GLProgram","globalUniforms","framebufferTextureMap","drawFrom","drawCount","instanceCount","useIndexDraw","_indexUINT","vertexShader","fragmentShader","fragment","compileShaders","createProgram","createGLResource","programManager","addNewProgram","indexUINT","framebufferName","uniformName","cb","conf","vertexShaderString","fragmentShaderString","autoInjectHeader","attachShader","linkProgram","getProgramParameter","LINK_STATUS","info","getProgramInfoLog","tex","attribute","useBuffer","useTexture","start","count","engine","getGlobalUniform","ELEMENT_ARRAY_BUFFER","dispose","deleteProgram","GLProgramManager","programs","storeId","compiledProgramsCount","size","GLAttributeBufferDataManager","buffers","WeakMap","arraybuffer","useForIndex","createBuffer","bufferData","STATIC_DRAW","has","deleteBuffer","delete","disposeBuffer","BlendEquation","BlendMode","PixelFormat","PixelDataType","SrcAlphaFactor","OneMinusSrcAlphaFactor","gl_color_buffer_GLColorBuffer","redMaskEnabled","greenMaskEnabled","blueMaskEnabled","alphaMaskEnabled","currentClearColor","resetDefaultClearColor","redMask","greenMask","blueMask","alphaMask","colorMask","newColor","premultipliedAlpha","equals","clearColor","setClearColor","defaultClearColor","clear","COLOR_BUFFER_BIT","gl_depth_buffer_GLDepthBuffer","currentDepthMask","currentDepthFunc","currentDepthClear","_enableTest","resetDefault","enableTest","enable","DEPTH_TEST","disable","DEPTH_BUFFER_BIT","depthMask","depthFunc","NeverDepth","NEVER","AlwaysDepth","ALWAYS","LessDepth","LESS","LessEqualDepth","LEQUAL","EqualDepth","EQUAL","GreaterEqualDepth","GEQUAL","GreaterDepth","GREATER","NotEqualDepth","NOTEQUAL","gl_texture_slot_GLTextureSlot","currentTextureSlot","currentBindTextures","slotIndex","maxSupport","MAX_TEXTURE_SIZE","generateTextureSlotMap","slot","activeTexture","webglType","TEXTURE0","boundTexture","bindTexture","textureSlotToUpdate","findSlot","textureSlotGLToUpdate","textureSlotMap","texture2D","maxTextureSlotSupport","gl_state_GLState","currentViewport","newViewport","currentScissor","newScissor","currentCullFace","CullFaceNone","currentPolygonOffsetFactor","currentPolygonOffsetUnits","colorbuffer","depthbuffer","viewport","setViewport","cullFace","CULL_FACE","CullFaceBack","BACK","CullFaceFront","FRONT","FRONT_AND_BACK","polygonOffsetEnable","factor","units","POLYGON_OFFSET_FILL","polygonOffset","DefaultTextureDescriptor","minFilter","nearest","maxFilter","sWrap","clampToEdge","tWrap","defaultRenderTargetTextureDescriptor","GLTextureManager","POTResizeCanvas","pixelStorei","UNPACK_FLIP_Y_WEBGL","glTexture","getGLTexture","deleteTexture","createWebGLTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","image","internalFormat","border","format","createTexture","texParameteri","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","texture_PixelFormat","texture_PixelDataType","Texture","needUpdate","RGBAFormat","dataType","textureManger","upload","releaseGraphics","deleteGLTexture","gl_framebuffer_FramebufferAttachTexture","createTextureForRenderTarget","framebuffer","attachPoint","setRenderTarget","attachmentPoint","GLAttachmentPoints","framebufferTexture2D","FRAMEBUFFER","loadGLAttachmentPoints","gl_framebuffer_GLFramebuffer","enableDepth","webglDepthBuffer","textureAttachedSlot","webglFrameBuffer","createGLFramebuffer","createFramebuffer","createRenderbuffer","deleteFramebuffer","attach","disposeAttachedDepthBuffer","createAttachDepthBuffer","attachTexture","depthBuffer","createGLRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","deleteRenderbuffer","readBuffer","readPixels","framebuffer_manager_GLFrameBufferManager","framebuffers","createAttachTexture","GLStat","drawcall","programSwitch","framebufferSwitch","faceDraw","vertexDraw","vao_GLVAOManager","vaos","vaoExt","OES_vertex_array_object","isSupported","geometry","vao","createVertexArrayOES","bindVertexArrayOES","unbind","gl_renderer_GLRenderer","el","enableRenderErrorCatch","_width","_height","devicePixelRatio","activeProgram","attributeBufferManager","currentFramebuffer","assign","antialias","ctx","getContext","framebufferManager","vaoManager","init","setSize","offsetWidth","offsetHeight","setRawRenderSize","isChanged","useProgram","drawElementsInstancedANGLE","UNSIGNED_INT","UNSIGNED_SHORT","drawArraysInstancedANGLE","drawElements","drawArrays","checkGLError","resetSlotIndex","TRIANGLES","errorCode","getError","NO_ERROR","bindFramebuffer","releaseGL","vector3_observable_Vector3Observable","super","tempVector3","transformation_tempMatrix","transformation_Transformation","transformFrameChanged","_matrix","matrixIsDirty","_position","positionIsDirty","_scale","scaleIsDirty","_rotation","eulerIsDirty","_quaternion","quaternionIsDirty","setFromEuler","setFromQuaternion","compose","rotation","scene_node_SceneNode","scene","sceneNodeListIndex","parent","children","transform","_worldMatrix","_worldMatrixUpdateFrameId","_visible","_visibleNet","_visibleUpdateFrameId","worldMatrix","visible","isFrameVisibleChange","node","isFrameStructureChange","addNode","removeChild","removeNode","indexOf","fn","visit","nodeParent","nodes","rootNode","traversePair","mapNode","mapParentNode","traverse","force","updateWorldMatrix","camera_Camera","projectionMatrixNeedUpdate","renderSizeObserver","newSize","resizeObservable","remove","onRenderResize","perspective_camera_tempMatrix","perspective_camera_PerspectiveCamera","fov","aspect","zoom","_fov","_zoom","_near","_far","_aspect","updateProjectionMatrix","tan","makePerspective","targetPosition","lookAt","caster","xRate","yRate","worldRay","setFromMatrixPosition","direction","unProject","UniformProxy","_needUpdate","Observer","_willBeUnregistered","unregisterOnNextCall","Observable","onObserverAdded","_observers","_onObserverAdded","unregisterOnFirstCall","observer","_deferUnregister","_remove","eventData","obs","draw_state_DrawState","cullSide","blending","NormalBlending","blendSrc","blendDst","blendEquation","FUNC_ADD","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthTest","depthWrite","colorWriteR","colorWriteG","colorWriteB","colorWriteA","polygonOffsetFactor","polygonOffsetUnits","alphaTest","setCullFace","setFunc","setMask","colorBuffer","setColorMask","setPolygonOffset","RenderRange","indexBuffer","PrimitiveType","render_object_RenderObject","drawMode","primitiveType","triangle","_visitor","material","shading","sphere_Sphere","sphere","getMaxScaleOnAxis","inverse","mesh_Mesh","raycasterable","visitor","foreachFace","raycaster","results","localRay","getLocalRay","hitPosition","boundingSphere","ifIntersectSphere","face","intersectTriangle","p1","p2","p3","hitLocalPosition","clone","box3_Box3","box","Infinity","isEmpty","addVectors","point","geometry_Geometry","_bufferArraysChange","_bufferDatum","_shapeChanged","_AABBBox","_AABBBoxNeedUpdate","_boundingSphere","_boundingSphereNeedUpdate","_indexBuffer","dataChanged","shapeChanged","AABBBox","updateAABBBox","updateBoundingSphere","shape","face3_Face3","line3_Line3","distanceTo","line","BufferData","Uint32Array","end","getGLAttributeBuffer","byteLength","tempFace3","tempLine3","standard_geometry_tempVector3","standard_geometry_StandardGeometry","normal","uv","positionBuffer","f3","setBuffer","normalBuffer","uvBuffer","f2","u32Index","getCenter","maxRadiusSq","foreachVertex","makeEmpty","expandByPoint","getBuffer","p1Index","getIndex","p2Index","p3Index","plane_geometry_PlaneGeometry","widthSegments","heightSegments","buildShape","width_half","height_half","gridX","gridY","gridX1","gridY1","segment_width","segment_height","indices","vertices","normals","uvs","quadMesh","quad_source_geometry","QuadSource","hasRendered","downloadCanvasPNGImage","canvas","link","toDataURL","replace","getStringContentFromFile","file","reader","FileReader","_","readAsText","openFile","func","files","addEventListener","loadStringFromFile","findFirst","indentSpaceSize","indentUnit","indentStringCache","getIndent","indentCount","code_builder_CodeBuilder","currentIndent","writeLine","trimmed","trim","reset","dag_node_DAGNode","toNodes","Set","fromNodes","fulfillList","_addFromRef","_removeFromRef","_removeToRef","allDepNodes","generateAllDependencyList","preventEndlessCounter","resolveNext","visited","depth","traverseDFS","shader_node_ShaderNode","swizzleType","ShaderSwizzleNode","ShaderFunctionNode","factory","define","returnType","inputMap","meaningfulName","inputs","connectTo","ShaderInputNode","ShaderCommonUniformInputNode","defaultValue","ShaderVaryInputNode","shader_node_ShaderInnerUniformInputNode","ShaderAttributeInputNode","isInstance","svf","shader_node_ShaderConstNode","shaderString","ShaderTextureNode","textureType","shader_node_ShaderTextureFetchNode","fetchByNode","getValueCount","ShaderCombineNode","combines","combineCount","length2Type","swizzledSourceCount","parts","from","genFragShader","graph","builder","addIndent","evaluatedNode","nodeDependList","fragmentRoot","generateDependencyOrderList","fragResult","codeGenGraph","writeBlock","code","pushListToMap","varList","reduceIndent","mainCode","output","includedCode","genShaderFunctionDepend","genVertexShader","vertexRoot","vertexResult","emptyLine","varyNode","varyDependList","varyResult","refedNode","functionsStr","dependFunctions","_record","resolvedFunction","genShaderFunctionIncludeCode","genTempVarExpFromShaderNode","preEvaluatedList","findRecordFromEvaluatedNode","record","varRc","genRecordVar","varKey","getParamKeyFromVarList","functionDefine","functionInputs","nodeDepend","combineResult","rootOutputName","nodeToGen","varName","varType","selfRecord","parseShaderFunctionMetaInfo","body","splitStrUntilChar","funcHead","funcParam","getFuncHead","getParamList","getFuncBody","description","char","substr","getDataType","getOneParam","para","unbrace","substring","functionNamesRecord","shader_function_ShaderFunction","dependShaderFunction","dependFunction","paramType","paramStr","writeCommentBlock","replaceFunctionCalls","replaceFunctionCallByName","functionName","replaceName","RegExp","MTransform","VPTransform","getWorldPosition","NDCxyToUV","UVDepthToNDC","getLastPixelNDC","dir3D","node_maker_texture","uniform","uniformFromValue","innerUniform","args","constValue","MVPWorld","make","screenQuad","UvFragVary","NormalFragVary","WorldPositionFragVary","shader_graph_ShaderGraph","root","next","setVary","swizzling","updateAutoWorldPositionVary","ret","declareFragNormal","setVertexRoot","setFragmentRoot","collectInputs","compileVertexSource","compileFragSource","nodeList","inputNodes","shading_Shading","_programConfigCache","_needRebuildShader","_decorators","_decoratorSlot","_decoratorObs","afterShaderCompiled","decorator","constructor","previous","dec","notifyNeedRedecorate","decorateSlot","_deco","decorate","build","compile","notifyObservers","disposeProgram","MarkNeedRedecorate","oldValue","configurable","MapUniform","remapName","propertyUniformNameMap","hasAnyUniformChanged","shading_BaseEffectShading","copy_CopyShading","declareFragUV","fetch","getVary","mousePosition","interactor_v1","interactor_Interactor","inputElement","enabled","mouseButton","prev","controllers","onMouseMove","clientX","clientY","groupEmit","leftMouseMoveCallBacks","rightMouseMoveCallBacks","onMouseDown","button","preventDefault","onMouseUp","mouseUpCallBacks","onMouseWheel","delta","wheelDelta","deltaY","mouseWheelCallBacks","mouseDownCallBacks","preventContentMenu","removeEventListener","stopPropagation","callBackList","param","controller","removeController","foreachRenderableInSource","updateSource","resetSource","nextSource","nextRenderable","copyShading","quad","render_engine_RenderEngine","ctxOptions","_preferVAO","_vaoEnabled","overrideShading","defaultTechnique","normal_NormalShading","_camera","isCameraChanged","cameraMatrixReverse","ProjectionMatrix","jitterPMatrix","jitterVPMatrix","lastUploadedShaderUniformProvider","programShadingMap","camera","interactor","preferVAO","vaoEnabled","setValue","needUpdateVP","obj","renderObject","connectShading","connectMaterial","connectGeometry","connectRange","syncGL","draw","debugViewPort","setRenderTargetScreen","defineFrameBufferTextureDep","lastProgramRendered","updateInnerGlobalUniforms","foreachProvider","provider","setUniformIfExist","forTextures","getChannelTexture","getFramebufferTexture","geometryIndexBuffer","vaoUnbindCallback","webglVAO","getVAO","checkBufferArrayChange","useVAO","deleteVAO","createVAO","forAttributes","glBuffer","createOrUpdateAttributeBuffer","useIndexBuffer","_markBufferArrayHasUpload","getProgramConfig","getGLBuffer","updateOrCreateBuffer","Accumulator","records","average","last","current","framer_Framer","avgRenderFrameTimeLast120Frame","userRenderFrame","renderFrame","time","frameStart","frameEnd","performance","now","active","tickId","requestAnimationFrame","frameStartTime","frame","cancelAnimationFrame","frameEndTime","line_Line","LINES","points_Points","POINTS","ChannelType","DimensionType","stateType","RenderList","realLength","renderListCursor","scene_Scene","objectList","isFrameTransformChange","onRemoveList","onAddList","isFrameChange","updateObjectList","resetCursor","addRenderItem","loader","pass_RenderPass","enableDepthClear","enableColorClear","inputTarget","isOutputScreen","beforePassExecute","afterPassExecute","inputKey","mapTo","renderTargetNode","render_graph_RenderGraph","screenRoot","outputTarget","getOrCreateFrameBuffer","debugOutputViewport","renderTargetNodes","renderFrameBuffer","inputFramebufferName","_uniformName","getFramebuffer","debugInputViewport","enableDebuggingView","screenNode","setFullScreenViewPort","renderDebugResult","render_graph_EffectComposer","passes","nodeMap","pass","execute","passNodes","composer","graphDefine","allocateRenderTargetNodes","renderTargets","constructPassGraph","updateDependNode","nodeQueue","render_target_node_RenderTargetNode","updateSize","pass_graph_node_PassGraphNode","getPass","updatePass","addPass","passesDefine","registerNode","isScreenNode","textsDefine","quadSource","autoWidthRatio","autoHeightRatio","widthAbs","heightAbs","fromGetter","pixelFormat","dimensionType","bindRenderSize","disableDepthBuffer","f","createFrameBuffer","fixed","resize","clearAllFrom","passNode","getRenderPassDependence","inputsGetter","inputUniformKey","getRenderTargetDependence","activeNodes","updateInputTargets","foundedNode","setOutPutTarget","checkIsValid","normalShading","depthPack","unPackDepth","rand","rand2DT","newSamplePosition","NDCFromWorldPositionAndVPMatrix","sampleAO","tssaoMix","tssao_TSSAOShading","sampleCount","VPMatrixInverse","aoRadius","getPropertyUniform","depthTex","vUV","worldPosition","Random2D1","Random2D2","randDir","newPositionRand","newDepth","tslib_tslib_es6","tssaoBlend","tssao_blend_TSSAOBlendShading","tssaoComposeRate","tssaoShowThreshold","tssaoComposeThreshold","depthV","depth_DepthShading","TAAMix","taa_TAAShading","colorOld","light_Light","decorated","collectLight","getFragRoot","produceLightFragEffect","_graph","ambientLightShading","ambient_light_AmbientLight","color","_decorated","directionalLightShading","directional_light_DirectionalLight","pointLightShading","point_light_PointLight","sphere_geometry_SphereGeometry","phiStart","phiLength","thetaStart","thetaLength","thetaEnd","grid","verticesRow","u","cube_geometry_CubeGeometry","depthSegments","numberOfVertices","buildPlane","udir","vdir","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","vector","vertexCounter","Controller","spherical_Spherical","tempVec","orbit_controller_OrbitController","spherical","rotateAngleFactor","panFactor","zoomFactor","maxPolarAngle","minPolarAngle","sphericalDelta","zooming","panOffset","enableDamping","zoomingDampingFactor","rotateDampingFactor","panDampingFactor","rotate","viewWidth","viewHeight","move","setFromVector","unbindControllerAllListener","bindLeftMouseMove","bindRightMouseMove","bindMouseWheel","setFromSpherical","normal_generation_v1","v3","v12","v13","normal_generation_n","generateNormalFromPosition","vertices_length","Loader","GeometryLoader","obj_loader_OBJLoader","vertexPattern","normalPattern","uvPattern","facePattern1","facePattern2","facePattern3","facePattern4","positions","indicesForArtgl","wrappedPositionForArtgl","wrappedUvsForArtgl","wrappedNormalsForArtgl","tuplePosNorm","curPositionInIndices","setDataForCurrentFaceWithPattern4","triangleStrs","collectTriangle","k","indicePositionFromObj","parseInt","indiceNormalFromObj","setData","faces","triangles","getTriangles","triangleList","idx","indiceUvsFromObj","positionVectorFromOBJ","textureVectorFromOBJ","normalsVectorFromOBJ","objStr","fileName","charAt","exec","parseFloat","setDataForCurrentFaceWithPattern3","setDataForCurrentFaceWithPattern2","setDataForCurrentFaceWithPattern1","po","useGeneratedNormal","controlExposureShading","Uncharted2Helper","exposurer_Uncharted2ToneMapping","ToneMapType","exposurer_ExposureController","toneMappingExposure","toneMappingWhitePoint","toneMapType","Uncharted2ToneMapping","Linear","getToneMapFunction","hierarchy_balls","sphereGeo","planeGeo","cubeGeo","pointLight","ambient","dirLight","exposureController","planeMesh","g","addChild","ground","boxMesh","arraySize","node2","testMesh","setAll","pipeline","resetSample","createConf","setActualSize","enableTAA","enableTSSAO","composeShading","tssaoShading","RenderPipeline_RenderPipeline","taaShading","taaShader","tssaoShader","composeShader","depthShader","tickNum","isEvenTick","connectCamera","jitterProjectionMatrix","defineGraph","sceneResult","depthResult","TAAHistoryOld","unJit","VP","AOAcc","basic","tssao","diff","edge1","edge2","ray_normal","ray_v1","ray_Ray","ray","backfaceCulling","sign","DdN","DdQxE2","DdE1xQ","cross","QdN","at","distanceSqToPoint","directionDistance","matrix4","transformDirection","raycaster_Raycaster","rayProvider","updateRaycaster","preFilter","raycast","STATIC_SERVER","application_Application","framer","hasInitialized","backgroundColor","onContainerResize","beforeRender","afterRender","orbitController","registerInteractor","createScene","setFrame","stop","Uint8Array","resultCast","pick","run","objLoader","response","geo","parse","mesh","GLApp","config_panelvue_type_script_lang_ts_ConfigPanel","showConfigPanel","$nextTick","notifyResize","Config","config_panelvue_type_script_lang_ts_","views_config_panelvue_type_script_lang_ts_","config_panel_component","config_panel","scene_panelvue_type_template_id_2e8def07_scoped_true_render","sync","navitem","current-nav","currentNav","view","sceneView","nodeChange","catchChange","renderView","compiledPrograms","programSwitchCount","scene_panelvue_type_template_id_2e8def07_scoped_true_staticRenderFns","scene_view_objLoader","GeometryView","bufferdata","dataByteSize","getDataSizeByte","MaterialView","scene_view_SceneView","geometries","materials","collectEntity","scene_view_SceneNodeView","findSubNode","setRootNode","objstr","nodeview","RenderView","updateFrameInfo","geometry_viewvue_type_template_id_6d5074e5_scoped_true_render","bufferinfo","geometry_viewvue_type_template_id_6d5074e5_scoped_true_staticRenderFns","geometry_viewvue_type_script_lang_ts_GeometryViewPanel","expandDetail","geometrylist","geometry_viewvue_type_script_lang_ts_","scene_panel_geometry_viewvue_type_script_lang_ts_","geometry_view_component","geometry_view","material_viewvue_type_template_id_2b822b43_scoped_true_render","materiallist","material_viewvue_type_template_id_2b822b43_scoped_true_staticRenderFns","channel_editorvue_type_template_id_533c6709_render","channel_editorvue_type_template_id_533c6709_staticRenderFns","channel_editorvue_type_script_lang_ts_ChannelEditor","channel_editorvue_type_script_lang_ts_","channel_editor_component","channel_editor","material_viewvue_type_script_lang_ts_materialViewPanel","mat","ChannelEditor","material_viewvue_type_script_lang_ts_","scene_panel_material_viewvue_type_script_lang_ts_","material_view_component","material_view","object_panelvue_type_template_id_1d29f434_scoped_true_render","object_panelvue_type_template_id_1d29f434_scoped_true_staticRenderFns","object_panelvue_type_script_lang_ts_ObjectPanel","object_panelvue_type_script_lang_ts_","object_panel_object_panelvue_type_script_lang_ts_","object_panel_component","object_panel","scene_node_viewvue_type_template_id_85464e1a_scoped_true_render","expandable","hasChildren","isExpand","clampId","showMenu","emitDelete","emitLoadObj","child","emitChange","scene_node_viewvue_type_template_id_85464e1a_scoped_true_staticRenderFns","scene_node_viewvue_type_script_lang_ts_BooleanEditor","__decorate","scene_node_viewvue_type_script_lang_ts_","scene_panel_scene_node_viewvue_type_script_lang_ts_","scene_node_view_component","scene_node_view","scene_panelvue_type_script_lang_ts_ScenePanel","nav","afterObs","showScenePanel","deleteNode","loadObj","NodeView","ObjectPanel","GeometryViewPanel","MaterialViewPanel","scene_panelvue_type_script_lang_ts_","scene_panel_scene_panelvue_type_script_lang_ts_","scene_panel_component","scene_panel","viewer_canvasvue_type_template_id_0bf133fc_scoped_true_render","isRunning","staticStyle","pointer-events","layout","board","updateAllViewport","nodeView","ref","refInFor","boardInfo","updateViewport","updateLine","isRenderTargetNode","disabled","screenshot","showGraphViewer","inspectGraph","closeGraphInspector","viewer_canvasvue_type_template_id_0bf133fc_scoped_true_staticRenderFns","graph_viewervue_type_template_id_20b4d88e_scoped_true_render","tabindex","style","_t","mousedown","startDrag","showMove","graph_viewervue_type_template_id_20b4d88e_scoped_true_staticRenderFns","graph_viewervue_type_script_lang_ts_GraphViewer","isDragging","transformX","transformY","screenOriginX","screenX","screenOriginY","screenY","originTransformX","originTransformY","dragging","updateBoard","$el","clientWidth","clientHeight","graph_viewervue_type_script_lang_ts_","graph_graph_viewervue_type_script_lang_ts_","graph_viewer_component","graph_viewer","dag_nodevue_type_template_id_f08e55ee_scoped_true_render","viewPositionX","viewPositionY","cursor","dag_nodevue_type_template_id_f08e55ee_scoped_true_staticRenderFns","getRightEnd","absX","absY","layoutGraph","layoutNodeMap","gridSize","horizonArray","removeItem","row","horizonPosition","arr","reverse","indexRow","indexY","ConnectionLine","startX","startY","endX","endY","hud","beginPath","moveTo","lineTo","stroke","LinesHUD","clearRect","dag_nodevue_type_script_lang_ts_DAGNodeView","selfLines","originX","originY","vn","inputNode","rightCenter","getNodesLayout","getLines","dag_nodevue_type_script_lang_ts_","graph_dag_nodevue_type_script_lang_ts_","dag_node_component","dag_node","line_hud_canvasvue_type_template_id_4cfbac3a_scoped_true_render","line_hud_canvasvue_type_template_id_4cfbac3a_scoped_true_staticRenderFns","line_hud_canvasvue_type_script_lang_ts_LineHUDCanvas","HUD","line_hud_canvasvue_type_script_lang_ts_","views_line_hud_canvasvue_type_script_lang_ts_","line_hud_canvas_component","line_hud_canvas","render_target_nodevue_type_template_id_69d673c4_scoped_true_render","actualSize","defaultSize","render_target_nodevue_type_template_id_69d673c4_scoped_true_staticRenderFns","render_target_nodevue_type_script_lang_ts_RenderTargetNodeView","render_target_nodevue_type_script_lang_ts_","nodes_render_target_nodevue_type_script_lang_ts_","render_target_node_component","render_target_node","viewer_canvasvue_type_script_lang_ts_ViewerCanvas","querySelector","pickColor","offsetX","offsetY","notifyNodeNeedUpdateLine","no","$refs","vueNodes","downloadCurrentRender","GraphView","DAGNodeView","RenderTargetNodeView","LineHUDCanvas","viewer_canvasvue_type_script_lang_ts_","views_viewer_canvasvue_type_script_lang_ts_","viewer_canvas_component","viewer_canvas","viewervue_type_script_lang_ts_Viewer","initialize","unintialize","ConfigPanel","ScenePanel","ViewerCanvas","viewervue_type_script_lang_ts_","views_viewervue_type_script_lang_ts_","viewer_component","viewer","shader_editorvue_type_template_id_71476dfb_scoped_true_render","addUniform","isShaderFunctionNode","showCode","codeGen","updateTechnique","codeGenResult","mouseenter","mouseleave","shader_editorvue_type_template_id_71476dfb_scoped_true_staticRenderFns","shader_application_ShaderApplication","canvasRun","tick","loadScene","testGeo","ShaderApp","shader_function_nodevue_type_template_id_0f053584_scoped_true_render","shader_function_nodevue_type_template_id_0f053584_scoped_true_staticRenderFns","shader_function_nodevue_type_script_lang_ts_ShaderFunctionNodeView","shader_function_nodevue_type_script_lang_ts_decorate","shader_function_nodevue_type_script_lang_ts_","nodes_shader_function_nodevue_type_script_lang_ts_","shader_function_node_component","shader_function_node","shader_editorvue_type_script_lang_ts_ShaderEditor","updateShader","ShaderFunctionNodeView","shader_editorvue_type_script_lang_ts_","views_shader_editorvue_type_script_lang_ts_","shader_editor_component","shader_editor","debugvue_type_template_id_18ff3916_render","debugvue_type_template_id_18ff3916_staticRenderFns","debugvue_type_script_lang_ts_Debug","debugvue_type_script_lang_ts_","views_debugvue_type_script_lang_ts_","debug_component","debug","example_pagevue_type_template_id_049970b3_scoped_true_render","example","gotoExample","example_pagevue_type_template_id_049970b3_scoped_true_staticRenderFns","example_pagevue_type_script_lang_ts_ConfigPanel","examples","viewExample","params","example_pagevue_type_script_lang_ts_","example_example_pagevue_type_script_lang_ts_","example_page_component","example_page","example_item_pagevue_type_template_id_3b7292a6_scoped_true_render","example_item_pagevue_type_template_id_3b7292a6_scoped_true_staticRenderFns","test_bridge_ViewerTestBridge","element","goldenPath","testConfig","test_bridge_HeadlessTestBridge","screenShotCompareElement","HeadlessTestBridge","bridge","example_item_pagevue_type_script_lang_ts_ConfigPanel","exampleHasBuild","example_item_pagevue_type_script_lang_ts_","example_example_item_pagevue_type_script_lang_ts_","example_item_page_component","example_item_page","vue_runtime_esm","use","vue_router_esm","router","routes","path","then","test","testBridge","fromStandardGeometry","allCount","draw_primitives_test","points","artglExamples","vuex_esm","store","Store","mutations","actions","productionTip","$mount","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_dag_node_vue_vue_type_style_index_0_id_f08e55ee_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_dag_node_vue_vue_type_style_index_0_id_f08e55ee_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_example_item_page_vue_vue_type_style_index_0_id_3b7292a6_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_example_item_page_vue_vue_type_style_index_0_id_3b7292a6_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/app.19c58ac2.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({\"about\":\"about\"}[chunkId]||chunkId) + \".\" + {\"about\":\"6d1e053d\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\tvar error = new Error('Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')');\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-node-view.vue?vue&type=style&index=0&id=85464e1a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-node-view.vue?vue&type=style&index=0&id=85464e1a&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config-panel.vue?vue&type=style&index=0&id=035897bd&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config-panel.vue?vue&type=style&index=0&id=035897bd&scoped=true&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./select.vue?vue&type=style&index=0&id=4d845963&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./select.vue?vue&type=style&index=0&id=4d845963&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/artgl.d3d716c6.svg\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./geometry-view.vue?vue&type=style&index=0&id=6d5074e5&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./geometry-view.vue?vue&type=style&index=0&id=6d5074e5&scoped=true&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./graph-viewer.vue?vue&type=style&index=0&id=20b4d88e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./graph-viewer.vue?vue&type=style&index=0&id=20b4d88e&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shader-editor.vue?vue&type=style&index=0&id=71476dfb&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shader-editor.vue?vue&type=style&index=0&id=71476dfb&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-page.vue?vue&type=style&index=0&id=049970b3&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-page.vue?vue&type=style&index=0&id=049970b3&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./line-hud-canvas.vue?vue&type=style&index=0&id=4cfbac3a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./line-hud-canvas.vue?vue&type=style&index=0&id=4cfbac3a&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config.vue?vue&type=style&index=0&id=2d21bbf9&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config.vue?vue&type=style&index=0&id=2d21bbf9&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./number.vue?vue&type=style&index=0&id=4393da8d&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./number.vue?vue&type=style&index=0&id=4393da8d&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=style&index=0&id=70f84b50&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=style&index=0&id=70f84b50&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./object-panel.vue?vue&type=style&index=0&id=1d29f434&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./object-panel.vue?vue&type=style&index=0&id=1d29f434&scoped=true&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-panel.vue?vue&type=style&index=0&id=2e8def07&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-panel.vue?vue&type=style&index=0&id=2e8def07&scoped=true&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./folder.vue?vue&type=style&index=0&id=a0e8d0e0&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./folder.vue?vue&type=style&index=0&id=a0e8d0e0&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./item.vue?vue&type=style&index=0&id=40003b0d&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./item.vue?vue&type=style&index=0&id=40003b0d&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./top-nav.vue?vue&type=style&index=0&id=7f659a97&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./top-nav.vue?vue&type=style&index=0&id=7f659a97&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editors.vue?vue&type=style&index=0&id=50902bf1&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editors.vue?vue&type=style&index=0&id=50902bf1&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer-canvas.vue?vue&type=style&index=0&id=0bf133fc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer-canvas.vue?vue&type=style&index=0&id=0bf133fc&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/art.1868a50d.svg\";","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=style&index=0&id=5760c40d&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=style&index=0&id=5760c40d&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[(_vm.showTopNav)?_c('TopNav'):_vm._e(),_c('router-view')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"top-nav\"},[_c('img',{attrs:{\"src\":require(\"../../assets/art.svg\"),\"alt\":\"\"},on:{\"click\":_vm.gotoHome}}),_c('div',{staticClass:\"current-project\"},[_c('router-link',{attrs:{\"active-class\":\"current\",\"to\":\"/viewer\"}},[_vm._v(\"Viewer\")]),_c('router-link',{attrs:{\"active-class\":\"current\",\"to\":\"/shader\"}},[_vm._v(\"Composer\")]),_c('router-link',{attrs:{\"active-class\":\"current\",\"to\":\"/examples\"}},[_vm._v(\"Examples\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\n\r\n@Component\r\nexport default class TopNav extends Vue {\r\n  $router: any;\r\n  gotoHome() {\r\n    this.$router.push({\r\n      name: \"home\"\r\n    });\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./top-nav.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./top-nav.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./top-nav.vue?vue&type=template&id=7f659a97&scoped=true&\"\nimport script from \"./top-nav.vue?vue&type=script&lang=ts&\"\nexport * from \"./top-nav.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./top-nav.vue?vue&type=style&index=0&id=7f659a97&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7f659a97\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\r\nimport { Component, Vue } from 'vue-property-decorator';\r\nimport TopNav from './components/nav/top-nav.vue';\r\n\r\n@Component({\r\n  components: {\r\n    TopNav,\r\n  },\r\n})\r\nexport default class ViewerApp extends Vue {\r\n  $route: any;\r\n\r\nget showTopNav(){\r\n  return this.$route.name !=='home'\r\n}\r\n}\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??ref--12-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/ts-loader/index.js??ref--12-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=35b0508a&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home-page\"},[_vm._m(0),_c('ul',[_c('router-link',{attrs:{\"active-class\":\"current\",\"to\":\"/viewer\"}},[_vm._v(\"Scene Viewer\")]),_c('router-link',{attrs:{\"active-class\":\"current\",\"to\":\"/shader\"}},[_vm._v(\"Shader Composer\")]),_c('router-link',{attrs:{\"active-class\":\"current\",\"to\":\"/examples\"}},[_vm._v(\"Simple Examples\")])],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('img',{attrs:{\"src\":require(\"../assets/artgl.svg\"),\"alt\":\"\"}})])}]\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./home.vue?vue&type=template&id=70f84b50&scoped=true&\"\nvar script = {}\nimport style0 from \"./home.vue?vue&type=style&index=0&id=70f84b50&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"70f84b50\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"viewer\"},[(this.$store.state.showScenePanel)?_c('ScenePanel'):_vm._e(),_c('ViewerCanvas'),(this.$store.state.showConfigPanel)?_c('ConfigPanel',{attrs:{\"appConfig\":_vm.appConf}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"config-panel\"},[_c('div',{staticClass:\"panel-title\"},[_vm._v(\"\\n    Render configuration\\n    \"),_c('button',{on:{\"click\":_vm.hide}},[_vm._v(\"hide\")])]),_c('div',{staticClass:\"config-wrap\"},[_c('Config',{attrs:{\"config\":_vm.appConfig}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"conf\"},[_c('Folder',{attrs:{\"config\":_vm.config}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"folder\"},[_c('div',{staticClass:\"title\",on:{\"click\":_vm.toggle}},[(!_vm.expand)?_c('span',[_vm._v(\">\")]):_c('span',[_vm._v(\"=\")]),_vm._v(\"\\n    \"+_vm._s(_vm.config.name)+\"\\n    \"),(_vm.isEmptyList)?_c('span',{staticClass:\"empty-hint\"},[_vm._v(\" empty \")]):_vm._e()]),(_vm.expand)?_c('div',{staticClass:\"subitem\"},_vm._l((_vm.config.value),function(subConfig){return _c('div',{key:subConfig.name},[(Array.isArray(subConfig.value))?_c('config-folder',{attrs:{\"config\":subConfig}}):_c('ConfigItem',{attrs:{\"config\":subConfig},model:{value:(subConfig.value),callback:function ($$v) {_vm.$set(subConfig, \"value\", $$v)},expression:\"subConfig.value\"}})],1)}),0):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"item\"},[_c('div',{staticClass:\"item-head\"},[_c('div',{staticClass:\"item-name\"},[_vm._v(\"\\n    \"+_vm._s(_vm.config.name)+\" \\n    \")]),_c('div',{staticClass:\"inline-editor\"},[(typeof _vm.config.value === 'number' && _vm.config.valueConfig === undefined)?_c('NumberEditor',{model:{value:(_vm.configValue),callback:function ($$v) {_vm.configValue=$$v},expression:\"configValue\"}}):_vm._e(),(typeof _vm.config.value === 'boolean' && _vm.config.valueConfig === undefined)?_c('BooleanEditor',{model:{value:(_vm.configValue),callback:function ($$v) {_vm.configValue=$$v},expression:\"configValue\"}}):_vm._e(),(_vm.config.valueConfig && _vm.config.valueConfig.type === 'select')?_c('SelectEditor',{attrs:{\"list\":_vm.config.valueConfig.selectItem},model:{value:(_vm.configValue),callback:function ($$v) {_vm.configValue=$$v},expression:\"configValue\"}}):_vm._e(),(_vm.shouldHaveCustomEditor)?_c('button',{staticClass:\"expand-editor\",on:{\"click\":function($event){_vm.expandEditor = !_vm.expandEditor}}},[_vm._v(\"&\")]):_vm._e()],1)]),(_vm.shouldHaveCustomEditor && _vm.expandEditor)?_c('Editors',{attrs:{\"editorConfig\":_vm.config.editors},model:{value:(_vm.configValue),callback:function ($$v) {_vm.configValue=$$v},expression:\"configValue\"}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor\"},[(_vm.isMultiEditor)?_c('div',{staticClass:\"editor-list\"},_vm._l((_vm.editorConfig),function(e,index){return _c('div',{key:e.type,staticClass:\"editor-nav\",class:{'active-editor-nav': index === _vm.currentEditor},on:{\"click\":function($event){return _vm.useEditor(index)}}},[_vm._v(\"\\n    \"+_vm._s(e.type)+\"\\n    \")])}),0):(_vm.editor.type === 'slider')?_c('NumberSliderEditor',{attrs:{\"config\":_vm.editor},model:{value:(_vm._value),callback:function ($$v) {_vm._value=$$v},expression:\"_value\"}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm._value),expression:\"_value\"}],attrs:{\"type\":\"range\",\"max\":_vm.config.max,\"min\":_vm.config.min,\"step\":_vm.config.step},domProps:{\"value\":(_vm._value)},on:{\"__r\":function($event){_vm._value=$event.target.value}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\n@Component\r\nexport default class NumberSliderEditor extends Vue {\r\n\r\n  @Prop({ required: true }) value: number;\r\n  @Prop({ required: true }) config: number;\r\n\r\n  get _value(){\r\n    return this.value;\r\n  }\r\n\r\n  set _value(value){\r\n    this.$emit('input', value - 0);\r\n  }\r\n\r\n\r\n  \r\n}\r\n\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./number-slider.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./number-slider.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./number-slider.vue?vue&type=template&id=570e1f1b&\"\nimport script from \"./number-slider.vue?vue&type=script&lang=ts&\"\nexport * from \"./number-slider.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport NumberSliderEditor from './number-slider.vue';\r\n@Component({\r\n  components:{\r\n    NumberSliderEditor\r\n  }\r\n})\r\nexport default class Editors extends Vue {\r\n  currentEditor = 0;\r\n\r\n  get isMultiEditor(){\r\n    return this.editorConfig.length !== 1;\r\n  }\r\n\r\n  @Prop({ required: true }) editorConfig: any;\r\n  @Prop({ required: true }) value: any;\r\n\r\n  get editor(){\r\n    return this.editorConfig[this.currentEditor];\r\n  }\r\n\r\n  get _value(){\r\n    return this.value;\r\n  }\r\n\r\n  set _value(value){\r\n    this.$emit('input', value);\r\n  }\r\n\r\n  useEditor(index){\r\n    this.currentEditor = index;\r\n  }\r\n\r\n\r\n}\r\n\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editors.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editors.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./editors.vue?vue&type=template&id=50902bf1&scoped=true&\"\nimport script from \"./editors.vue?vue&type=script&lang=ts&\"\nexport * from \"./editors.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./editors.vue?vue&type=style&index=0&id=50902bf1&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"50902bf1\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"number-editor\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm._value),expression:\"_value\"}],attrs:{\"type\":\"number\"},domProps:{\"value\":(_vm._value)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm._value=$event.target.value}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\n@Component\r\nexport default class NumberEditor extends Vue {\r\n  @Prop({ required: true }) value: number;\r\n\r\n  get _value() {\r\n    return this.value;\r\n  }\r\n\r\n  set _value(value) {\r\n    this.$emit(\"input\", value - 0);\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./number.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./number.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./number.vue?vue&type=template&id=4393da8d&scoped=true&\"\nimport script from \"./number.vue?vue&type=script&lang=ts&\"\nexport * from \"./number.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./number.vue?vue&type=style&index=0&id=4393da8d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4393da8d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm._value),expression:\"_value\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm._value)?_vm._i(_vm._value,null)>-1:(_vm._value)},on:{\"change\":function($event){var $$a=_vm._value,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm._value=$$a.concat([$$v]))}else{$$i>-1&&(_vm._value=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm._value=$$c}}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\n@Component\r\nexport default class BooleanEditor extends Vue {\r\n  @Prop({ required: true }) value: number;\r\n\r\n  get _value() {\r\n    return this.value;\r\n  }\r\n\r\n  set _value(value) {\r\n    this.$emit(\"input\", value);\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./boolean.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./boolean.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./boolean.vue?vue&type=template&id=50eb078e&\"\nimport script from \"./boolean.vue?vue&type=script&lang=ts&\"\nexport * from \"./boolean.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"select-editor\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm._value),expression:\"_value\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm._value=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.list),function(item){return _c('option',{key:item},[_vm._v(_vm._s(item))])}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\n@Component\r\nexport default class SelectEditor extends Vue {\r\n  @Prop({ required: true }) value: number;\r\n  @Prop({ required: true }) list: string[];\r\n\r\n  get _value() {\r\n    return this.value;\r\n  }\r\n\r\n  set _value(value) {\r\n    this.$emit(\"input\", value);\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./select.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./select.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./select.vue?vue&type=template&id=4d845963&scoped=true&\"\nimport script from \"./select.vue?vue&type=script&lang=ts&\"\nexport * from \"./select.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./select.vue?vue&type=style&index=0&id=4d845963&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4d845963\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport Editors from './editors.vue';\r\nimport NumberEditor from './number.vue';\r\nimport BooleanEditor from './boolean.vue';\r\nimport SelectEditor from './select.vue';\r\n\r\n@Component({\r\n  components:{\r\n    Editors, NumberEditor, BooleanEditor, SelectEditor\r\n  }\r\n})\r\nexport default class ConfigItem extends Vue {\r\n  expandEditor:boolean = false;\r\n\r\n  @Prop({ required: true }) config: any;\r\n\r\n  get configValue(){\r\n    return this.config.value;\r\n  }\r\n\r\n  set configValue(newValue){\r\n    if(this.config.onChange !== undefined){\r\n      this.config.onChange(newValue);\r\n    }\r\n    this.config.value = newValue;\r\n  }\r\n\r\n  get shouldHaveCustomEditor(){\r\n    return this.config.editors !== undefined\r\n  }\r\n}\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./item.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./item.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./item.vue?vue&type=template&id=40003b0d&scoped=true&\"\nimport script from \"./item.vue?vue&type=script&lang=ts&\"\nexport * from \"./item.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./item.vue?vue&type=style&index=0&id=40003b0d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"40003b0d\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport ConfigItem from './item.vue';\r\n@Component({\r\n  name: 'config-folder',\r\n  components:{\r\n    ConfigItem\r\n  }\r\n})\r\nexport default class Folder extends Vue {\r\n  expand:boolean = true;\r\n  @Prop({ required: true }) config: any;\r\n\r\n  get isEmptyList(){\r\n    return this.config.value.length === 0\r\n  }\r\n\r\n  toggle(){\r\n    if(!this.isEmptyList){\r\n      this.expand = !this.expand;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./folder.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./folder.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./folder.vue?vue&type=template&id=a0e8d0e0&scoped=true&\"\nimport script from \"./folder.vue?vue&type=script&lang=ts&\"\nexport * from \"./folder.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./folder.vue?vue&type=style&index=0&id=a0e8d0e0&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a0e8d0e0\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport Folder from \"./folder.vue\";\r\n@Component({\r\n  components: { Folder }\r\n})\r\nexport default class ConfigPanel extends Vue {\r\n  @Prop({ required: true }) config: any;\r\n}\r\n","// https://github.com/pissang/claygl/blob/master/src/core/GLInfo.js\r\n\r\nexport enum GLExtList {\r\n  ANGLE_instanced_arrays = \"ANGLE_instanced_arrays\",\r\n  OES_texture_float = \"OES_texture_float\",\r\n  OES_texture_half_float = \"OES_texture_half_float\",\r\n  OES_texture_float_linear = \"OES_texture_float_linear\",\r\n  OES_texture_half_float_linear = \"OES_texture_half_float_linear\",\r\n  OES_standard_derivatives = \"OES_standard_derivatives\",\r\n  OES_vertex_array_object = \"OES_vertex_array_object\",\r\n  OES_element_index_uint = \"OES_element_index_uint\",\r\n  WEBGL_compressed_texture_s3tc = \"WEBGL_compressed_texture_s3tc\",\r\n  WEBGL_depth_texture = \"WEBGL_depth_texture\",\r\n  EXT_texture_filter_anisotropic = \"EXT_texture_filter_anisotropic\",\r\n  EXT_shader_texture_lod = \"EXT_shader_texture_lod\",\r\n  WEBGL_draw_buffers = \"WEBGL_draw_buffers\",\r\n  EXT_frag_depth = \"EXT_frag_depth\",\r\n  EXT_sRGB = \"EXT_sRGB\"\r\n}\r\n\r\nexport enum GLParamList {\r\n  MAX_TEXTURE_SIZE = \"MAX_TEXTURE_SIZE\",\r\n  MAX_CUBE_MAP_TEXTURE_SIZE = \"MAX_CUBE_MAP_TEXTURE_SIZE\"\r\n}\r\n\r\nconst EXTENSION_LIST = Object.keys(GLExtList);\r\nconst PARAMETER_NAMES = Object.keys(GLParamList);\r\n\r\nexport class GLInfo {\r\n  constructor(gl: WebGLRenderingContext) {\r\n    this.gl = gl;\r\n    this.createAllExtension();\r\n    this.getAllParams();\r\n    if (this.getExtension(GLExtList.OES_element_index_uint) !== undefined) {\r\n      this.supportUintIndexDraw = true;\r\n    }\r\n  }\r\n  private gl: WebGLRenderingContext\r\n  private extensions: { [index: string]: any } = {}\r\n  private parameters: { [index: string]: any } = {}\r\n  readonly supportUintIndexDraw: boolean;\r\n\r\n  private createExtension(name: string) {\r\n    const gl = this.gl;\r\n    var ext = gl.getExtension(name);\r\n    if (!ext) {\r\n      ext = gl.getExtension('MOZ_' + name);\r\n    }\r\n    if (!ext) {\r\n      ext = gl.getExtension('WEBKIT_' + name);\r\n    }\r\n    this.extensions[name] = ext;\r\n  }\r\n\r\n  getExtension(name: GLExtList) {\r\n    if (!(name in this.extensions)) {\r\n      this.createExtension(name);\r\n    }\r\n    return this.extensions[name];\r\n  };\r\n\r\n  getParameter(name: string) {\r\n    return this.parameters[name];\r\n  };\r\n\r\n  private createAllExtension() {\r\n    for (var i = 0; i < EXTENSION_LIST.length; i++) {\r\n      var extName = EXTENSION_LIST[i];\r\n      this.createExtension(extName);\r\n    }\r\n  }\r\n\r\n  private getAllParams() {\r\n    for (var i = 0; i < PARAMETER_NAMES.length; i++) {\r\n      var name = PARAMETER_NAMES[i];\r\n      this.parameters[name] = this.gl.getParameter((this.gl as any)[name]);\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./config.vue?vue&type=template&id=2d21bbf9&scoped=true&\"\nimport script from \"./config.vue?vue&type=script&lang=ts&\"\nexport * from \"./config.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./config.vue?vue&type=style&index=0&id=2d21bbf9&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2d21bbf9\",\n  null\n  \n)\n\nexport default component.exports","import { GLRenderer } from \"./gl-renderer\";\r\nimport { GLProgramConfig } from \"./program\";\r\n\r\nexport enum ShaderType {\r\n  vertex,\r\n  fragment\r\n}\r\n\r\nexport class GLShader {\r\n  constructor(renderer: GLRenderer, type: ShaderType) {\r\n    this.renderer = renderer;\r\n    const gl = this.renderer.gl;\r\n    this.type = type;\r\n    var shader = gl.createShader(type === ShaderType.vertex ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER);\r\n    if (shader === null) {\r\n      throw 'webgl shader create failed';\r\n    }\r\n    this.shader = shader;\r\n  }\r\n  renderer: GLRenderer;\r\n  shader: WebGLShader;\r\n  type: ShaderType;\r\n\r\n  compileShader(source: string): WebGLShader {\r\n    const gl = this.renderer.gl;\r\n    gl.shaderSource(this.shader, source);\r\n    gl.compileShader(this.shader);\r\n    if (!gl.getShaderParameter(this.shader, gl.COMPILE_STATUS)) {\r\n      let log = gl.getShaderInfoLog(this.shader);\r\n      if (log) {\r\n        logDebugShaderSource(source);\r\n        throw new Error(log);\r\n      }\r\n    }\r\n    if (!this.shader) {\r\n      throw \"Something went wrong while compile the shader.\";\r\n    }\r\n    return this.shader;\r\n  };\r\n\r\n  dispose() {\r\n    this.renderer.gl.deleteShader(this.shader);\r\n  }\r\n\r\n}\r\n\r\nfunction logDebugShaderSource(source: string) {\r\n  console.warn(addLineNumbers(source));\r\n}\r\n\r\nfunction addLineNumbers(str: string) {\r\n  var lines = str.split('\\n');\r\n  for (var i = 0; i < lines.length; i++) {\r\n    lines[i] = (i + 1) + ': ' + lines[i];\r\n  }\r\n  return lines.join('\\n');\r\n}","var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\nvar uuid = new Array(36);\r\nvar rnd = 0, r;\r\n  // http://www.broofa.com/Tools/Math.uuid.htm\r\nexport function generateUUID(): string{\r\n  for (var i = 0; i < 36; i++) {\r\n    if (i === 8 || i === 13 || i === 18 || i === 23) {\r\n      uuid[i] = '-';\r\n    } else if (i === 14) {\r\n      uuid[i] = '4';\r\n    } else {\r\n      if (rnd <= 0x02) rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;\r\n      r = rnd & 0xf;\r\n      rnd = rnd >> 4;\r\n      uuid[i] = chars[(i === 19) ? (r & 0x3) | 0x8 : r];\r\n    }\r\n  }\r\n  return uuid.join('');\r\n}\r\n","import { Quaternion } from './quaternion';\r\nimport { Matrix4 } from '../math';\r\nimport { Spherical } from './Spherical';\r\nimport { DataObject, VectorDataObject, ArrayFlattenable } from './index';\r\n\r\nexport class Vector3\r\n  implements\r\n  DataObject<Vector3>,\r\n  VectorDataObject<Vector3>,\r\n  ArrayFlattenable<Vector3>\r\n{\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n\r\n  constructor(x?: number, y?: number, z?: number) {\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n    this.z = z || 0;\r\n  }\r\n\r\n  set(x: number, y: number, z: number): Vector3 {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n    return this;\r\n  }\r\n\r\n  setAll(x: number): Vector3 {\r\n    this.x = x;\r\n    this.y = x;\r\n    this.z = x;\r\n    return this;\r\n  }\r\n\r\n  copy(v: Vector3): Vector3 {\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n    return this;\r\n  }\r\n\r\n  equals(v: Vector3) {\r\n    return ((v.x === this.x) && (v.y === this.y)) && (v.z === this.z);\r\n  }\r\n\r\n  clone(): Vector3 {\r\n    return new Vector3(this.x, this.y, this.z);\r\n  }\r\n\r\n  add(v: Vector3): Vector3 {\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n    return this;\r\n  }\r\n\r\n  addVectors(a: Vector3, b: Vector3): Vector3 {\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n    return this;\r\n  }\r\n\r\n  sub(v: Vector3): Vector3 {\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n    return this;\r\n  }\r\n\r\n  subVectors(a: Vector3, b: Vector3): Vector3 {\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n    return this;\r\n  }\r\n\r\n  mag(): number {\r\n    return this.x * this.x + this.y * this.y + this.z * this.z;\r\n  }\r\n\r\n  length(): number {\r\n    return Math.sqrt(this.mag());\r\n  }\r\n\r\n  multiply(v: Vector3): Vector3 {\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n    this.z *= v.z;\r\n    return this;\r\n  }\r\n\r\n  multiplyScalar(scalar: number): Vector3 {\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n    return this;\r\n  }\r\n\r\n  normalize(): Vector3 {\r\n    const inv_length = 1.0 / this.length();\r\n    return this.multiplyScalar(inv_length);\r\n  }\r\n\r\n  lengthManhattan() {\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);\r\n  }\r\n\r\n  min(v: Vector3) {\r\n    this.x = Math.min(this.x, v.x);\r\n    this.y = Math.min(this.y, v.y);\r\n    this.z = Math.min(this.z, v.z);\r\n    return this;\r\n  }\r\n\r\n  max(v: Vector3) {\r\n    this.x = Math.max(this.x, v.x);\r\n    this.y = Math.max(this.y, v.y);\r\n    this.z = Math.max(this.z, v.z);\r\n    return this;\r\n  }\r\n\r\n  clamp(min: Vector3, max: Vector3): Vector3 {\r\n    this.x = Math.max(min.x, Math.min(max.x, this.x));\r\n    this.y = Math.max(min.y, Math.min(max.y, this.y));\r\n    this.z = Math.max(min.z, Math.min(max.z, this.z));\r\n    return this;\r\n  }\r\n\r\n  dot(v: Vector3): number {\r\n    return this.x * v.x + this.y * v.y + this.z * v.z;\r\n  }\r\n\r\n  crossVectors(a: Vector3, b: Vector3): Vector3 {\r\n    const ax = a.x, ay = a.y, az = a.z;\r\n    const bx = b.x, by = b.y, bz = b.z;\r\n    this.x = ay * bz - az * by;\r\n    this.y = az * bx - ax * bz;\r\n    this.z = ax * by - ay * bx;\r\n    return this;\r\n  }\r\n\r\n  cross(v: Vector3): Vector3 {\r\n    return this.crossVectors(this, v);\r\n  }\r\n\r\n  setFromQuaternion(q: Quaternion): Vector3 {\r\n    const x = this.x, y = this.y, z = this.z;\r\n    const qx = q.x, qy = q.y, qz = q.z, qw = q.w;\r\n\r\n    // calculate quat * vector\r\n    const ix = qw * x + qy * z - qz * y;\r\n    const iy = qw * y + qz * x - qx * z;\r\n    const iz = qw * z + qx * y - qy * x;\r\n    const iw = - qx * x - qy * y - qz * z;\r\n\r\n    // calculate result * inverse quat\r\n    this.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n    this.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n    this.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n    return this;\r\n  }\r\n\r\n  setFromSpherical(s: Spherical): Vector3 {\r\n    const sinRadius = Math.sin(s.polar) * s.radius;\r\n    this.x = sinRadius * Math.sin(s.azim);\r\n    this.y = Math.cos(s.polar) * s.radius;\r\n    this.z = sinRadius * Math.cos(s.azim);\r\n    return this;\r\n  }\r\n\r\n  applyMatrix4(m: Matrix4): Vector3 {\r\n    const x = this.x;\r\n    const y = this.y;\r\n    const z = this.z;\r\n    const e = m.elements;\r\n\r\n    const w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\r\n    this.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\r\n    this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\r\n    this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\r\n\r\n    return this;\r\n  }\r\n\r\n  transformDirection(m: Matrix4): Vector3 {\r\n    // input: THREE.Matrix4 affine matrix\r\n    // vector interpreted as a direction\r\n    var x = this.x, y = this.y, z = this.z;\r\n    var e = m.elements;\r\n    this.x = e[0] * x + e[4] * y + e[8] * z;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z;\r\n    return this.normalize();\r\n  }\r\n\r\n  setFromMatrixPosition(m: Matrix4): Vector3 {\r\n    var e = m.elements;\r\n    this.x = e[12];\r\n    this.y = e[13];\r\n    this.z = e[14];\r\n    return this;\r\n  }\r\n\r\n  project(matrixWorldInverse: Matrix4, projectionMatrix: Matrix4) {\r\n    return this.applyMatrix4(matrixWorldInverse).applyMatrix4(projectionMatrix);\r\n  }\r\n\r\n  unProject(matrixWorld: Matrix4, projectionMatrix: Matrix4) {\r\n    const tempMatrix = new Matrix4();\r\n    tempMatrix.multiplyMatrices(matrixWorld, tempMatrix.getInverse(projectionMatrix, false));\r\n    return this.applyMatrix4(tempMatrix);\r\n  }\r\n\r\n  distanceTo(v: Vector3) {\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n  }\r\n\r\n  distanceToSquared(v: Vector3) {\r\n    var dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\r\n    return dx * dx + dy * dy + dz * dz;\r\n  }\r\n\r\n  getBuffer(): Float32Array {\r\n    return new Float32Array([this.x, this.y, this.z]);\r\n  }\r\n\r\n  fromArray(array: number[], offset?: number) {\r\n    if (offset === undefined) offset = 0;\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n    return this;\r\n  }\r\n\r\n  toArray(array?: number[], offset?: number) {\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n    return array;\r\n  }\r\n\r\n  static flatten(v: Vector3, array: number[]) {\r\n    return v.toArray(array, 0);\r\n  }\r\n}","import { DataObject, ArrayFlattenable, VectorDataObject } from \"./index\";\r\nimport { Matrix4 } from \"./matrix4\";\r\nimport { Quaternion } from \"./quaternion\";\r\n\r\nexport class Vector4\r\n  implements\r\n  DataObject<Vector4>,\r\n  VectorDataObject<Vector4>,\r\n  ArrayFlattenable<Vector4>\r\n{\r\n  constructor(x?: number, y?: number, z?: number, w?: number) {\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n    this.z = z || 0;\r\n    this.w = (w !== undefined) ? w : 1;\r\n  }\r\n\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n  w: number;\r\n  isVector4:true = true;\r\n\r\n  clone(){\r\n    return new Vector4(this.x, this.y, this.z, this.w);\r\n  }\r\n\r\n  copy(v: Vector4) {\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    this.z = v.z;\r\n    this.w = (v.w !== undefined) ? v.w : 1;\r\n    return this;\r\n  }\r\n\r\n  equals(v: Vector4) {\r\n    return ((v.x === this.x) && (v.y === this.y) && (v.z === this.z) && (v.w === this.w));\r\n  }\r\n\r\n  set (x: number, y: number, z: number, w: number) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n    this.w = w;\r\n    return this;\r\n  }\r\n\r\n  setScalar (scalar: number) {\r\n    this.x = scalar;\r\n    this.y = scalar;\r\n    this.z = scalar;\r\n    this.w = scalar;\r\n    return this;\r\n  }\r\n\r\n  setX (x: number) {\r\n    this.x = x;\r\n    return this;\r\n  }\r\n\r\n  setY (y: number) {\r\n    this.y = y;\r\n    return this;\r\n  }\r\n\r\n  setZ (z: number) {\r\n    this.z = z;\r\n    return this;\r\n  }\r\n\r\n  setW (w: number) {\r\n    this.w = w;\r\n    return this;\r\n  }\r\n\r\n  setComponent (index: number, value: number) {\r\n    switch (index) {\r\n      case 0: this.x = value; break;\r\n      case 1: this.y = value; break;\r\n      case 2: this.z = value; break;\r\n      case 3: this.w = value; break;\r\n      default: throw new Error('index is out of range: ' + index);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  getComponent (index: number) {\r\n    switch (index) {\r\n      case 0: return this.x;\r\n      case 1: return this.y;\r\n      case 2: return this.z;\r\n      case 3: return this.w;\r\n      default: throw new Error('index is out of range: ' + index);\r\n    }\r\n  }\r\n\r\n  setAxisAngleFromQuaternion (q: Quaternion) {\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n    // q is assumed to be normalized\r\n    this.w = 2 * Math.acos(q.w);\r\n    var s = Math.sqrt(1 - q.w * q.w);\r\n    if (s < 0.0001) {\r\n      this.x = 1;\r\n      this.y = 0;\r\n      this.z = 0;\r\n    } else {\r\n      this.x = q.x / s;\r\n      this.y = q.y / s;\r\n      this.z = q.z / s;\r\n    }\r\n    return this;\r\n  }\r\n\r\n\r\n  add (v: Vector4) {\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    this.z += v.z;\r\n    this.w += v.w;\r\n    return this;\r\n  }\r\n\r\n  addScalar (s: number) {\r\n    this.x += s;\r\n    this.y += s;\r\n    this.z += s;\r\n    this.w += s;\r\n    return this;\r\n  }\r\n\r\n  addVectors (a: Vector4, b: Vector4) {\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    this.z = a.z + b.z;\r\n    this.w = a.w + b.w;\r\n    return this;\r\n  }\r\n\r\n  addScaledVector (v: Vector4, s: number) {\r\n    this.x += v.x * s;\r\n    this.y += v.y * s;\r\n    this.z += v.z * s;\r\n    this.w += v.w * s;\r\n    return this;\r\n  }\r\n\r\n  sub (v: Vector4) {\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    this.z -= v.z;\r\n    this.w -= v.w;\r\n    return this;\r\n  }\r\n\r\n  subScalar (s: number) {\r\n    this.x -= s;\r\n    this.y -= s;\r\n    this.z -= s;\r\n    this.w -= s;\r\n    return this;\r\n\r\n  }\r\n\r\n  subVectors (a: Vector4, b: Vector4) {\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    this.z = a.z - b.z;\r\n    this.w = a.w - b.w;\r\n    return this;\r\n\r\n  }\r\n\r\n  multiplyScalar (scalar: number) {\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    this.z *= scalar;\r\n    this.w *= scalar;\r\n    return this;\r\n  }\r\n\r\n  applyMatrix4 (m: Matrix4) {\r\n    var x = this.x, y = this.y, z = this.z, w = this.w;\r\n    var e = m.elements;\r\n    this.x = e[0] * x + e[4] * y + e[8] * z + e[12] * w;\r\n    this.y = e[1] * x + e[5] * y + e[9] * z + e[13] * w;\r\n    this.z = e[2] * x + e[6] * y + e[10] * z + e[14] * w;\r\n    this.w = e[3] * x + e[7] * y + e[11] * z + e[15] * w;\r\n    return this;\r\n  }\r\n\r\n  divideScalar (scalar: number) {\r\n    return this.multiplyScalar(1 / scalar);\r\n  }\r\n\r\n  min (v: Vector4) {\r\n    this.x = Math.min(this.x, v.x);\r\n    this.y = Math.min(this.y, v.y);\r\n    this.z = Math.min(this.z, v.z);\r\n    this.w = Math.min(this.w, v.w);\r\n    return this;\r\n  }\r\n\r\n  max (v: Vector4) {\r\n    this.x = Math.max(this.x, v.x);\r\n    this.y = Math.max(this.y, v.y);\r\n    this.z = Math.max(this.z, v.z);\r\n    this.w = Math.max(this.w, v.w);\r\n    return this;\r\n  }\r\n\r\n  clamp (min: Vector4, max: Vector4) {\r\n    // assumes min < max, componentwise\r\n    this.x = Math.max(min.x, Math.min(max.x, this.x));\r\n    this.y = Math.max(min.y, Math.min(max.y, this.y));\r\n    this.z = Math.max(min.z, Math.min(max.z, this.z));\r\n    this.w = Math.max(min.w, Math.min(max.w, this.w));\r\n    return this;\r\n  }\r\n\r\n  clampScalar (minVal: number, maxVal: number) {\r\n      tempMin.set(minVal, minVal, minVal, minVal);\r\n      tempMax.set(maxVal, maxVal, maxVal, maxVal);\r\n      return this.clamp(tempMin, tempMax);\r\n    };\r\n\r\n  clampLength (min:  number, max:  number) {\r\n    var length = this.length();\r\n    return this.divideScalar(length || 1).multiplyScalar(Math.max(min, Math.min(max, length)));\r\n  }\r\n\r\n  floor () {\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    this.z = Math.floor(this.z);\r\n    this.w = Math.floor(this.w);\r\n    return this;\r\n  }\r\n\r\n  ceil () {\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    this.z = Math.ceil(this.z);\r\n    this.w = Math.ceil(this.w);\r\n    return this;\r\n  }\r\n\r\n  round () {\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    this.z = Math.round(this.z);\r\n    this.w = Math.round(this.w);\r\n    return this;\r\n  }\r\n\r\n  roundToZero () {\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    this.z = (this.z < 0) ? Math.ceil(this.z) : Math.floor(this.z);\r\n    this.w = (this.w < 0) ? Math.ceil(this.w) : Math.floor(this.w);\r\n    return this;\r\n  }\r\n\r\n  negate () {\r\n    this.x = - this.x;\r\n    this.y = - this.y;\r\n    this.z = - this.z;\r\n    this.w = - this.w;\r\n    return this;\r\n  }\r\n\r\n  dot (v: Vector4) {\r\n    return this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n  }\r\n\r\n  lengthSq () {\r\n    return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n  }\r\n\r\n  length () {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);\r\n  }\r\n\r\n  lengthManhattan () {\r\n    return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);\r\n  }\r\n\r\n  normalize () {\r\n    return this.divideScalar(this.length() || 1);\r\n  }\r\n\r\n  setLength (length: number) {\r\n    return this.normalize().multiplyScalar(length);\r\n  }\r\n\r\n  lerp (v: Vector4, alpha: number) {\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    this.z += (v.z - this.z) * alpha;\r\n    this.w += (v.w - this.w) * alpha;\r\n    return this;\r\n  }\r\n\r\n  lerpVectors (v1: Vector4, v2: Vector4, alpha: number) {\r\n    return this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n  }\r\n\r\n  setAxisAngleFromRotationMatrix(m: Matrix4) {\r\n\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var angle, x, y, z,\t\t// variables for result\r\n      epsilon = 0.01,\t\t// margin to allow for rounding errors\r\n      epsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n      te = m.elements,\r\n\r\n      m11 = te[0], m12 = te[4], m13 = te[8],\r\n      m21 = te[1], m22 = te[5], m23 = te[9],\r\n      m31 = te[2], m32 = te[6], m33 = te[10];\r\n\r\n    if ((Math.abs(m12 - m21) < epsilon) &&\r\n      (Math.abs(m13 - m31) < epsilon) &&\r\n      (Math.abs(m23 - m32) < epsilon)) {\r\n\r\n      // singularity found\r\n      // first check for identity matrix which must have +1 for all terms\r\n      // in leading diagonal and zero in other terms\r\n\r\n      if ((Math.abs(m12 + m21) < epsilon2) &&\r\n        (Math.abs(m13 + m31) < epsilon2) &&\r\n        (Math.abs(m23 + m32) < epsilon2) &&\r\n        (Math.abs(m11 + m22 + m33 - 3) < epsilon2)) {\r\n\r\n        // this singularity is identity matrix so angle = 0\r\n\r\n        this.set(1, 0, 0, 0);\r\n\r\n        return this; // zero angle, arbitrary axis\r\n\r\n      }\r\n\r\n      // otherwise this singularity is angle = 180\r\n\r\n      angle = Math.PI;\r\n\r\n      var xx = (m11 + 1) / 2;\r\n      var yy = (m22 + 1) / 2;\r\n      var zz = (m33 + 1) / 2;\r\n      var xy = (m12 + m21) / 4;\r\n      var xz = (m13 + m31) / 4;\r\n      var yz = (m23 + m32) / 4;\r\n\r\n      if ((xx > yy) && (xx > zz)) {\r\n\r\n        // m11 is the largest diagonal term\r\n\r\n        if (xx < epsilon) {\r\n\r\n          x = 0;\r\n          y = 0.707106781;\r\n          z = 0.707106781;\r\n\r\n        } else {\r\n\r\n          x = Math.sqrt(xx);\r\n          y = xy / x;\r\n          z = xz / x;\r\n\r\n        }\r\n\r\n      } else if (yy > zz) {\r\n\r\n        // m22 is the largest diagonal term\r\n\r\n        if (yy < epsilon) {\r\n          x = 0.707106781;\r\n          y = 0;\r\n          z = 0.707106781;\r\n\r\n        } else {\r\n          y = Math.sqrt(yy);\r\n          x = xy / y;\r\n          z = yz / y;\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        // m33 is the largest diagonal term so base result on this\r\n\r\n        if (zz < epsilon) {\r\n          x = 0.707106781;\r\n          y = 0.707106781;\r\n          z = 0;\r\n        } else {\r\n          z = Math.sqrt(zz);\r\n          x = xz / z;\r\n          y = yz / z;\r\n        }\r\n      }\r\n      this.set(x, y, z, angle);\r\n      return this; // return 180 deg rotation\r\n    }\r\n\r\n    // as we have reached here there are no singularities so we can handle normally\r\n    var s = Math.sqrt((m32 - m23) * (m32 - m23) +\r\n      (m13 - m31) * (m13 - m31) +\r\n      (m21 - m12) * (m21 - m12)); // used to normalize\r\n\r\n    if (Math.abs(s) < 0.001) s = 1;\r\n\r\n    // prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n    // caught by singularity test above, but I've left it in just in case\r\n    this.x = (m32 - m23) / s;\r\n    this.y = (m13 - m31) / s;\r\n    this.z = (m21 - m12) / s;\r\n    this.w = Math.acos((m11 + m22 + m33 - 1) / 2);\r\n    return this;\r\n  }\r\n\r\n  fromArray (array: number[], offset?: number) {\r\n    if (offset === undefined) offset = 0;\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    this.z = array[offset + 2];\r\n    this.w = array[offset + 3];\r\n    return this;\r\n  }\r\n\r\n  toArray (array?: number[], offset?: number) {\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    array[offset + 2] = this.z;\r\n    array[offset + 3] = this.w;\r\n    return array;\r\n  }\r\n\r\n  static flatten(v: Vector4, array: number[]) {\r\n    return v.toArray(array, 0);\r\n  }\r\n  \r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst tempMin = new Vector4();\r\nconst tempMax = new Vector4();","import { Vector3 } from \"../math\";\r\nimport { Quaternion } from \"./quaternion\";\r\nimport { DataObject, ArrayFlattenable } from \"./index\";\r\n\r\nconst tempX: Vector3 = new Vector3();\r\nconst tempY: Vector3 = new Vector3();\r\nconst tempZ: Vector3 = new Vector3();\r\n\r\nexport class Matrix4\r\n  implements\r\n  DataObject<Matrix4>,\r\n  ArrayFlattenable<Matrix4>\r\n{\r\n  constructor() {\r\n\r\n  }\r\n\r\n  copy(m: Matrix4) {\r\n    var te = this.elements;\r\n    var me = m.elements;\r\n    te[0] = me[0]; te[1] = me[1]; te[2] = me[2]; te[3] = me[3];\r\n    te[4] = me[4]; te[5] = me[5]; te[6] = me[6]; te[7] = me[7];\r\n    te[8] = me[8]; te[9] = me[9]; te[10] = me[10]; te[11] = me[11];\r\n    te[12] = me[12]; te[13] = me[13]; te[14] = me[14]; te[15] = me[15];\r\n    return this;\r\n  }\r\n\r\n  clone() {\r\n    return new Matrix4().fromArray(this.elements);\r\n  }\r\n\r\n  equals(matrix: Matrix4): boolean {\r\n    var te = this.elements;\r\n    var me = matrix.elements;\r\n    for (var i = 0; i < 16; i++) {\r\n      if (te[i] !== me[i]) return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  elements: number[] = [\r\n    1, 0, 0, 0,\r\n    0, 1, 0, 0,\r\n    0, 0, 1, 0,\r\n    0, 0, 0, 1\r\n  ]\r\n\r\n  set(n11: number, n12: number, n13: number, n14: number,\r\n    n21: number, n22: number, n23: number, n24: number,\r\n    n31: number, n32: number, n33: number, n34: number,\r\n    n41: number, n42: number, n43: number, n44: number) {\r\n    const te = this.elements;\r\n    te[0] = n11; te[4] = n12; te[8] = n13; te[12] = n14;\r\n    te[1] = n21; te[5] = n22; te[9] = n23; te[13] = n24;\r\n    te[2] = n31; te[6] = n32; te[10] = n33; te[14] = n34;\r\n    te[3] = n41; te[7] = n42; te[11] = n43; te[15] = n44;\r\n    return this;\r\n  }\r\n\r\n  compose(position: Vector3, quaternion: Quaternion, scale: Vector3) {\r\n    this.makeRotationFromQuaternion(quaternion);\r\n    this.scale(scale.x, scale.y, scale.z);\r\n    this.setPosition(position.x, position.y, position.z);\r\n    return this;\r\n  }\r\n\r\n  identity() {\r\n    this.set(\r\n      1, 0, 0, 0,\r\n      0, 1, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n    );\r\n    return this;\r\n  }\r\n\r\n  makePerspective(left: number, right: number, top: number,\r\n    bottom: number, near: number, far: number) {\r\n    const te = this.elements;\r\n    const x = 2 * near / (right - left);\r\n    const y = 2 * near / (top - bottom);\r\n\r\n    const a = (right + left) / (right - left);\r\n    const b = (top + bottom) / (top - bottom);\r\n    const c = - (far + near) / (far - near);\r\n    const d = - 2 * far * near / (far - near);\r\n\r\n    te[0] = x; te[4] = 0; te[8] = a; te[12] = 0;\r\n    te[1] = 0; te[5] = y; te[9] = b; te[13] = 0;\r\n    te[2] = 0; te[6] = 0; te[10] = c; te[14] = d;\r\n    te[3] = 0; te[7] = 0; te[11] = - 1; te[15] = 0;\r\n\r\n    return this;\r\n  }\r\n\r\n  makeOrthographic(left: number, right: number, top: number,\r\n    bottom: number, near: number, far: number) {\r\n    var te = this.elements;\r\n    var w = 1.0 / (right - left);\r\n    var h = 1.0 / (top - bottom);\r\n    var p = 1.0 / (far - near);\r\n\r\n    var x = (right + left) * w;\r\n    var y = (top + bottom) * h;\r\n    var z = (far + near) * p;\r\n\r\n    te[0] = 2 * w; te[4] = 0; te[8] = 0; te[12] = - x;\r\n    te[1] = 0; te[5] = 2 * h; te[9] = 0; te[13] = - y;\r\n    te[2] = 0; te[6] = 0; te[10] = - 2 * p; te[14] = - z;\r\n    te[3] = 0; te[7] = 0; te[11] = 0; te[15] = 1;\r\n\r\n    return this;\r\n  }\r\n\r\n  multiplyMatrices(a: Matrix4, b: Matrix4) {\r\n\r\n    var ae = a.elements;\r\n    var be = b.elements;\r\n    var te = this.elements;\r\n\r\n    var a11 = ae[0], a12 = ae[4], a13 = ae[8], a14 = ae[12];\r\n    var a21 = ae[1], a22 = ae[5], a23 = ae[9], a24 = ae[13];\r\n    var a31 = ae[2], a32 = ae[6], a33 = ae[10], a34 = ae[14];\r\n    var a41 = ae[3], a42 = ae[7], a43 = ae[11], a44 = ae[15];\r\n\r\n    var b11 = be[0], b12 = be[4], b13 = be[8], b14 = be[12];\r\n    var b21 = be[1], b22 = be[5], b23 = be[9], b24 = be[13];\r\n    var b31 = be[2], b32 = be[6], b33 = be[10], b34 = be[14];\r\n    var b41 = be[3], b42 = be[7], b43 = be[11], b44 = be[15];\r\n\r\n    te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n    te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n    te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n    te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n    te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n    te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n    te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n    te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n    te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n    te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n    te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n    te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n    te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n    te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n    te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n    te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  getInverse(m: Matrix4, throwOnDegenerate: boolean) {\r\n    // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n    var te = this.elements,\r\n      me = m.elements,\r\n\r\n      n11 = me[0], n21 = me[1], n31 = me[2], n41 = me[3],\r\n      n12 = me[4], n22 = me[5], n32 = me[6], n42 = me[7],\r\n      n13 = me[8], n23 = me[9], n33 = me[10], n43 = me[11],\r\n      n14 = me[12], n24 = me[13], n34 = me[14], n44 = me[15],\r\n\r\n      t11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\r\n      t12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\r\n      t13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\r\n      t14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\r\n    var det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\r\n\r\n    if (det === 0) {\r\n      var msg = \"Matrix4.getInverse(): can't invert matrix, determinant is 0\";\r\n      if (throwOnDegenerate === true) {\r\n        throw new Error(msg);\r\n      } else {\r\n        console.warn(msg);\r\n      }\r\n      return this.identity();\r\n    }\r\n\r\n    var detInv = 1 / det;\r\n\r\n    te[0] = t11 * detInv;\r\n    te[1] = (n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44) * detInv;\r\n    te[2] = (n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44) * detInv;\r\n    te[3] = (n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43) * detInv;\r\n\r\n    te[4] = t12 * detInv;\r\n    te[5] = (n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44) * detInv;\r\n    te[6] = (n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44) * detInv;\r\n    te[7] = (n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43) * detInv;\r\n\r\n    te[8] = t13 * detInv;\r\n    te[9] = (n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44) * detInv;\r\n    te[10] = (n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44) * detInv;\r\n    te[11] = (n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43) * detInv;\r\n\r\n    te[12] = t14 * detInv;\r\n    te[13] = (n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34) * detInv;\r\n    te[14] = (n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34) * detInv;\r\n    te[15] = (n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33) * detInv;\r\n\r\n    return this;\r\n  }\r\n\r\n  public lookAt(origin: Vector3, target: Vector3, up: Vector3): Matrix4 {\r\n\r\n    const te = this.elements;\r\n\r\n    tempZ.copy(origin).sub(target);\r\n    if (tempZ.mag() === 0) {\r\n      tempZ.z = 1;\r\n    }\r\n\r\n    tempZ.normalize();\r\n    tempX.crossVectors(up, tempZ);\r\n    if (tempX.mag() === 0) {\r\n      if (Math.abs(up.z) === 1) {\r\n        tempZ.x += 0.0001;\r\n      } else {\r\n        tempZ.z += 0.0001;\r\n      }\r\n      tempZ.normalize();\r\n      tempX.crossVectors(up, tempZ);\r\n    }\r\n\r\n    tempX.normalize();\r\n    tempY.crossVectors(tempZ, tempX);\r\n\r\n    te[0] = tempX.x; te[4] = tempY.x; te[8] = tempZ.x;\r\n    te[1] = tempX.y; te[5] = tempY.y; te[9] = tempZ.y;\r\n    te[2] = tempX.z; te[6] = tempY.z; te[10] = tempZ.z;\r\n\r\n    return this;\r\n  };\r\n\r\n  scale(x: number, y: number, z: number) {\r\n    const te = this.elements;\r\n    te[0] *= x; te[4] *= y; te[8] *= z;\r\n    te[1] *= x; te[5] *= y; te[9] *= z;\r\n    te[2] *= x; te[6] *= y; te[10] *= z;\r\n    te[3] *= x; te[7] *= y; te[11] *= z;\r\n    return this;\r\n  }\r\n\r\n  setPosition(x: number, y: number, z: number) {\r\n    var te = this.elements;\r\n    te[12] = x;\r\n    te[13] = y;\r\n    te[14] = z;\r\n    return this;\r\n  }\r\n\r\n  getMaxScaleOnAxis() {\r\n    var te = this.elements;\r\n    var scaleXSq = te[0] * te[0] + te[1] * te[1] + te[2] * te[2];\r\n    var scaleYSq = te[4] * te[4] + te[5] * te[5] + te[6] * te[6];\r\n    var scaleZSq = te[8] * te[8] + te[9] * te[9] + te[10] * te[10];\r\n    return Math.sqrt(Math.max(scaleXSq, scaleYSq, scaleZSq));\r\n  }\r\n\r\n  makeRotationFromQuaternion(q: Quaternion) {\r\n    var te = this.elements;\r\n\r\n    var x = q.x, y = q.y, z = q.z, w = q.w;\r\n    var x2 = x + x, y2 = y + y, z2 = z + z;\r\n    var xx = x * x2, xy = x * y2, xz = x * z2;\r\n    var yy = y * y2, yz = y * z2, zz = z * z2;\r\n    var wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n    te[0] = 1 - (yy + zz);\r\n    te[4] = xy - wz;\r\n    te[8] = xz + wy;\r\n\r\n    te[1] = xy + wz;\r\n    te[5] = 1 - (xx + zz);\r\n    te[9] = yz - wx;\r\n\r\n    te[2] = xz - wy;\r\n    te[6] = yz + wx;\r\n    te[10] = 1 - (xx + yy);\r\n\r\n    // last column\r\n    te[3] = 0;\r\n    te[7] = 0;\r\n    te[11] = 0;\r\n\r\n    // bottom row\r\n    te[12] = 0;\r\n    te[13] = 0;\r\n    te[14] = 0;\r\n    te[15] = 1;\r\n    return this;\r\n  }\r\n\r\n  makeTranslation(x: number, y: number, z: number) {\r\n    this.set(\r\n      1, 0, 0, x,\r\n      0, 1, 0, y,\r\n      0, 0, 1, z,\r\n      0, 0, 0, 1\r\n    );\r\n    return this;\r\n  }\r\n\r\n  makeRotationX(theta: number) {\r\n    var c = Math.cos(theta), s = Math.sin(theta);\r\n    this.set(\r\n      1, 0, 0, 0,\r\n      0, c, - s, 0,\r\n      0, s, c, 0,\r\n      0, 0, 0, 1\r\n    );\r\n    return this;\r\n  }\r\n\r\n  makeRotationY(theta: number) {\r\n    var c = Math.cos(theta), s = Math.sin(theta);\r\n    this.set(\r\n      c, 0, s, 0,\r\n      0, 1, 0, 0,\r\n      - s, 0, c, 0,\r\n      0, 0, 0, 1\r\n    );\r\n    return this;\r\n  }\r\n\r\n  makeRotationZ(theta: number) {\r\n    var c = Math.cos(theta), s = Math.sin(theta);\r\n    this.set(\r\n      c, - s, 0, 0,\r\n      s, c, 0, 0,\r\n      0, 0, 1, 0,\r\n      0, 0, 0, 1\r\n    );\r\n    return this;\r\n  }\r\n\r\n  toArray(array: number[], offset: number) {\r\n\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n\r\n    var te = this.elements;\r\n\r\n    array[offset] = te[0];\r\n    array[offset + 1] = te[1];\r\n    array[offset + 2] = te[2];\r\n    array[offset + 3] = te[3];\r\n\r\n    array[offset + 4] = te[4];\r\n    array[offset + 5] = te[5];\r\n    array[offset + 6] = te[6];\r\n    array[offset + 7] = te[7];\r\n\r\n    array[offset + 8] = te[8];\r\n    array[offset + 9] = te[9];\r\n    array[offset + 10] = te[10];\r\n    array[offset + 11] = te[11];\r\n\r\n    array[offset + 12] = te[12];\r\n    array[offset + 13] = te[13];\r\n    array[offset + 14] = te[14];\r\n    array[offset + 15] = te[15];\r\n\r\n    return array;\r\n\r\n  }\r\n\r\n  fromArray(array: number[], offset?: number) {\r\n    if (offset === undefined) offset = 0;\r\n    for (var i = 0; i < 16; i++) {\r\n      this.elements[i] = array[i + offset];\r\n    }\r\n    return this;\r\n  }\r\n\r\n  static flatten(v: Matrix4, array: number[]) {\r\n    return v.toArray(array, 0);\r\n  }\r\n\r\n\r\n}","\r\nexport const MathUtil = {\r\n\r\n  DEG2RAD: Math.PI / 180,\r\n  RAD2DEG: 180 / Math.PI,\r\n\r\n  clamp: function (value: number, min: number, max: number) {\r\n    return Math.max(min, Math.min(max, value));\r\n  },\r\n\r\n  // compute euclidean modulo of m % n\r\n  // https://en.wikipedia.org/wiki/Modulo_operation\r\n  euclideanModulo: function (n: number, m: number) {\r\n    return ((n % m) + m) % m;\r\n  },\r\n\r\n  // Linear mapping from range <a1, a2> to range <b1, b2>\r\n  mapLinear: function (x: number, a1: number, a2: number, b1: number, b2: number) {\r\n    return b1 + (x - a1) * (b2 - b1) / (a2 - a1);\r\n  },\r\n\r\n  // https://en.wikipedia.org/wiki/Linear_interpolation\r\n  lerp: function (x: number, y: number, t: number) {\r\n    return (1 - t) * x + t * y;\r\n  },\r\n\r\n  // http://en.wikipedia.org/wiki/Smoothstep\r\n  smoothstep: function (x: number, min: number, max: number) {\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n    x = (x - min) / (max - min);\r\n    return x * x * (3 - 2 * x);\r\n  },\r\n\r\n  smootherstep: function (x: number, min: number, max: number) {\r\n    if (x <= min) return 0;\r\n    if (x >= max) return 1;\r\n    x = (x - min) / (max - min);\r\n    return x * x * x * (x * (x * 6 - 15) + 10);\r\n  },\r\n\r\n  // Random integer from <low, high> interval\r\n  randInt: function (low: number, high: number) {\r\n    return low + Math.floor(Math.random() * (high - low + 1));\r\n  },\r\n\r\n  // Random float from <low, high> interval\r\n  randFloat: function (low: number, high: number) {\r\n    return low + Math.random() * (high - low);\r\n  },\r\n\r\n  // Random float from <-range/2, range/2> interval\r\n  randFloatSpread: function (range: number) {\r\n    return range * (0.5 - Math.random());\r\n  },\r\n\r\n  degToRad: function (degrees: number) {\r\n    return degrees * MathUtil.DEG2RAD;\r\n  },\r\n\r\n  radToDeg: function (radians: number) {\r\n    return radians * MathUtil.RAD2DEG;\r\n  },\r\n\r\n  isPowerOfTwo: function (value: number) {\r\n    return (value & (value - 1)) === 0 && value !== 0;\r\n  },\r\n\r\n  nearestPowerOfTwo: function (value: number) {\r\n    return Math.pow(2, Math.round(Math.log(value) / Math.LN2));\r\n  },\r\n\r\n  nextPowerOfTwo: function (value: number) {\r\n    value--;\r\n    value |= value >> 1;\r\n    value |= value >> 2;\r\n    value |= value >> 4;\r\n    value |= value >> 8;\r\n    value |= value >> 16;\r\n    value++;\r\n    return value;\r\n  }\r\n\r\n};\r\n\r\n","import { Quaternion } from './quaternion';\r\nimport { Vector3 } from './vector3';\r\nimport { Matrix4 } from './matrix4';\r\nimport { MathUtil } from './util';\r\nimport { DataObject } from './index';\r\n\r\nexport enum EulerOrder {\r\n  'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX'\r\n}\r\n\r\nconst tempMatrix = new Matrix4();\r\n\r\nexport class Euler implements DataObject<Euler>{\r\n  constructor(x?: number, y?: number, z?: number, order?: EulerOrder) {\r\n    this._x = x || 0;\r\n    this._y = y || 0;\r\n    this._z = z || 0;\r\n    this._order = order || Euler.defaultOrder;\r\n  }\r\n\r\n  static defaultOrder = EulerOrder.XYZ;\r\n\r\n  _x: number;\r\n  _y: number;\r\n  _z: number;\r\n  _order: EulerOrder = Euler.defaultOrder;\r\n\r\n  onChangeCallback: Function = () => { };\r\n\r\n  get x() { return this._x };\r\n  get y() { return this._y };\r\n  get z() { return this._z };\r\n  set x(value) { this._x = value; this.onChangeCallback(); };\r\n  set y(value) { this._y = value; this.onChangeCallback(); };\r\n  set z(value) { this._z = value; this.onChangeCallback(); };\r\n\r\n  get order() { return this._order };\r\n  set order(value: EulerOrder) { this._order = value };\r\n\r\n  clone() {\r\n    return new Euler(this._x, this._y, this._z, this._order);\r\n  }\r\n\r\n  copy(euler: Euler) {\r\n    this._x = euler._x;\r\n    this._y = euler._y;\r\n    this._z = euler._z;\r\n    this._order = euler._order;\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  equals(euler: Euler) {\r\n    return (euler._x === this._x) &&\r\n      (euler._y === this._y) &&\r\n      (euler._z === this._z) &&\r\n      (euler._order === this._order);\r\n  }\r\n\r\n  setFromRotationMatrix(m: Matrix4, order: EulerOrder, update: boolean) {\r\n    var clamp = MathUtil.clamp;\r\n\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n    var te = m.elements;\r\n    var m11 = te[0], m12 = te[4], m13 = te[8];\r\n    var m21 = te[1], m22 = te[5], m23 = te[9];\r\n    var m31 = te[2], m32 = te[6], m33 = te[10];\r\n\r\n    order = order || this._order;\r\n\r\n    if (order === EulerOrder.XYZ) {\r\n\r\n      this._y = Math.asin(clamp(m13, - 1, 1));\r\n      if (Math.abs(m13) < 0.99999) {\r\n        this._x = Math.atan2(- m23, m33);\r\n        this._z = Math.atan2(- m12, m11);\r\n      } else {\r\n        this._x = Math.atan2(m32, m22);\r\n        this._z = 0;\r\n      }\r\n\r\n    } else if (order === EulerOrder.YXZ) {\r\n\r\n      this._x = Math.asin(- clamp(m23, - 1, 1));\r\n      if (Math.abs(m23) < 0.99999) {\r\n        this._y = Math.atan2(m13, m33);\r\n        this._z = Math.atan2(m21, m22);\r\n      } else {\r\n        this._y = Math.atan2(- m31, m11);\r\n        this._z = 0;\r\n      }\r\n\r\n    } else if (order === EulerOrder.ZXY) {\r\n\r\n      this._x = Math.asin(clamp(m32, - 1, 1));\r\n      if (Math.abs(m32) < 0.99999) {\r\n        this._y = Math.atan2(- m31, m33);\r\n        this._z = Math.atan2(- m12, m22);\r\n      } else {\r\n        this._y = 0;\r\n        this._z = Math.atan2(m21, m11);\r\n      }\r\n\r\n    } else if (order === EulerOrder.ZYX) {\r\n\r\n      this._y = Math.asin(- clamp(m31, - 1, 1));\r\n      if (Math.abs(m31) < 0.99999) {\r\n        this._x = Math.atan2(m32, m33);\r\n        this._z = Math.atan2(m21, m11);\r\n      } else {\r\n        this._x = 0;\r\n        this._z = Math.atan2(- m12, m22);\r\n      }\r\n\r\n    } else if (order === EulerOrder.YZX) {\r\n\r\n      this._z = Math.asin(clamp(m21, - 1, 1));\r\n\r\n      if (Math.abs(m21) < 0.99999) {\r\n        this._x = Math.atan2(- m23, m22);\r\n        this._y = Math.atan2(- m31, m11);\r\n      } else {\r\n        this._x = 0;\r\n        this._y = Math.atan2(m13, m33);\r\n      }\r\n\r\n    } else if (order === EulerOrder.XZY) {\r\n\r\n      this._z = Math.asin(- clamp(m12, - 1, 1));\r\n\r\n      if (Math.abs(m12) < 0.99999) {\r\n        this._x = Math.atan2(m32, m22);\r\n        this._y = Math.atan2(m13, m11);\r\n      } else {\r\n        this._x = Math.atan2(- m23, m33);\r\n        this._y = 0;\r\n      }\r\n\r\n    }\r\n\r\n    this._order = order;\r\n    if (update !== false) this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  setFromQuaternion(q: Quaternion, order: EulerOrder, update: boolean) {\r\n    tempMatrix.makeRotationFromQuaternion(q);\r\n    return this.setFromRotationMatrix(tempMatrix, order, update);\r\n  };\r\n\r\n  set(x: number, y: number, z: number, order?: EulerOrder) {\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._order = order || this._order;\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  setFromVector3(v: Vector3, order: EulerOrder) {\r\n    return this.set(v.x, v.y, v.z, order || this._order);\r\n  }\r\n\r\n  fromArray(array: number[]) {\r\n    this._x = array[0];\r\n    this._y = array[1];\r\n    this._z = array[2];\r\n    if (array[3] !== undefined) this._order = array[3];\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  toArray(array: number[], offset: number) {\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n    array[offset] = this._x;\r\n    array[offset + 1] = this._y;\r\n    array[offset + 2] = this._z;\r\n    array[offset + 3] = this._order;\r\n    return array;\r\n  }\r\n\r\n  toVector3(optionalTarget: Vector3) {\r\n    if (optionalTarget) {\r\n      return optionalTarget.set(this._x, this._y, this._z);\r\n    } else {\r\n      return new Vector3(this._x, this._y, this._z);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n","import { Vector3 } from './vector3';\r\nimport { Matrix4 } from './matrix4';\r\nimport { Euler, EulerOrder } from './euler';\r\n\r\nconst v1: Vector3 = new Vector3\r\nlet r: number = 0;\r\nconst EPS: number = 0.000001;\r\n\r\nexport class Quaternion {\r\n\r\n  constructor(x?: number, y?: number, z?: number, w?: number) {\r\n    this._x = x || 0;\r\n    this._y = x || 0;\r\n    this._z = z || 0;\r\n    this._w = w || 1;\r\n  }\r\n\r\n  _x: number;\r\n  _y: number;\r\n  _z: number;\r\n  _w: number;\r\n\r\n  get x() { return this._x };\r\n  get y() { return this._y };\r\n  get z() { return this._z };\r\n  get w() { return this._w };\r\n  set x(value) { this._x = value; this.onChangeCallback(); };\r\n  set y(value) { this._y = value; this.onChangeCallback(); };\r\n  set z(value) { this._z = value; this.onChangeCallback(); };\r\n  set w(value) { this._w = value; this.onChangeCallback(); };\r\n\r\n  onChangeCallback: Function = () => { };\r\n\r\n  set(x: number, y: number, z: number, w: number): Quaternion {\r\n    this._x = x;\r\n    this._y = y;\r\n    this._z = z;\r\n    this._w = w;\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  copy(q: Quaternion): Quaternion {\r\n    this._x = q.x;\r\n    this._y = q.y;\r\n    this._z = q.z;\r\n    this._w = q.w;\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  clone(): Quaternion {\r\n    return new Quaternion(this._x, this._y, this._z, this._w);\r\n  }\r\n\r\n  inverse(): Quaternion {\r\n    this._x *= -1;\r\n    this._y *= -1;\r\n    this._z *= -1;\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  length(): number {\r\n    return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);\r\n  }\r\n\r\n  normalize(): Quaternion {\r\n    let l = this.length();\r\n    if (l === 0) {\r\n      this._x = 0;\r\n      this._y = 0;\r\n      this._z = 0;\r\n      this._w = 1;\r\n    } else {\r\n      l = 1 / l;\r\n      this._x = this._x * l;\r\n      this._y = this._y * l;\r\n      this._z = this._z * l;\r\n      this._w = this._w * l;\r\n    }\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  // assumes axis is normalized\r\n  setFromAxisAngle(axis: Vector3, angle: number): Quaternion {\r\n    const halfAngle = angle / 2;\r\n    const s = Math.sin(halfAngle);\r\n\r\n    this._x = axis.x * s;\r\n    this._y = axis.y * s;\r\n    this._z = axis.z * s;\r\n    this._w = Math.cos(halfAngle);\r\n\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n  setFromUnitVectors(vFrom: Vector3, vTo: Vector3) {\r\n    r = vFrom.dot(vTo) + 1;\r\n    if (r < EPS) {\r\n      r = 0;\r\n      if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\r\n        v1.set(- vFrom.y, vFrom.x, 0);\r\n      } else {\r\n        v1.set(0, - vFrom.z, vFrom.y);\r\n      }\r\n    } else {\r\n      v1.crossVectors(vFrom, vTo);\r\n    }\r\n    this._x = v1.x;\r\n    this._y = v1.y;\r\n    this._z = v1.z;\r\n    this._w = r;\r\n\r\n    this.onChangeCallback();\r\n    return this.normalize();\r\n  }\r\n\r\n  setFromRotationMatrix(m: Matrix4) {\r\n    // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n    const te = m.elements;\r\n    const m11 = te[0], m12 = te[4], m13 = te[8];\r\n    const m21 = te[1], m22 = te[5], m23 = te[9];\r\n    const m31 = te[2], m32 = te[6], m33 = te[10];\r\n    const trace = m11 + m22 + m33;\r\n    let s;\r\n\r\n    if (trace > 0) {\r\n      s = 0.5 / Math.sqrt(trace + 1.0);\r\n      this._w = 0.25 / s;\r\n      this._x = (m32 - m23) * s;\r\n      this._y = (m13 - m31) * s;\r\n      this._z = (m21 - m12) * s;\r\n    } else if (m11 > m22 && m11 > m33) {\r\n      s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\r\n      this._w = (m32 - m23) / s;\r\n      this._x = 0.25 * s;\r\n      this._y = (m12 + m21) / s;\r\n      this._z = (m13 + m31) / s;\r\n    } else if (m22 > m33) {\r\n      s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\r\n      this._w = (m13 - m31) / s;\r\n      this._x = (m12 + m21) / s;\r\n      this._y = 0.25 * s;\r\n      this._z = (m23 + m32) / s;\r\n    } else {\r\n      s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\r\n      this._w = (m21 - m12) / s;\r\n      this._x = (m13 + m31) / s;\r\n      this._y = (m23 + m32) / s;\r\n      this._z = 0.25 * s;\r\n    }\r\n\r\n    this.onChangeCallback();\r\n    return this;\r\n  }\r\n\r\n\r\n  setFromEuler(euler: Euler, update: boolean) {\r\n\r\n    var x = euler._x, y = euler._y, z = euler._z, order = euler.order;\r\n\r\n    // http://www.mathworks.com/matlabcentral/fileexchange/\r\n    // \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n    //\tcontent/SpinCalc.m\r\n\r\n    var cos = Math.cos;\r\n    var sin = Math.sin;\r\n\r\n    var c1 = cos(x / 2);\r\n    var c2 = cos(y / 2);\r\n    var c3 = cos(z / 2);\r\n\r\n    var s1 = sin(x / 2);\r\n    var s2 = sin(y / 2);\r\n    var s3 = sin(z / 2);\r\n\r\n    if (order === EulerOrder.XYZ) {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    } else if (order === EulerOrder.YXZ) {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    } else if (order === EulerOrder.ZXY) {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    } else if (order === EulerOrder.ZYX) {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    } else if (order === EulerOrder.YZX) {\r\n\r\n      this._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n    } else if (order === EulerOrder.XZY) {\r\n\r\n      this._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n      this._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n      this._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n      this._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n    }\r\n\r\n    if (update !== false) this.onChangeCallback();\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}","import { DataObject, VectorDataObject, ArrayFlattenable } from \"./index\";\r\nimport { Vector3 } from \"./vector3\";\r\n\r\nexport class Vector2\r\n  implements\r\n  DataObject<Vector2>,\r\n  VectorDataObject<Vector2>,\r\n  ArrayFlattenable<Vector2>\r\n{\r\n  constructor(x?: number, y?: number) {\r\n    this.x = x || 0;\r\n    this.y = y || 0;\r\n  }\r\n  x: number;\r\n  y: number;\r\n\r\n  get width() { return this.x; }\r\n  set width(value: number) { this.x = value }\r\n  get height() { return this.y; }\r\n  set height(value: number) { this.y = value }\r\n\r\n  set(x: number, y: number) {\r\n    this.x = x;\r\n    this.y = y;\r\n    return this;\r\n  }\r\n\r\n  setScalar(scalar: number) {\r\n    this.x = scalar;\r\n    this.y = scalar;\r\n    return this;\r\n  }\r\n\r\n  clone() {\r\n    return new Vector2(this.x, this.y);\r\n  }\r\n  copy(v: Vector2) {\r\n    this.x = v.x;\r\n    this.y = v.y;\r\n    return this;\r\n  }\r\n  equals(v: Vector2) {\r\n    return ((v.x === this.x) && (v.y === this.y));\r\n  }\r\n\r\n  add(v: Vector2) {\r\n    this.x += v.x;\r\n    this.y += v.y;\r\n    return this;\r\n  }\r\n\r\n  addScalar(s: number) {\r\n    this.x += s;\r\n    this.y += s;\r\n    return this;\r\n  }\r\n\r\n  addVectors(a: Vector2, b: Vector2) {\r\n    this.x = a.x + b.x;\r\n    this.y = a.y + b.y;\r\n    return this;\r\n  }\r\n\r\n  addScaledVector(v: Vector2, s: number) {\r\n    this.x += v.x * s;\r\n    this.y += v.y * s;\r\n    return this;\r\n  }\r\n\r\n  subScalar(s: number) {\r\n    this.x -= s;\r\n    this.y -= s;\r\n    return this;\r\n  }\r\n\r\n  subVectors(a: Vector2, b: Vector2) {\r\n    this.x = a.x - b.x;\r\n    this.y = a.y - b.y;\r\n    return this;\r\n  }\r\n\r\n  multiply(v: Vector2) {\r\n    this.x *= v.x;\r\n    this.y *= v.y;\r\n    return this;\r\n  }\r\n\r\n  multiplyScalar(scalar: number) {\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n    return this;\r\n  }\r\n\r\n  divide(v: Vector2) {\r\n    this.x /= v.x;\r\n    this.y /= v.y;\r\n    return this;\r\n  }\r\n\r\n  divideScalar(scalar: number) {\r\n    return this.multiplyScalar(1 / scalar);\r\n  }\r\n\r\n  sub(v: Vector2) {\r\n    this.x -= v.x;\r\n    this.y -= v.y;\r\n    return this;\r\n  }\r\n\r\n  min(v: Vector2) {\r\n    this.x = Math.min(this.x, v.x);\r\n    this.y = Math.min(this.y, v.y);\r\n    return this;\r\n  }\r\n  max(v: Vector2) {\r\n    this.x = Math.max(this.x, v.x);\r\n    this.y = Math.max(this.y, v.y);\r\n    return this;\r\n  }\r\n\r\n  length() {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n  }\r\n  lengthManhattan() {\r\n    return Math.abs(this.x) + Math.abs(this.y);\r\n  }\r\n\r\n  normalize() {\r\n    return this.divideScalar(this.length() || 1);\r\n  }\r\n\r\n  clamp(min: Vector2, max: Vector2) {\r\n    // assumes min < max, componentwise\r\n    this.x = Math.max(min.x, Math.min(max.x, this.x));\r\n    this.y = Math.max(min.y, Math.min(max.y, this.y));\r\n    return this;\r\n  }\r\n  clampScalar(minVal: number, maxVal: number) {\r\n    tempMin.set(minVal, minVal);\r\n    tempMax.set(maxVal, maxVal);\r\n    return this.clamp(tempMin, tempMax);\r\n  }\r\n  clampLength(min: number, max: number) {\r\n    var length = this.length();\r\n    return this.divideScalar(length || 1).multiplyScalar(Math.max(min, Math.min(max, length)));\r\n  }\r\n\r\n  public rotate(radians: number, anchor?: Vector2): Vector2 {\r\n    anchor = anchor || new Vector2();\r\n    const v = anchor.sub(this).multiplyScalar(-1);\r\n    const x = v.x;\r\n    const y = v.y;\r\n    const c = Math.cos(radians);\r\n    const s = Math.sin(radians);\r\n    this.x = x * c - y * s;\r\n    this.y = x * s + y * c;\r\n    return this;\r\n  }\r\n\r\n  floor() {\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    return this;\r\n  }\r\n  ceil() {\r\n    this.x = Math.ceil(this.x);\r\n    this.y = Math.ceil(this.y);\r\n    return this;\r\n  }\r\n  round() {\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    return this;\r\n  }\r\n  roundToZero() {\r\n    this.x = (this.x < 0) ? Math.ceil(this.x) : Math.floor(this.x);\r\n    this.y = (this.y < 0) ? Math.ceil(this.y) : Math.floor(this.y);\r\n    return this;\r\n  }\r\n\r\n  negate() {\r\n    this.x = - this.x;\r\n    this.y = - this.y;\r\n    return this;\r\n  }\r\n\r\n  dot(v: Vector2) {\r\n    return this.x * v.x + this.y * v.y;\r\n  }\r\n\r\n  lengthSq() {\r\n    return this.x * this.x + this.y * this.y;\r\n  }\r\n\r\n\r\n  angle() {\r\n    // computes the angle in radians with respect to the positive x-axis\r\n    var angle = Math.atan2(this.y, this.x);\r\n    if (angle < 0) angle += 2 * Math.PI;\r\n    return angle;\r\n  }\r\n\r\n  distanceTo(v: Vector2) {\r\n    return Math.sqrt(this.distanceToSquared(v));\r\n  }\r\n\r\n  distanceToSquared(v: Vector2) {\r\n    var dx = this.x - v.x, dy = this.y - v.y;\r\n    return dx * dx + dy * dy;\r\n  }\r\n\r\n  distanceToManhattan(v: Vector2) {\r\n    return Math.abs(this.x - v.x) + Math.abs(this.y - v.y);\r\n  }\r\n\r\n  setLength(length: number) {\r\n    return this.normalize().multiplyScalar(length);\r\n  }\r\n\r\n  lerp(v: Vector2, alpha: number) {\r\n    this.x += (v.x - this.x) * alpha;\r\n    this.y += (v.y - this.y) * alpha;\r\n    return this;\r\n  }\r\n\r\n  lerpVectors(v1: Vector2, v2: Vector2, alpha: number) {\r\n    return this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\r\n  }\r\n\r\n  rotateAround(center: Vector3, angle: number) {\r\n    var c = Math.cos(angle), s = Math.sin(angle);\r\n    var x = this.x - center.x;\r\n    var y = this.y - center.y;\r\n    this.x = x * c - y * s + center.x;\r\n    this.y = x * s + y * c + center.y;\r\n    return this;\r\n  }\r\n\r\n  fromArray(array: number[], offset?: number) {\r\n    if (offset === undefined) offset = 0;\r\n    this.x = array[offset];\r\n    this.y = array[offset + 1];\r\n    return this;\r\n  }\r\n\r\n  toArray(array?: number[], offset?: number) {\r\n    if (array === undefined) array = [];\r\n    if (offset === undefined) offset = 0;\r\n    array[offset] = this.x;\r\n    array[offset + 1] = this.y;\r\n    return array;\r\n  }\r\n\r\n  static flatten(v: Vector2, array: number[]) {\r\n    return v.toArray(array, 0);\r\n  }\r\n\r\n}\r\n\r\nconst tempMin = new Vector2();\r\nconst tempMax = new Vector2();\r\n\r\n","import { GLProgramConfig } from \"./program\";\r\nimport { Matrix4, Vector3 } from \"../math/index\";\r\nimport { Vector2 } from \"../math/vector2\";\r\nimport { Vector4 } from \"../math/vector4\";\r\n\r\nexport type GLData = number | Matrix4;\r\n\r\nexport type float = number;\r\n// export type floatVec2 = Vector2;\r\nexport type floatVec3 = Vector3;\r\n// export type floatVec4 = Vector4;\r\nexport type int = number;\r\n\r\nexport const enum GLDataType{\r\n  float,\r\n  floatVec2,\r\n  floatVec3,\r\n  floatVec4,\r\n  int,\r\n  intVec2,\r\n  intVec3,\r\n  intVec4,\r\n  Mat2,\r\n  Mat3,\r\n  Mat4,\r\n  boolean,\r\n  sampler2D\r\n}\r\n\r\nconst shaderStringMap: { [index: string]: GLDataType } = {\r\n  'float': GLDataType.float,\r\n  'vec2': GLDataType.floatVec2,\r\n  'vec3': GLDataType.floatVec3,\r\n  'vec4': GLDataType.floatVec4,\r\n  'mat2': GLDataType.Mat2,\r\n  'mat3': GLDataType.Mat3,\r\n  'mat4': GLDataType.Mat4,\r\n  'sampler2D': GLDataType.sampler2D\r\n}\r\nlet reverseShaderStringMap: { [index: number]: string } = {};\r\nObject.keys(shaderStringMap).forEach(key => {\r\n  reverseShaderStringMap[shaderStringMap[key]] = key\r\n})\r\n\r\nconst shaderAttributeStringInfo: { [index: string]: { type: GLDataType, stride: number, default: any} } = {\r\n  'float': { type: GLDataType.float, stride: 1, default: 0 },\r\n  'vec2': { type: GLDataType.floatVec2, stride: 2, default: new Vector2() },\r\n  'vec3': { type: GLDataType.floatVec3, stride: 3, default: new Vector3() },\r\n  'vec4': { type: GLDataType.floatVec4, stride: 4, default: new Vector4() },\r\n}\r\nlet reverseShaderAttributeStringInfo: { [index: number]: { name: string, stride: number , default: any} } = {};\r\nObject.keys(shaderAttributeStringInfo).forEach(key => {\r\n  reverseShaderAttributeStringInfo[shaderAttributeStringInfo[key].type] =\r\n    { name: key, stride: shaderAttributeStringInfo[key].stride , default: shaderAttributeStringInfo[key].default}\r\n})\r\n\r\nexport function getShaderTypeStringFromGLDataType(type: GLDataType) {\r\n  return reverseShaderStringMap[type];\r\n}\r\n\r\nexport function getGLDataTypeStride(type: GLDataType) {\r\n  return reverseShaderAttributeStringInfo[type].stride;\r\n}\r\n\r\nexport function getGLDataTypeDefaultDefaultValue(type: GLDataType) {\r\n  const value = reverseShaderAttributeStringInfo[type].default;\r\n  try {\r\n    const clonedValue = value.clone();\r\n    return clonedValue;\r\n  } catch (error) {\r\n    return value\r\n  }\r\n}\r\n\r\nfunction AttributeGLDataType2ShaderString(type: GLDataType) {\r\n  return reverseShaderAttributeStringInfo[type].name;\r\n}\r\n\r\n\r\n\r\nexport function injectVertexShaderHeaders(config: GLProgramConfig, shaderText: string) {\r\n  let injectText = '';\r\n  injectText += generateAttributeString(config);\r\n  injectText += generateUniformString(config);\r\n  injectText += generateVaryingString(config);\r\n  return injectText + shaderText;\r\n}\r\n\r\nexport function injectFragmentShaderHeaders(config: GLProgramConfig, shaderText: string) {\r\n  let injectText = '';\r\n  injectText += 'precision highp float;\\n';\r\n  injectText += generateUniformString(config);\r\n  injectText += generateVaryingString(config);\r\n  injectText += generateTextureString(config);\r\n  return injectText + shaderText;\r\n}\r\n\r\nfunction generateTextureString(config: GLProgramConfig): string {\r\n  let text = '';\r\n  if (config.textures !== undefined) {\r\n    config.textures.forEach(texture => {\r\n      text = text + 'uniform sampler2D' + ' ' + texture.name + ';\\n';\r\n    })\r\n  }\r\n  return text;\r\n}\r\n\r\nfunction generateAttributeString(config: GLProgramConfig): string {\r\n  let text = '';\r\n  if (config.attributes !== undefined) {\r\n    config.attributes.forEach(att => {\r\n      const type = AttributeGLDataType2ShaderString(att.type);\r\n      text = text + 'attribute ' + type + ' ' + att.name + ';\\n';\r\n    })\r\n  }\r\n  return text;\r\n}\r\n\r\nfunction generateUniformString(config: GLProgramConfig): string {\r\n  let text = '';\r\n  if (config.uniforms !== undefined) {\r\n\r\n    for (const key in config.uniforms) {\r\n      const uni = config.uniforms[key];\r\n      const type = getShaderTypeStringFromGLDataType(uni.type);\r\n      text = text + 'uniform ' + type + ' ' + uni.name + ';\\n';\r\n    }\r\n  }\r\n  return text;\r\n}\r\n\r\nfunction generateVaryingString(config: GLProgramConfig): string {\r\n  let text = '';\r\n  if (config.varyings !== undefined) {\r\n    config.varyings.forEach(vary => {\r\n      const type = getShaderTypeStringFromGLDataType(vary.type);\r\n      text = text + 'varying ' + type + ' ' + vary.name + ';\\n';\r\n    })\r\n  }\r\n  return text;\r\n}","import { GLDataType } from \"../shader-util\";\r\nimport { Matrix4, Vector3 } from \"../../math/index\";\r\nimport { Vector2 } from \"../../math/vector2\";\r\nimport { Vector4 } from \"../../math/vector4\";\r\n\r\nexport function findUniformSetter(type: GLDataType) {\r\n  switch (type) {\r\n    case GLDataType.float: return setValue1f;\r\n    case GLDataType.floatVec2: return setValue2fv;\r\n    case GLDataType.floatVec3: return setValue3fv;\r\n    case GLDataType.floatVec4: return setValue4fv;\r\n\r\n    case GLDataType.Mat2: return setValue2m;\r\n    case GLDataType.Mat3: return setValue3m;\r\n    case GLDataType.Mat4: return setValue4m;\r\n\r\n    // case 0x8b5e: case 0x8d66: return setValueT1; // SAMPLER_2D, SAMPLER_EXTERNAL_OES\r\n    // case 0x8b60: return setValueT6; // SAMPLER_CUBE\r\n\r\n    case GLDataType.int: case GLDataType.boolean: return setValue1i; // INT, BOOL\r\n    // case 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n    // case 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n    // case 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n  }\r\n  throw 'uniform setter not found'\r\n}\r\n\r\nfunction setValue1f(gl: WebGLRenderingContext, location: any, v: number) { gl.uniform1f(location, v) }\r\nfunction setValue2fv(gl: WebGLRenderingContext, location: any, v: Float32Array) { gl.uniform2fv(location, v) }\r\nfunction setValue3fv(gl: WebGLRenderingContext, location: any, v: Float32Array) { gl.uniform3fv(location, v) }\r\nfunction setValue4fv(gl: WebGLRenderingContext, location: any, v: Float32Array) { gl.uniform4fv(location, v) }\r\n\r\nfunction setValue1i(gl: WebGLRenderingContext, location: any, v: number) { gl.uniform1i(location, v) }\r\n\r\nfunction setValue2m(gl: WebGLRenderingContext, location: any, v: Float32Array) { gl.uniformMatrix4fv(location, false, v) }\r\nfunction setValue3m(gl: WebGLRenderingContext, location: any, v: Float32Array) { gl.uniformMatrix4fv(location, false, v) }\r\nfunction setValue4m(gl: WebGLRenderingContext, location: any, v: Float32Array) { gl.uniformMatrix4fv(location, false, v) }\r\n\r\nfunction differNumber(newVal: number, oldVal: number) {\r\n  return newVal !== oldVal;\r\n}\r\nfunction differArray(newVal: number[], oldVal: number[]) {\r\n  if (newVal.length !== oldVal.length) {\r\n    return true;\r\n  }\r\n  for (let i = 0; i < newVal.length; i++) {\r\n    if (newVal[i] !== oldVal[i]) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction copyNumber(newVal: number, _target: number) {\r\n  return newVal;\r\n}\r\n\r\nfunction copyArray(newVal: number[], target: number[]) {\r\n  let targetReal = target;\r\n  if (target === undefined || newVal.length !== target.length) {\r\n    targetReal = [];\r\n  }\r\n  for (let i = 0; i < newVal.length; i++) {\r\n    targetReal[i] = newVal[i]\r\n  }\r\n  return targetReal;\r\n}\r\n\r\n\r\nexport function findUniformDiffer(type: GLDataType) {\r\n  if (type === GLDataType.float || type === GLDataType.int) {\r\n    return differNumber\r\n  } else {\r\n    return differArray\r\n  }\r\n}\r\n\r\nexport function findUniformCopier(type: GLDataType) {\r\n  if (type === GLDataType.float || type === GLDataType.int) {\r\n    return copyNumber\r\n  } else {\r\n    return copyArray\r\n  }\r\n}\r\n\r\nexport function findUniformFlattener(type: GLDataType) {\r\n  switch (type) {\r\n    case GLDataType.float: return (v: number) => v;\r\n    case GLDataType.floatVec2: return Vector2.flatten;\r\n    case GLDataType.floatVec3: return Vector3.flatten;\r\n    case GLDataType.floatVec4: return Vector4.flatten;\r\n\r\n    case GLDataType.Mat2: throw 'not support yet'; // _MAT2\r\n    case GLDataType.Mat3: throw 'not support yet' // _MAT3\r\n    case GLDataType.Mat4: return Matrix4.flatten // _MAT4\r\n\r\n    // case 0x8b5e: case 0x8d66: return setValueT1; // SAMPLER_2D, SAMPLER_EXTERNAL_OES\r\n    // case 0x8b60: return setValueT6; // SAMPLER_CUBE\r\n\r\n    // case 0x1404: case 0x8b56: return setValue1i; // INT, BOOL\r\n    // case 0x8b53: case 0x8b57: return setValue2iv; // _VEC2\r\n    // case 0x8b54: case 0x8b58: return setValue3iv; // _VEC3\r\n    // case 0x8b55: case 0x8b59: return setValue4iv; // _VEC4\r\n  }\r\n  throw 'uniform flattener not found'\r\n}\r\n\r\n","import { GLProgram } from \"../program\";\r\nimport { findUniformSetter, findUniformFlattener, findUniformDiffer, findUniformCopier } from \"./uniform-util\";\r\nimport { GLDataType } from \"../shader-util\";\r\nimport { Matrix4 } from \"../../math/matrix4\";\r\nimport { GLRenderer } from '../gl-renderer';\r\n\r\nexport type uniformUploadType = number | Float32Array | number[]\r\nexport type flattenerType= (value: any, receiveData: uniformUploadType) => uniformUploadType;\r\nexport type setterType= (gl: WebGLRenderingContext, location: WebGLUniformLocation, data: uniformUploadType) => void\r\nexport type copierType = (newValue: uniformUploadType, target: uniformUploadType) => uniformUploadType;\r\nexport type differType= (newValue: uniformUploadType, oldValue: uniformUploadType) => boolean;\r\n\r\nexport const enum InnerSupportUniform{\r\n  MMatrix,\r\n  VPMatrix,\r\n  LastVPMatrix\r\n}\r\n\r\nexport interface InnerUniformMapDescriptor{\r\n  name: string,\r\n  mapInner: InnerSupportUniform,     \r\n}\r\n\r\nexport const InnerUniformMap: Map<InnerSupportUniform, UniformDescriptor> = new Map();\r\nInnerUniformMap.set(InnerSupportUniform.MMatrix, {\r\n  name: 'MMatrix', type: GLDataType.Mat4, default: new Matrix4()\r\n})\r\nInnerUniformMap.set(InnerSupportUniform.VPMatrix, {\r\n  name: 'VPMatrix', type: GLDataType.Mat4, default: new Matrix4()\r\n})\r\nInnerUniformMap.set(InnerSupportUniform.LastVPMatrix, {\r\n  name: 'LastVPMatrix', type: GLDataType.Mat4, default: new Matrix4()\r\n})\r\n\r\n\r\n\r\nexport interface UniformDescriptor {\r\n  name: string,\r\n  type: GLDataType,\r\n  default?: any,\r\n  flattener?: flattenerType\r\n  setter?: setterType,\r\n  copier?: copierType,\r\n  differ?: differType\r\n  _innerGlobalUniform?: InnerSupportUniform\r\n}\r\n\r\n\r\nexport function createUniform(program: GLProgram, descriptor: UniformDescriptor): GLUniform{\r\n  return new GLUniform(program, descriptor);\r\n}\r\n\r\nexport function getInnerUniformDescriptor(des: InnerUniformMapDescriptor): UniformDescriptor {\r\n  const tempDescriptor = InnerUniformMap.get(des.mapInner);\r\n  const descriptor = {\r\n    name: des.name,\r\n    type: tempDescriptor.type,\r\n    default: tempDescriptor.default, // TODO default seems not useful\r\n    _innerGlobalUniform: des.mapInner\r\n  }\r\n  return descriptor;\r\n}\r\n\r\nexport class GLUniform{\r\n  constructor(program: GLProgram, descriptor: UniformDescriptor) {\r\n    this.name = descriptor.name;\r\n    this.renderer = program.renderer;\r\n    this.gl = program.renderer.gl;\r\n    const glProgram = program.getProgram();\r\n    const location = this.gl.getUniformLocation(glProgram, descriptor.name);\r\n    this.isActive = location !== null;\r\n    this.location = location;\r\n    \r\n    this.flattener = descriptor.flattener !== undefined ?\r\n    descriptor.flattener : findUniformFlattener(descriptor.type);\r\n\r\n    this.setter = descriptor.setter !== undefined ?\r\n      descriptor.setter : findUniformSetter(descriptor.type);\r\n    \r\n    this.differ = descriptor.differ !== undefined ?\r\n    descriptor.differ : findUniformDiffer(descriptor.type);\r\n  \r\n    this.copier = descriptor.copier !== undefined ?\r\n    descriptor.copier : findUniformCopier(descriptor.type);\r\n\r\n    this.innerGlobal = descriptor._innerGlobalUniform;\r\n  }\r\n  name: string;\r\n  private gl: WebGLRenderingContext;\r\n  private programChangeId: number = -1;\r\n  private renderer: GLRenderer;\r\n  \r\n  private location: WebGLUniformLocation;\r\n  innerGlobal?: InnerSupportUniform; \r\n  value: any;\r\n  private lastReceiveData: uniformUploadType;\r\n  private receiveData: uniformUploadType;\r\n  private setter: setterType;\r\n  private flattener: flattenerType\r\n  private differ: differType;\r\n  private copier: copierType;\r\n  private isActive: boolean;\r\n\r\n  set(value: any): void {\r\n    if (!this.isActive) {\r\n      return;\r\n    }\r\n    this.receiveData = this.flattener(value, this.receiveData);\r\n\r\n    if (this.lastReceiveData === undefined) { // this uniform never upload\r\n      this.lastReceiveData = this.flattener(value, this.lastReceiveData);\r\n      this.setter(this.gl, this.location, this.receiveData);\r\n      this.renderer.stat.uniformUpload++;\r\n      return;\r\n    }\r\n\r\n    let programSwitched = false;\r\n    if (this.programChangeId !== this.renderer._programChangeId) {\r\n      programSwitched = true;\r\n      this.programChangeId = this.renderer._programChangeId;\r\n    }\r\n\r\n    if (this.renderer.enableUniformDiff && !programSwitched) {\r\n      if (this.differ(this.receiveData, this.lastReceiveData)) {\r\n        this.setter(this.gl, this.location, this.receiveData);\r\n        this.renderer.stat.uniformUpload++;\r\n        this.lastReceiveData = this.copier(this.receiveData, this.lastReceiveData);\r\n      }\r\n    } else {\r\n      this.setter(this.gl, this.location, this.receiveData);\r\n      this.renderer.stat.uniformUpload++;\r\n    }\r\n  }\r\n\r\n}\r\n","import { GLDataType, getGLDataTypeStride } from \"./shader-util\";\r\nimport { GLProgram } from \"./program\";\r\nimport { Nullable } from \"../type\";\r\nimport { GLExtList } from \"./gl-info\";\r\n\r\nexport const enum CommonAttribute {\r\n  position = 'position',\r\n  normal = 'normal',\r\n  color = 'color',\r\n  uv = 'uv',\r\n}\r\n\r\nexport interface AttributeDescriptor {\r\n  name: string,\r\n  type: GLDataType,\r\n  asInstance?: boolean, // default false\r\n  instanceDivisor?: number // default 1\r\n}\r\n\r\nexport class GLAttribute {\r\n  constructor(program: GLProgram, descriptor: AttributeDescriptor) {\r\n    this.name = descriptor.name;\r\n    this.gl = program.renderer.gl;\r\n    this.location = this.gl.getAttribLocation(program.getProgram(), descriptor.name);\r\n    this.type = descriptor.type;\r\n    this.isActive = this.location !== -1;\r\n\r\n    const ext = program.renderer.glInfo.getExtension(GLExtList.ANGLE_instanced_arrays);\r\n    if (ext !== undefined) {\r\n      this.angleInstanceExt = ext;\r\n    }\r\n\r\n    if (descriptor.asInstance === true) {\r\n      program.useInstance = true;\r\n      this.asInstance = descriptor.asInstance\r\n      this.instanceDivisor = descriptor.instanceDivisor\r\n    }\r\n  }\r\n  \r\n  readonly name: string;\r\n  readonly gl: WebGLRenderingContext;\r\n  private angleInstanceExt: Nullable<ANGLE_instanced_arrays> = null;\r\n  readonly location: number;\r\n  readonly type: GLDataType;\r\n  readonly isActive: boolean;\r\n\r\n  readonly asInstance: boolean = false;\r\n  readonly instanceDivisor: number;\r\n\r\n  useBuffer(buffer: WebGLBuffer) {\r\n    if (!this.isActive) {\r\n      return;\r\n    }\r\n    const gl = this.gl;\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n    gl.vertexAttribPointer(this.location, getGLDataTypeStride(this.type), gl.FLOAT, false, 0, 0);\r\n    gl.enableVertexAttribArray(this.location);\r\n    if (this.asInstance) {\r\n      if (this.angleInstanceExt !== null) {\r\n        this.angleInstanceExt.vertexAttribDivisorANGLE(this.location, this.instanceDivisor);\r\n      } else {\r\n        throw \"instance not support\"\r\n      }\r\n    }\r\n    \r\n  }\r\n\r\n}","import { GLProgram } from \"../program\";\r\nimport { Nullable } from \"../../type\";\r\nimport { GLTextureSlot } from \"../states/gl-texture-slot\";\r\nimport { ChannelType } from \"../../core/material\";\r\nimport { GLRenderer } from '../gl-renderer';\r\n\r\nexport enum GLTextureType{\r\n  texture2D,\r\n}\r\n\r\nexport interface TextureDescriptor {\r\n  name: string,\r\n  channelType?: ChannelType,\r\n  type: GLTextureType,\r\n}\r\n\r\n/**\r\n * for texture uniform uploading\r\n * \r\n * @export\r\n * @class GLTextureUniform\r\n */\r\nexport class GLTextureUniform{\r\n  constructor(program: GLProgram, descriptor: TextureDescriptor) {\r\n    this.renderer = program.renderer;\r\n    this.slotManager = program.renderer.state.textureSlot;\r\n    this.gl = program.renderer.gl;\r\n    this.name = descriptor.name\r\n    this.channel = descriptor.channelType;\r\n    const glProgram = program.getProgram();\r\n    const location = this.gl.getUniformLocation(glProgram, descriptor.name);\r\n    this.isActive = location !== null;\r\n    this.location = location;\r\n    this.currentActiveSlot = -1;\r\n  }\r\n  name: string;\r\n  channel: ChannelType;\r\n  private gl: WebGLRenderingContext;\r\n  private slotManager: GLTextureSlot;\r\n  private renderer: GLRenderer;\r\n  private location: WebGLUniformLocation;\r\n  isActive: boolean;\r\n\r\n\r\n  webglTexture: Nullable<WebGLTexture> = null;\r\n  currentActiveSlot: number;\r\n\r\n  useTexture(webglTexture: WebGLTexture): void {\r\n    if (!this.isActive) {\r\n      return;\r\n    }\r\n    const textureSlot = this.slotManager.updateSlotTexture(webglTexture);\r\n    if (this.currentActiveSlot !== textureSlot) {\r\n      this.renderer.stat.uniformUpload++;\r\n      this.currentActiveSlot = textureSlot;\r\n      this.gl.uniform1i(this.location, textureSlot);\r\n    }\r\n  }\r\n\r\n}","\r\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants#Rendering_primitives\r\nexport const enum DrawMode {\r\n  POINTS = 0x0000,\r\n  LINES = 0x0001,\r\n  LINES_LOOP = 0x0002,\r\n  LINES_STRIP = 0x0002,\r\n  TRIANGLES = 0x0004,\r\n  TRIANGLE_STRIP = 0x0005,\r\n  TRIANGLE_FAN = 0x0006,\r\n}\r\n\r\nexport const enum CullSide {\r\n  CullFaceNone = 0,\r\n  CullFaceBack = 1,\r\n  CullFaceFront = 2,\r\n  CullFaceFrontBack = 3\r\n}\r\n\r\nexport const enum DepthFunction {\r\n  NeverDepth = 99,\r\n  AlwaysDepth = 1,\r\n  LessDepth = 2,\r\n  LessEqualDepth = 3,\r\n  EqualDepth = 4,\r\n  GreaterEqualDepth = 5,\r\n  GreaterDepth = 6,\r\n  NotEqualDepth = 7,\r\n}\r\n\r\nexport const enum BlendingMode {\r\n  NoBlending = 0,\r\n  NormalBlending = 1,\r\n  AdditiveBlending = 2,\r\n  SubtractiveBlending = 3,\r\n  MultiplyBlending = 4,\r\n  CustomBlending = 5,\r\n}\r\n\r\nexport const enum GLTextureTypeRaw {\r\n  texture2D = 0x0DE1,\r\n  textureCubeMap = 0x8513,\r\n}\r\n\r\n\r\nexport enum TextureFilter {\r\n  nearest = 0x2600,\r\n  linear = 0x2601,\r\n  NEAREST_MIPMAP_NEAREST = 0x2700,\r\n  LINEAR_MIPMAP_NEAREST = 0x2701,\r\n  NEAREST_MIPMAP_LINEAR = 0x2702,\r\n  LINEAR_MIPMAP_LINEAR = 0x2703\r\n}\r\n\r\nexport enum TextureWrap {\r\n  repeat = 0x2901,\r\n  clampToEdge = 0x812F,\r\n  mirroredRepeat = 0x8370\r\n}\r\n\r\n\r\nexport var FrontFaceDirectionCW = 0;\r\nexport var FrontFaceDirectionCCW = 1;\r\nexport var BasicShadowMap = 0;\r\nexport var PCFShadowMap = 1;\r\nexport var PCFSoftShadowMap = 2;\r\nexport var FrontSide = 0;\r\nexport var BackSide = 1;\r\nexport var DoubleSide = 2;\r\nexport var FlatShading = 1;\r\nexport var SmoothShading = 2;\r\nexport var NoColors = 0;\r\nexport var FaceColors = 1;\r\nexport var VertexColors = 2;\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants#Blending_equations\r\nexport const enum BlendEquation {\r\n  FUNC_ADD = 0x8006,\r\n  FUNC_SUBTRACT = 0x800A,\r\n  FUNC_REVERSE_SUBTRACT = 0x800B,\r\n}\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants#Blending_modes\r\nexport const enum BlendMode {\r\n  ZERO = 0,\r\n  ONE = 1,\r\n  SRC_COLOR = 0x0300,\r\n  ONE_MINUS_SRC_COLOR = 0x0301,\r\n  SRC_ALPHA = 0x0302,\r\n  ONE_MINUS_SRC_ALPHA = 0x0303,\r\n  DST_ALPHA= 0x0304,\r\n  ONE_MINUS_DST_ALPHA= 0x0305,\r\n  DST_COLOR= 0x0306,\r\n  ONE_MINUS_DST_COLOR= 0x0307,\r\n  SRC_ALPHA_SATURATE = 0x0308,\r\n  CONSTANT_COLOR = 0x8001,\r\n  ONE_MINUS_CONSTANT_COLOR = 0x8002,\r\n  CONSTANT_ALPHA = 0x8003,\r\n  ONE_MINUS_CONSTANT_ALPHA = 0x8004,\r\n}\r\n\r\n// MinEquation = 103,\r\n// MaxEquation = 104,\r\n\r\n\r\nexport var ZeroFactor = 200;\r\nexport var OneFactor = 201;\r\nexport var SrcColorFactor = 202;\r\nexport var OneMinusSrcColorFactor = 203;\r\nexport var SrcAlphaFactor = 204;\r\nexport var OneMinusSrcAlphaFactor = 205;\r\nexport var DstAlphaFactor = 206;\r\nexport var OneMinusDstAlphaFactor = 207;\r\nexport var DstColorFactor = 208;\r\nexport var OneMinusDstColorFactor = 209;\r\nexport var SrcAlphaSaturateFactor = 210;\r\n\r\n\r\n\r\nexport var MultiplyOperation = 0;\r\nexport var MixOperation = 1;\r\nexport var AddOperation = 2;\r\nexport var NoToneMapping = 0;\r\nexport var LinearToneMapping = 1;\r\nexport var ReinhardToneMapping = 2;\r\nexport var Uncharted2ToneMapping = 3;\r\nexport var CineonToneMapping = 4;\r\nexport var UVMapping = 300;\r\nexport var CubeReflectionMapping = 301;\r\nexport var CubeRefractionMapping = 302;\r\nexport var EquirectangularReflectionMapping = 303;\r\nexport var EquirectangularRefractionMapping = 304;\r\nexport var SphericalReflectionMapping = 305;\r\nexport var CubeUVReflectionMapping = 306;\r\nexport var CubeUVRefractionMapping = 307;\r\n\r\nexport var RepeatWrapping = 1000;\r\nexport var ClampToEdgeWrapping = 1001;\r\nexport var MirroredRepeatWrapping = 1002;\r\n\r\nexport var NearestFilter = 1003;\r\nexport var NearestMipMapNearestFilter = 1004;\r\nexport var NearestMipMapLinearFilter = 1005;\r\nexport var LinearFilter = 1006;\r\nexport var LinearMipMapNearestFilter = 1007;\r\nexport var LinearMipMapLinearFilter = 1008;\r\nexport var UnsignedByteType = 1009;\r\nexport var ByteType = 1010;\r\nexport var ShortType = 1011;\r\nexport var UnsignedShortType = 1012;\r\nexport var IntType = 1013;\r\nexport var UnsignedIntType = 1014;\r\nexport var FloatType = 1015;\r\nexport var HalfFloatType = 1016;\r\nexport var UnsignedShort4444Type = 1017;\r\nexport var UnsignedShort5551Type = 1018;\r\nexport var UnsignedShort565Type = 1019;\r\nexport var UnsignedInt248Type = 1020;\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants#Pixel_formats\r\nexport enum PixelFormat {\r\n  Alpha = 0x1906,\r\n  RGB = 0x1907,\r\n  RGBA = 0x1908,\r\n}\r\n\r\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants#Pixel_types\r\nexport enum PixelDataType {\r\n  UNSIGNED_BYTE = 0x1401,\r\n  UNSIGNED_SHORT_5_6_5 = 0x8033,\r\n  UNSIGNED_SHORT_4_4_4_4 = 0x8034,\r\n  UNSIGNED_SHORT_5_5_5_1 = 0x8363,\r\n  FLOAT,\r\n}\r\n\r\nexport var LuminanceFormat = 1024;\r\nexport var LuminanceAlphaFormat = 1025;\r\n// export var RGBEFormat = RGBAFormat;\r\nexport var DepthFormat = 1026;\r\nexport var DepthStencilFormat = 1027;\r\nexport var RGB_S3TC_DXT1_Format = 2001;\r\nexport var RGBA_S3TC_DXT1_Format = 2002;\r\nexport var RGBA_S3TC_DXT3_Format = 2003;\r\nexport var RGBA_S3TC_DXT5_Format = 2004;\r\nexport var RGB_PVRTC_4BPPV1_Format = 2100;\r\nexport var RGB_PVRTC_2BPPV1_Format = 2101;\r\nexport var RGBA_PVRTC_4BPPV1_Format = 2102;\r\nexport var RGBA_PVRTC_2BPPV1_Format = 2103;\r\nexport var RGB_ETC1_Format = 2151;\r\nexport var LoopOnce = 2200;\r\nexport var LoopRepeat = 2201;\r\nexport var LoopPingPong = 2202;\r\nexport var InterpolateDiscrete = 2300;\r\nexport var InterpolateLinear = 2301;\r\nexport var InterpolateSmooth = 2302;\r\nexport var ZeroCurvatureEnding = 2400;\r\nexport var ZeroSlopeEnding = 2401;\r\nexport var WrapAroundEnding = 2402;\r\nexport var TrianglesDrawMode = 0;\r\nexport var TriangleStripDrawMode = 1;\r\nexport var TriangleFanDrawMode = 2;\r\nexport var LinearEncoding = 3000;\r\nexport var sRGBEncoding = 3001;\r\nexport var GammaEncoding = 3007;\r\nexport var RGBEEncoding = 3002;\r\nexport var LogLuvEncoding = 3003;\r\nexport var RGBM7Encoding = 3004;\r\nexport var RGBM16Encoding = 3005;\r\nexport var RGBDEncoding = 3006;\r\nexport var BasicDepthPacking = 3200;\r\nexport var RGBADepthPacking = 3201;\r\n","import { GLRenderer } from \"./gl-renderer\";\r\nimport { GLShader, ShaderType } from \"./shader\";\r\nimport { generateUUID } from \"../math/uuid\";\r\nimport { injectVertexShaderHeaders, injectFragmentShaderHeaders, GLDataType, GLData } from \"./shader-util\";\r\nimport { GLUniform, UniformDescriptor, getInnerUniformDescriptor, InnerUniformMapDescriptor, InnerSupportUniform } from \"./uniform/uniform\";\r\nimport { AttributeDescriptor, GLAttribute } from \"./attribute\";\r\nimport { Nullable } from \"../type\";\r\nimport { GLTextureUniform, TextureDescriptor } from \"./uniform/uniform-texture\";\r\nimport { RenderEngine } from \"../engine/render-engine\";\r\n\r\nexport interface VaryingDescriptor {\r\n  name: string,\r\n  type: GLDataType\r\n}\r\n\r\nexport interface GLProgramConfig {\r\n  attributes: AttributeDescriptor[];\r\n  uniforms?: UniformDescriptor[];\r\n  uniformsIncludes?: InnerUniformMapDescriptor[];\r\n  _hasUniformIncludesExpand?: boolean;\r\n  varyings?: VaryingDescriptor[];\r\n  textures?: TextureDescriptor[];\r\n  vertexShaderString: string;\r\n  fragmentShaderString: string;\r\n  autoInjectHeader: boolean;\r\n  useIndex?: boolean;\r\n}\r\n\r\nfunction fulfillProgramConfig(config: GLProgramConfig){\r\n  if (config.useIndex === undefined) {\r\n    config.useIndex = true;\r\n  }\r\n  if (config.uniforms === undefined) {\r\n    config.uniforms = [];\r\n  }\r\n  if (config.uniformsIncludes !== undefined && config._hasUniformIncludesExpand !== true) {\r\n    config.uniformsIncludes.forEach(ui => {\r\n      (config.uniforms as UniformDescriptor[]).push(getInnerUniformDescriptor(ui));\r\n    })\r\n    config._hasUniformIncludesExpand = true;\r\n  }\r\n  return config;\r\n}\r\n\r\n\r\nexport class GLProgram{\r\n  constructor(renderer: GLRenderer, config: GLProgramConfig) {\r\n    fulfillProgramConfig(config);\r\n    this.renderer = renderer;\r\n\r\n    this.vertexShader = new GLShader(this.renderer, ShaderType.vertex);\r\n    this.fragmentShader = new GLShader(this.renderer, ShaderType.fragment);\r\n    this.compileShaders(config);\r\n\r\n    this.createProgram(this.vertexShader, this.fragmentShader);\r\n    this.createGLResource(config);\r\n    \r\n    if (config.uniformsIncludes !== undefined) {\r\n      config.uniformsIncludes.forEach(des => {\r\n        this.globalUniforms.push(this.uniforms[des.name])\r\n      })\r\n    }\r\n\r\n    this.config = config;\r\n    if (config.useIndex !== undefined) {\r\n      this.useIndexDraw = config.useIndex;\r\n    }\r\n    renderer.programManager.addNewProgram(this);\r\n\r\n  }\r\n  \r\n  id: string = generateUUID();\r\n\r\n  readonly renderer: GLRenderer;\r\n  private program: Nullable<WebGLProgram> = null;\r\n  getProgram(): WebGLProgram {\r\n    if (this.program === null) {\r\n      throw 'program is broken'\r\n    }\r\n    return this.program\r\n  };\r\n\r\n  private config: GLProgramConfig;\r\n  \r\n  getConfig(): Readonly<GLProgramConfig> {\r\n    return this.config;\r\n  }\r\n\r\n  private attributes: { [index: string]: GLAttribute } = {};\r\n  private uniforms: { [index: string]: GLUniform } = {};\r\n  private globalUniforms: GLUniform[] = [];\r\n  private textures: { [index: string]: GLTextureUniform } = {};\r\n\r\n  private vertexShader: GLShader;\r\n  private fragmentShader: GLShader;\r\n\r\n  framebufferTextureMap: { [index: string]: string } = {};\r\n\r\n  drawFrom: number = 0;\r\n  drawCount: number = 0;\r\n\r\n  instanceCount: number = 0;\r\n  useInstance: boolean = false;\r\n\r\n  useIndexDraw: boolean = false;\r\n  _indexUINT: boolean = false;\r\n  set indexUINT(value: boolean) {\r\n    if (value && !this._indexUINT && !this.renderer.glInfo.supportUintIndexDraw) {\r\n      throw \"your webgl not support uint draw\"\r\n    }\r\n    this._indexUINT = value\r\n  }\r\n\r\n\r\n  public defineFrameBufferTextureDep(framebufferName: string, uniformName: string) {\r\n    this.framebufferTextureMap[uniformName] = framebufferName;\r\n  }\r\n\r\n  public forUniforms(cb: (uniform: GLUniform) => any): void {\r\n    for (const key in this.textures) {\r\n      cb(this.uniforms[key]);\r\n    }\r\n  }\r\n\r\n  public forTextures(cb: (texture: GLTextureUniform) => any): void {\r\n    for (const key in this.textures) {\r\n      cb(this.textures[key]);\r\n    }\r\n  }\r\n\r\n  public forAttributes(cb: (texture: GLAttribute) => any): void {\r\n    for (const key in this.attributes) {\r\n      cb(this.attributes[key]);\r\n    }\r\n  }\r\n\r\n  private compileShaders(conf: GLProgramConfig) {\r\n    let vertexShaderString = conf.vertexShaderString;\r\n    let fragmentShaderString = conf.fragmentShaderString;\r\n    if (conf.autoInjectHeader) {\r\n      vertexShaderString = injectVertexShaderHeaders(conf, conf.vertexShaderString);\r\n      fragmentShaderString = injectFragmentShaderHeaders(conf, conf.fragmentShaderString);\r\n    }\r\n    this.vertexShader.compileShader(vertexShaderString);\r\n    this.fragmentShader.compileShader(fragmentShaderString);\r\n  }\r\n\r\n  private createProgram(vertexShader: GLShader, fragmentShader: GLShader) {\r\n    const gl = this.renderer.gl;\r\n    const program = gl.createProgram();\r\n    if (program === null) {\r\n      throw 'webgl program create failed';\r\n    }\r\n    this.program = program;\r\n    gl.attachShader(this.program, vertexShader.shader);\r\n    gl.attachShader(this.program, fragmentShader.shader);\r\n    gl.linkProgram(this.program);\r\n    if (!gl.getProgramParameter(this.program, gl.LINK_STATUS)) {\r\n      let info = gl.getProgramInfoLog(this.program);\r\n      throw 'Could not compile WebGL program. \\n\\n' + info;\r\n    }\r\n  }\r\n\r\n  private createGLResource(config: GLProgramConfig) {\r\n    if (config.attributes !== undefined) {\r\n      config.attributes.forEach(att => {\r\n        this.attributes[att.name] = new GLAttribute(this, att)\r\n      })\r\n    }\r\n    if (config.uniforms !== undefined) {\r\n      config.uniforms.forEach(uni => {\r\n        this.uniforms[uni.name] = new GLUniform(this, uni)\r\n      })\r\n    }\r\n    if (config.textures !== undefined) {\r\n      config.textures.forEach(tex => {\r\n        this.textures[tex.name] = new GLTextureUniform(this, tex);\r\n      })\r\n    }\r\n  }\r\n\r\n  updateAttribute(name: string, data: WebGLBuffer) {\r\n    const attribute = this.attributes[name];\r\n    if (attribute === undefined) {\r\n      throw 'try to set a none exist attribute';\r\n    }\r\n    attribute.useBuffer(data);\r\n  }\r\n\r\n  setTexture(name: string, webglTexture: WebGLTexture) {\r\n    this.textures[name].useTexture(webglTexture);\r\n  }\r\n\r\n  setDrawRange(start:number, count:number) {\r\n    this.drawFrom = start;\r\n    this.drawCount = count;\r\n  }\r\n\r\n  setUniform(name: string, data: GLData) {\r\n    this.uniforms[name].set(data);\r\n  }\r\n\r\n  setUniformIfExist(name: string, data: GLData) {\r\n    const uni = this.uniforms[name];\r\n    if (uni !== undefined) {\r\n      this.uniforms[name].set(data);\r\n    }\r\n  }\r\n\r\n  updateInnerGlobalUniforms(engine: RenderEngine) {\r\n    this.globalUniforms.forEach(uni => {\r\n      uni.set(engine.getGlobalUniform(uni.innerGlobal as InnerSupportUniform).value)\r\n    })\r\n  }\r\n\r\n  useIndexBuffer(buffer: WebGLBuffer) {\r\n    const gl = this.renderer.gl;\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\r\n  }\r\n\r\n  dispose() {\r\n    this.vertexShader.dispose();\r\n    this.fragmentShader.dispose();\r\n    this.renderer.gl.deleteProgram(this.program);\r\n  }\r\n}\r\n","import { GLRenderer } from \"./gl-renderer\";\r\nimport { GLProgram } from \"./program\";\r\nimport { GLReleasable } from '../type';\r\n\r\nexport class GLProgramManager implements GLReleasable {\r\n  \r\n  private programs: Map<string, GLProgram> = new Map();\r\n\r\n  addNewProgram(program: GLProgram) {\r\n    this.programs.set(program.id, program);\r\n  }\r\n\r\n  getProgram(storeId: string) {\r\n    return this.programs.get(storeId);\r\n  }\r\n\r\n  get compiledProgramsCount() {\r\n    return this.programs.size;\r\n  }\r\n\r\n  releaseGL() {\r\n    this.programs.forEach(program => {\r\n      program.dispose();\r\n    })\r\n    this.programs = new Map();\r\n  }\r\n\r\n}","import { GLRenderer } from \"./gl-renderer\";\r\nimport { GLReleasable } from '../type';\r\n\r\nexport class GLAttributeBufferDataManager implements GLReleasable {\r\n  constructor(renderer: GLRenderer) {\r\n    this.renderer = renderer;\r\n  }\r\n  readonly renderer: GLRenderer;\r\n  private buffers: WeakMap<ArrayBuffer, WebGLBuffer> = new WeakMap();\r\n\r\n  getGLBuffer(arraybuffer: ArrayBuffer): WebGLBuffer {\r\n    return this.buffers.get(arraybuffer);\r\n  }\r\n\r\n  createBuffer(data: ArrayBuffer, useForIndex: boolean): WebGLBuffer {\r\n    const gl = this.renderer.gl;\r\n    const buffer = gl.createBuffer();\r\n    if (buffer === null) {\r\n      throw 'webgl buffer create fail';\r\n    }\r\n    if (useForIndex) {\r\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\r\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, data, gl.STATIC_DRAW);\r\n    } else {\r\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n      gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\r\n    }\r\n    this.buffers.set(data, buffer);\r\n    return buffer;\r\n  }\r\n\r\n  disposeBuffer(data: ArrayBuffer) {\r\n    if (!this.buffers.has(data)) {\r\n      throw 'cant find buffer to dispose';\r\n    }\r\n    const gl = this.renderer.gl;\r\n    const buffer = this.buffers.get(data);\r\n    gl.deleteBuffer(buffer);\r\n    this.buffers.delete(data);\r\n  }\r\n\r\n  updateOrCreateBuffer(data: ArrayBuffer, useForIndex: boolean): WebGLBuffer {\r\n    if (!this.buffers.has(data)) {\r\n      return this.createBuffer(data, useForIndex);\r\n    }\r\n    this.disposeBuffer(data);\r\n    this.createBuffer(data, useForIndex);\r\n  }\r\n\r\n  releaseGL() {\r\n    this.buffers = new WeakMap();\r\n  }\r\n\r\n}","import { GLRenderer } from \"../gl-renderer\";\r\nimport { Vector4 } from \"../../math/vector4\";\r\n\r\nexport class GLColorBuffer{\r\n  static defaultClearColor = new Vector4(0.8, 0.8, 0.8, 1);\r\n  constructor(renderer: GLRenderer) {\r\n    this.gl = renderer.gl;\r\n    this.resetDefaultClearColor();\r\n  }\r\n\r\n  private gl: WebGLRenderingContext;\r\n\r\n  redMaskEnabled: boolean = false;\r\n  greenMaskEnabled: boolean = false;\r\n  blueMaskEnabled: boolean = false;\r\n  alphaMaskEnabled: boolean = false;\r\n\r\n  /**\r\n   * set color buffer mask, inner has diff check\r\n   *\r\n   * @param {boolean} redMask whether enable red channel color mask\r\n   * @param {boolean} greenMask whether enable green channel color mask\r\n   * @param {boolean} blueMask whether enable blue channel color mask\r\n   * @param {boolean} alphaMask whether enable alpha channel color mask\r\n   * @memberof GLColorBuffer\r\n   */\r\n  setColorMask(redMask: boolean, greenMask: boolean, blueMask: boolean, alphaMask: boolean) {\r\n    if (this.redMaskEnabled !== redMask ||\r\n      this.greenMaskEnabled !== greenMask ||\r\n      this.blueMaskEnabled !== blueMask ||\r\n      this.alphaMaskEnabled !== alphaMask\r\n    ) {\r\n      this.gl.colorMask(redMask, greenMask, blueMask, alphaMask);\r\n      this.redMaskEnabled = redMask;\r\n      this.greenMaskEnabled = greenMask;\r\n      this.blueMaskEnabled = blueMask;\r\n      this.alphaMaskEnabled = alphaMask;\r\n    }\r\n  }\r\n\r\n  // TODO premultiplied alpha\r\n  currentClearColor: Vector4 = new Vector4();\r\n  setClearColor(newColor: Vector4, premultipliedAlpha?: boolean) {\r\n    if (!newColor.equals(this.currentClearColor)) {\r\n      this.currentClearColor.copy(newColor);\r\n      this.gl.clearColor(newColor.x, newColor.y, newColor.z, newColor.w);\r\n    }\r\n  }\r\n\r\n  resetDefaultClearColor() {\r\n    this.setClearColor(GLColorBuffer.defaultClearColor);\r\n  }\r\n\r\n  clear() {\r\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n  }\r\n}\r\n","import { GLRenderer } from \"../gl-renderer\";\r\nimport { DepthFunction } from \"../const\";\r\n\r\nexport class GLDepthBuffer {\r\n  constructor(renderer: GLRenderer) {\r\n    this.gl = renderer.gl;\r\n    this.resetDefault();\r\n  }\r\n\r\n  currentDepthMask = null;\r\n  currentDepthFunc = null;\r\n  currentDepthClear = null;\r\n\r\n  readonly gl: WebGLRenderingContext;\r\n\r\n  private _enableTest = false;\r\n  set enableTest(value: boolean) {\r\n    if (this._enableTest !== value) {\r\n      if (value) {\r\n        this.gl.enable(this.gl.DEPTH_TEST);\r\n      } else {\r\n        this.gl.disable(this.gl.DEPTH_TEST);\r\n      }\r\n    }\r\n  }\r\n  get enableTest() {\r\n    return this._enableTest;\r\n  }\r\n\r\n  clear() {\r\n    this.gl.clear(this.gl.DEPTH_BUFFER_BIT);\r\n  }\r\n\r\n  resetDefault() {\r\n    this.enableTest = true;\r\n  }\r\n\r\n  setMask(value: boolean) {\r\n    if (this.currentDepthMask !== value) {\r\n      this.gl.depthMask(value);\r\n      this.currentDepthMask = value;\r\n    }\r\n  }\r\n\r\n  setFunc(depthFunc: DepthFunction) {\r\n    const gl = this.gl;\r\n    if (this.currentDepthFunc !== depthFunc) {\r\n      if (depthFunc) {\r\n        switch (depthFunc) {\r\n          case DepthFunction.NeverDepth:\r\n            gl.depthFunc(gl.NEVER);\r\n            break;\r\n          case DepthFunction.AlwaysDepth:\r\n            gl.depthFunc(gl.ALWAYS);\r\n            break;\r\n          case DepthFunction.LessDepth:\r\n            gl.depthFunc(gl.LESS);\r\n            break;\r\n          case DepthFunction.LessEqualDepth:\r\n            gl.depthFunc(gl.LEQUAL);\r\n            break;\r\n          case DepthFunction.EqualDepth:\r\n            gl.depthFunc(gl.EQUAL);\r\n            break;\r\n          case DepthFunction.GreaterEqualDepth:\r\n            gl.depthFunc(gl.GEQUAL);\r\n            break;\r\n          case DepthFunction.GreaterDepth:\r\n            gl.depthFunc(gl.GREATER);\r\n            break;\r\n          case DepthFunction.NotEqualDepth:\r\n            gl.depthFunc(gl.NOTEQUAL);\r\n            break;\r\n          default:\r\n            gl.depthFunc(gl.LEQUAL);\r\n        }\r\n      } else {\r\n        gl.depthFunc(gl.LEQUAL);\r\n      }\r\n      this.currentDepthFunc = depthFunc;\r\n    }\r\n  }\r\n\r\n}","import { GLRenderer } from \"../gl-renderer\";\r\nimport { GLTextureTypeRaw } from \"../const\";\r\nimport { GLParamList } from \"../gl-info\";\r\n\r\ninterface textureBindInfo {\r\n  type: GLTextureTypeRaw,\r\n  texture: WebGLTexture\r\n}\r\n\r\n/**\r\n * manage gl state about texture usage\r\n *\r\n * @export\r\n * @class GLTextureSlot\r\n */\r\nexport class GLTextureSlot {\r\n  constructor(renderer: GLRenderer) {\r\n    this.renderer = renderer;\r\n    this.gl = renderer.gl;\r\n    this.maxSupport = renderer.glInfo.getParameter(GLParamList.MAX_TEXTURE_SIZE);\r\n    generateTextureSlotMap(this.maxSupport, this.gl);\r\n  }\r\n  readonly renderer;\r\n  readonly gl;\r\n  readonly maxSupport;\r\n\r\n  private currentTextureSlot = null;\r\n  private currentBindTextures: textureBindInfo[] = [];\r\n\r\n  activeTexture(slot: number) {\r\n    if (this.currentTextureSlot !== slot) {\r\n      this.gl.activeTexture(slot);\r\n      this.currentTextureSlot = slot;\r\n    }\r\n  }\r\n\r\n  bindTexture(webglType: GLTextureTypeRaw, webglTexture: WebGLTexture) {\r\n    if (this.currentTextureSlot === null) {\r\n      this.activeTexture(this.gl.TEXTURE0);\r\n    }\r\n    let boundTexture = this.currentBindTextures[this.currentTextureSlot];\r\n    if (boundTexture === undefined) {\r\n      boundTexture = { type: undefined, texture: undefined };\r\n      this.currentBindTextures[this.currentTextureSlot] = boundTexture;\r\n    }\r\n    if (boundTexture.type !== webglType || boundTexture.texture !== webglTexture) {\r\n      this.gl.bindTexture(webglType, webglTexture);\r\n      boundTexture.type = webglType;\r\n      boundTexture.texture = webglTexture;\r\n    }\r\n  }\r\n\r\n  private slotIndex = 0;\r\n\r\n  resetSlotIndex() {\r\n    this.slotIndex = 0;\r\n  }\r\n\r\n  findSlot(webglTexture: WebGLTexture): number {\r\n    let slot = this.slotIndex;\r\n    if (this.slotIndex > this.maxSupport) {\r\n      throw 'texture use exceed max texture support'\r\n    }\r\n    this.slotIndex++;\r\n    return slot;\r\n  }\r\n\r\n  updateSlotTexture(webglTexture: WebGLTexture): number {\r\n    const textureSlotToUpdate = this.findSlot(webglTexture);\r\n    const textureSlotGLToUpdate = textureSlotMap[textureSlotToUpdate];\r\n    this.activeTexture(textureSlotGLToUpdate);\r\n    this.bindTexture(GLTextureTypeRaw.texture2D, webglTexture);\r\n    return textureSlotToUpdate;\r\n  }\r\n}\r\n\r\nconst textureSlotMap: number[] = [];\r\nfunction generateTextureSlotMap(maxTextureSlotSupport: number, gl: WebGLRenderingContext) {\r\n  for (let i = 0; i < maxTextureSlotSupport; i++) {\r\n    const name = `TEXTURE${i}`;\r\n    textureSlotMap[i] = gl[name];\r\n  }\r\n}","import { GLRenderer } from \"../gl-renderer\";\r\nimport { Vector4 } from \"../../math/vector4\";\r\nimport { CullSide } from \"../const\";\r\nimport { GLColorBuffer } from \"./gl-color-buffer\";\r\nimport { GLDepthBuffer } from \"./gl-depth-buffer\";\r\nimport { GLTextureSlot } from \"./gl-texture-slot\";\r\n\r\nexport class GLState {\r\n  constructor(renderer: GLRenderer) {\r\n    this.renderer = renderer;\r\n    this.gl = renderer.gl;\r\n    this.colorbuffer = new GLColorBuffer(renderer);\r\n    this.depthbuffer = new GLDepthBuffer(renderer);\r\n    this.textureSlot = new GLTextureSlot(renderer);\r\n  }\r\n  readonly renderer: GLRenderer;\r\n  readonly gl: WebGLRenderingContext;\r\n  readonly colorbuffer: GLColorBuffer;\r\n  readonly depthbuffer: GLDepthBuffer;\r\n  readonly textureSlot: GLTextureSlot;\r\n\r\n  currentViewport: Vector4 = new Vector4();\r\n  newViewport: Vector4 = new Vector4();\r\n  currentScissor: Vector4 = new Vector4();\r\n  newScissor: Vector4 = new Vector4();\r\n\r\n  // specifies the affine transformation of x and y \r\n  // from normalized device coordinates to window coordinates.\r\n  setViewport(x: number, y: number, width: number, height: number) {\r\n    this.newViewport.set(x, y, width, height);\r\n    if (!this.newViewport.equals(this.currentViewport)) {\r\n      this.gl.viewport(x, y, width, height);\r\n      this.currentViewport.copy(this.newViewport);\r\n    }\r\n  }\r\n\r\n  setFullScreenViewPort() {\r\n    this.setViewport(0, 0, this.renderer.width, this.renderer.height);\r\n  }\r\n\r\n  setScissor(x: number, y: number, width: number, height: number) {\r\n    this.newScissor.set(x, y, width, height);\r\n    if (!this.newScissor.equals(this.currentScissor)) {\r\n      this.gl.viewport(x, y, width, height);\r\n      this.currentScissor.copy(this.newScissor)\r\n    }\r\n  }\r\n\r\n  currentCullFace: CullSide = CullSide.CullFaceNone;\r\n  setCullFace(cullFace: CullSide) {\r\n    const gl = this.gl;\r\n    if (cullFace !== CullSide.CullFaceNone) {\r\n      gl.enable(gl.CULL_FACE);\r\n      if (cullFace !== this.currentCullFace) {\r\n        if (cullFace === CullSide.CullFaceBack) {\r\n          gl.cullFace(gl.BACK);\r\n        } else if (cullFace === CullSide.CullFaceFront) {\r\n          gl.cullFace(gl.FRONT);\r\n        } else {\r\n          gl.cullFace(gl.FRONT_AND_BACK);\r\n        }\r\n      }\r\n    } else {\r\n      gl.disable(gl.CULL_FACE);\r\n    }\r\n    this.currentCullFace = cullFace;\r\n  }\r\n\r\n  currentPolygonOffsetFactor: number = 0;\r\n  currentPolygonOffsetUnits: number = 0;\r\n\r\n  setPolygonOffset(polygonOffsetEnable: boolean, factor: number, units: number) {\r\n    const gl = this.gl;\r\n    if (polygonOffsetEnable) {\r\n      gl.enable(gl.POLYGON_OFFSET_FILL);\r\n      if (this.currentPolygonOffsetFactor !== factor || this.currentPolygonOffsetUnits !== units) {\r\n        gl.polygonOffset(factor, units);\r\n        this.currentPolygonOffsetFactor = factor;\r\n        this.currentPolygonOffsetUnits = units;\r\n      }\r\n    } else {\r\n      gl.disable(gl.POLYGON_OFFSET_FILL);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\n","import { GLRenderer } from \"./gl-renderer\";\r\nimport { TextureFilter, TextureWrap } from \"./const\";\r\nimport { Texture, HTMLImageTexture } from \"../core/texture\";\r\nimport { GLReleasable } from '../type';\r\nimport { FramebufferAttachTexture } from \"./gl-framebuffer\";\r\n\r\ninterface TextureDescriptor {\r\n  minFilter: TextureFilter;\r\n  maxFilter: TextureFilter;\r\n  sWrap: TextureWrap;\r\n  tWrap: TextureWrap;\r\n}\r\n\r\nconst DefaultTextureDescriptor = {\r\n  minFilter: TextureFilter.nearest,\r\n  maxFilter: TextureFilter.nearest,\r\n  sWrap: TextureWrap.clampToEdge,\r\n  tWrap: TextureWrap.clampToEdge,\r\n}\r\n\r\nconst defaultRenderTargetTextureDescriptor = DefaultTextureDescriptor;\r\n\r\n\r\n/**\r\n * responsible for webgl texture resource allocation and reallocation\r\n * outside request create webgl texture from given source or description\r\n * \r\n * @export\r\n * @class GLTextureManager\r\n */\r\nexport class GLTextureManager implements GLReleasable{\r\n  constructor(renderer: GLRenderer) {\r\n    this.renderer = renderer;\r\n    this.POTResizeCanvas = document.createElement('canvas')\r\n  }\r\n  readonly renderer: GLRenderer;\r\n  private textures: Map<Texture, WebGLTexture> = new Map();\r\n  private POTResizeCanvas: HTMLCanvasElement;\r\n  // private textures: Map<Texture, WebGLTextureWithVersionIDWrap> = new Map();\r\n\r\n  init() {\r\n    const gl = this.renderer.gl;\r\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\r\n  }\r\n\r\n  getGLTexture(texture: Texture) {\r\n    return this.textures.get(texture);\r\n  }\r\n\r\n  deleteGLTexture(texture: Texture) {\r\n    const glTexture = this.getGLTexture(texture);\r\n    this.renderer.gl.deleteTexture(glTexture);\r\n    this.textures.delete(texture);\r\n  }\r\n\r\n  createTextureFromImageElement(texture: HTMLImageTexture) {\r\n    const gl = this.renderer.gl;\r\n    const glTexture = this.createWebGLTexture(DefaultTextureDescriptor);\r\n    gl.bindTexture(gl.TEXTURE_2D, glTexture);\r\n  \r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, texture.image);\r\n    this.textures.set(texture, glTexture);\r\n    return glTexture;\r\n  }\r\n\r\n  createTextureForRenderTarget(texture: FramebufferAttachTexture) {\r\n    const gl = this.renderer.gl;\r\n    const glTexture = this.createWebGLTexture(defaultRenderTargetTextureDescriptor)\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, glTexture);\r\n    const internalFormat = gl.RGBA;\r\n    const border = 0;\r\n    const format = gl.RGBA;\r\n    const type = gl.UNSIGNED_BYTE;\r\n    const data = null;\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat,\r\n      texture.width, texture.height, border,\r\n      format, type, data);\r\n    \r\n    this.textures.set(texture, glTexture);\r\n\r\n    return glTexture;\r\n  }\r\n  \r\n  private createWebGLTexture(config: TextureDescriptor): WebGLTexture {\r\n    const gl = this.renderer.gl;\r\n    const texture = gl.createTexture();\r\n    if (texture === null) {\r\n      throw 'webgl texture create fail';\r\n    }\r\n    gl.bindTexture(gl.TEXTURE_2D, texture);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, config.minFilter);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, config.maxFilter);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, config.sWrap);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, config.tWrap);\r\n    return texture;\r\n  }\r\n\r\n  releaseGL() {\r\n    \r\n  }\r\n}\r\n","import { RenderEngine } from \"../engine/render-engine\";\r\nimport { GraphicResourceReleasable } from \"../type\";\r\n\r\nexport enum PixelFormat {\r\n  AlphaFormat = 1021,\r\n  RGBFormat = 1022,\r\n  RGBAFormat = 1023,\r\n}\r\n\r\nexport enum PixelDataType {\r\n  UNSIGNED_BYTE,\r\n  UNSIGNED_SHORT_5_6_5,\r\n  UNSIGNED_SHORT_4_4_4_4,\r\n  UNSIGNED_SHORT_5_5_5_1,\r\n  FLOAT,\r\n}\r\n\r\n/**\r\n * texture container for bitmap render data\r\n * \r\n * @export\r\n * @class Texture\r\n */\r\nexport abstract class Texture implements GraphicResourceReleasable {\r\n\r\n  private needUpdate: boolean = true;\r\n\r\n  format: PixelFormat = PixelFormat.RGBAFormat\r\n  dataType: PixelDataType = PixelDataType.UNSIGNED_BYTE\r\n\r\n  setNeedUpdate() {\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  getGLTexture(engine: RenderEngine): WebGLTexture {\r\n    const glTexture = engine.renderer.textureManger.getGLTexture(this)\r\n    if (glTexture === undefined) {\r\n      this.needUpdate = false;\r\n      return this.upload(engine);\r\n    }\r\n    if (this.needUpdate) {\r\n      this.needUpdate = false;\r\n      this.releaseGraphics(engine);\r\n      return this.upload(engine);\r\n    }\r\n  }\r\n\r\n  releaseGraphics(engine: RenderEngine) {\r\n    engine.renderer.textureManger.deleteGLTexture(this);\r\n  }\r\n\r\n  abstract upload(engine: RenderEngine): WebGLTexture;\r\n}\r\n\r\nexport class DataTexture extends Texture {\r\n  data?: Uint8ClampedArray;\r\n\r\n  upload(engine: RenderEngine): WebGLTexture {\r\n    // TODO\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n}\r\n\r\nexport class HTMLImageTexture extends Texture{\r\n  \r\n  image: HTMLImageElement;\r\n\r\n  upload(engine: RenderEngine) {\r\n    return engine.renderer.textureManger.createTextureFromImageElement(this);\r\n  }\r\n}","import { GLRenderer } from \"./gl-renderer\";\r\nimport { Nullable } from \"../type\";\r\nimport { PixelFormat } from \"./const\";\r\nimport { Texture } from \"../core/texture\";\r\nimport { RenderEngine } from \"../engine/render-engine\";\r\n\r\n\r\n\r\nexport class FramebufferAttachTexture extends Texture {\r\n  width: number = 5;\r\n  height: number = 5;\r\n\r\n  upload(engine: RenderEngine): WebGLTexture {\r\n    return engine.renderer.textureManger.createTextureForRenderTarget(this);\r\n  }\r\n\r\n  attach(engine: RenderEngine, framebuffer: GLFramebuffer, attachPoint: number) {\r\n    engine.renderer.setRenderTarget(framebuffer);\r\n\r\n    const gl = framebuffer.gl;\r\n    this.width = framebuffer.width;\r\n    this.height = framebuffer.height;\r\n    this.releaseGraphics(engine);\r\n    const glTexture = this.upload(engine);\r\n    const attachmentPoint = GLAttachmentPoints[attachPoint];\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, glTexture, 0);\r\n  }\r\n\r\n}\r\n\r\nconst GLAttachmentPoints = [];\r\nfunction loadGLAttachmentPoints(gl: WebGLRenderingContext) {\r\n  if (GLAttachmentPoints.length === 0) {\r\n    for (let i = 0; i < 32; i++) {\r\n      GLAttachmentPoints[i] = gl['COLOR_ATTACHMENT' + i];\r\n    }\r\n  }\r\n}\r\n\r\nexport type FramebufferReadBufferType = Uint8Array | Uint16Array | Float32Array;\r\n\r\nexport class GLFramebuffer {\r\n  constructor(renderer: GLRenderer, name: string, width: number, height: number) {\r\n    this.name = name;\r\n    this.renderer = renderer;\r\n    this.gl = renderer.gl;\r\n    loadGLAttachmentPoints(this.gl);\r\n    this.webglFrameBuffer = this.createGLFramebuffer();\r\n    this.width = width;\r\n    this.height = height;\r\n  }\r\n  name: string;\r\n  gl: WebGLRenderingContext;\r\n  renderer: GLRenderer;\r\n\r\n  width: number;\r\n  height: number;\r\n\r\n  enableDepth: boolean = true;\r\n  webglDepthBuffer: Nullable<WebGLRenderbuffer> = null;\r\n  webglFrameBuffer: WebGLFramebuffer;\r\n\r\n  textureAttachedSlot: FramebufferAttachTexture[] = [];\r\n\r\n  createGLFramebuffer() {\r\n    const buffer = this.gl.createFramebuffer();\r\n    if (buffer === null) {\r\n      throw 'webgl framebuffer create failed'\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  createGLRenderbuffer() {\r\n    const buffer = this.gl.createRenderbuffer();\r\n    if (buffer === null) {\r\n      throw 'webgl renderbuffer create failed'\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  resize(engine: RenderEngine, width: number, height: number) {\r\n\r\n    if (this.width === width && this.height === height) {\r\n      return;\r\n    }\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    this.gl.deleteFramebuffer(this.webglFrameBuffer);\r\n    this.webglFrameBuffer = this.createGLFramebuffer();\r\n\r\n    this.renderer.setRenderTarget(this);\r\n\r\n    this.textureAttachedSlot.forEach((text, index) => {\r\n      if (text) {\r\n        text.attach(engine, this, index);\r\n      }\r\n    })\r\n\r\n    this.disposeAttachedDepthBuffer();\r\n    this.createAttachDepthBuffer();\r\n\r\n  }\r\n\r\n  createAttachTexture(engine: RenderEngine,attachPoint: number) {\r\n    if (this.textureAttachedSlot[attachPoint] !== undefined) {\r\n      throw 'framebuffer has attached texture'\r\n    }\r\n    const attachTexture = new FramebufferAttachTexture();\r\n    attachTexture.attach(engine, this, attachPoint);\r\n    this.textureAttachedSlot[attachPoint] = attachTexture;\r\n\r\n  }\r\n\r\n  createAttachDepthBuffer() {\r\n    this.renderer.setRenderTarget(this);\r\n\r\n    if (this.webglDepthBuffer !== null) {\r\n      return\r\n    }\r\n    const gl = this.gl;\r\n    const depthBuffer = this.createGLRenderbuffer();\r\n    this.webglDepthBuffer = depthBuffer;\r\n\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, depthBuffer);\r\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, this.width, this.height);\r\n\r\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, depthBuffer);\r\n  }\r\n\r\n  disposeAttachedDepthBuffer() {\r\n    this.gl.deleteRenderbuffer(this.webglDepthBuffer);\r\n    this.webglDepthBuffer = null;\r\n  }\r\n\r\n  attachTexture(texture: FramebufferAttachTexture, attachPoint: number) {\r\n    // TODO\r\n  }\r\n\r\n  // read pixel info from this framebuffer\r\n  // https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/readPixels\r\n  readPixels(x: number, y: number, width: number, height: number, readBuffer: FramebufferReadBufferType) {\r\n    // TODO\r\n    const gl = this.gl;\r\n    this.renderer.setRenderTarget(this);\r\n    if (x < 0 || y < 0 || x > (this.width - width) || y > (this.height - height)) {\r\n      throw \"read area exceed frameSize\"\r\n    }\r\n    if (readBuffer.length < width * height) {\r\n      throw \"readBuffer size not sufficient\"\r\n    }\r\n    gl.readPixels(x, y, width, height, PixelFormat.RGBA, gl.UNSIGNED_BYTE, readBuffer); \r\n  }\r\n\r\n  dispose() {\r\n    this.textureAttachedSlot = [];\r\n    this.disposeAttachedDepthBuffer();\r\n    this.gl.deleteFramebuffer(this.webglFrameBuffer);\r\n    this.webglFrameBuffer = null;\r\n  }\r\n}","import { GLFramebuffer } from \"./gl-framebuffer\";\r\nimport { GLRenderer } from \"./gl-renderer\";\r\nimport { GLReleasable } from '../type';\r\nimport { RenderEngine } from \"../engine/render-engine\";\r\n\r\nexport class GLFrameBufferManager implements GLReleasable{\r\n  constructor(renderer: GLRenderer) {\r\n    this.renderer = renderer;\r\n    this.gl = renderer.gl;\r\n  }\r\n  readonly gl: WebGLRenderingContext;\r\n  readonly renderer: GLRenderer;\r\n\r\n  private framebuffers: Map<string, GLFramebuffer> = new Map();\r\n\r\n  createFrameBuffer(engine: RenderEngine, name: string, width: number, height: number, enableDepth: boolean): GLFramebuffer{\r\n    if (this.framebuffers.has(name)) {\r\n      throw 'duplicate framebuffer key name';\r\n    }\r\n\r\n    const framebuffer = new GLFramebuffer(this.renderer, name, width, height);\r\n    framebuffer.createAttachTexture(engine, 0);\r\n    framebuffer.enableDepth = enableDepth;\r\n    if (enableDepth) {\r\n      framebuffer.createAttachDepthBuffer();\r\n    }\r\n\r\n    this.framebuffers.set(name, framebuffer);\r\n\r\n    return framebuffer;\r\n  }\r\n\r\n  getFramebuffer(framebufferName: string) {\r\n    return this.framebuffers.get(framebufferName);\r\n  }\r\n\r\n  getFramebufferTexture(framebufferName: string): WebGLTexture{\r\n    const framebuffer = this.framebuffers.get(framebufferName);\r\n    if (framebuffer === undefined) {\r\n      throw `cant find framebuffer ${framebufferName}`\r\n    }\r\n    return this.renderer.textureManger.getGLTexture(framebuffer.textureAttachedSlot[0]);\r\n  }\r\n\r\n  releaseGL() {\r\n    \r\n  }\r\n}","export class GLStat{\r\n  drawcall: number = 0;\r\n  programSwitch: number = 0;\r\n  uniformUpload: number = 0;\r\n  framebufferSwitch: number = 0;\r\n\r\n  faceDraw: number = 0;\r\n  vertexDraw: number = 0;\r\n\r\n  reset() {\r\n    this.drawcall = 0;\r\n    this.programSwitch = 0;\r\n    this.uniformUpload = 0;\r\n    this.framebufferSwitch = 0;\r\n    this.faceDraw = 0;\r\n    this.vertexDraw = 0;\r\n  }\r\n}","import { GLRenderer } from \"./gl-renderer\";\r\nimport { GLExtList } from \"./gl-info\";\r\nimport { GLReleasable } from \"../type\";\r\nimport { Geometry } from \"../core/geometry\";\r\n\r\nexport interface VAOCreateCallback{\r\n  vao: any,\r\n  unbind: () => void\r\n}\r\n\r\nexport class GLVAOManager implements GLReleasable{\r\n  readonly gl: WebGLRenderingContext;\r\n  readonly renderer: GLRenderer;\r\n  readonly vaoExt: any;\r\n  readonly isSupported: boolean;\r\n  private vaos: WeakMap<Geometry, any> = new WeakMap();\r\n\r\n  constructor(renderer: GLRenderer) {\r\n    this.renderer = renderer;\r\n    this.gl = renderer.gl;\r\n    this.vaoExt = renderer.glInfo.getExtension(GLExtList.OES_vertex_array_object);\r\n    this.isSupported = this.vaoExt !== undefined;\r\n  }\r\n\r\n  getVAO(geometry: Geometry) {\r\n    return this.vaos.get(geometry);\r\n  }\r\n\r\n  createVAO(geometry: Geometry): VAOCreateCallback {\r\n    const vao = this.vaoExt.createVertexArrayOES(); \r\n    this.vaoExt.bindVertexArrayOES(vao);\r\n    this.vaos.set(geometry, vao);\r\n    return {\r\n      vao, unbind: () => {\r\n        this.vaoExt.bindVertexArrayOES(null);\r\n      }\r\n    };\r\n  }\r\n\r\n  deleteVAO(geometry: Geometry) {\r\n    this.vaos.delete(geometry);\r\n  }\r\n\r\n  useVAO(vao: any) {\r\n    this.vaoExt.bindVertexArrayOES(vao);\r\n  }\r\n\r\n  releaseGL(): void {\r\n    this.vaoExt.bindVertexArrayOES(null);\r\n    this.vaos = new WeakMap();\r\n  }\r\n}","import { GLInfo, GLExtList } from \"./gl-info\";\r\nimport { GLProgram, GLProgramConfig } from \"./program\";\r\nimport { GLProgramManager } from \"./program-manager\";\r\nimport { GLAttributeBufferDataManager } from \"./attribute-buffer-manager\";\r\nimport { GLState } from \"./states/gl-state\";\r\nimport { DrawMode } from \"./const\";\r\nimport { Nullable, GLReleasable } from \"../type\";\r\nimport { GLTextureManager } from \"./texture-manager\";\r\nimport { GLFrameBufferManager } from \"./framebuffer-manager\";\r\nimport { GLFramebuffer } from \"./gl-framebuffer\";\r\nimport { GLStat } from \"./gl-stat\";\r\nimport { GLVAOManager } from \"./vao\";\r\n\r\nexport class GLRenderer implements GLReleasable {\r\n  constructor(el?: HTMLCanvasElement, options?: any) {\r\n    if (el === undefined) {\r\n      el = document.createElement('canvas');\r\n    }\r\n    options = { ...options };\r\n    options.antialias = false;\r\n    // options.preserveDrawingBuffer = true; // for screen shot\r\n    const ctx = el.getContext('webgl', options);\r\n    if (ctx === null) {\r\n      throw 'webgl context create failed';\r\n    }\r\n    this.gl = ctx;\r\n    this.el = el;\r\n    this.glInfo = new GLInfo(ctx);\r\n    this.framebufferManager = new GLFrameBufferManager(this);\r\n    this.vaoManager = new GLVAOManager(this);\r\n    this.state = new GLState(this);\r\n    this.textureManger.init();\r\n\r\n    const ext = this.glInfo.getExtension(GLExtList.ANGLE_instanced_arrays);\r\n    if (ext !== undefined) {\r\n      this.angleInstanceExt = ext;\r\n    }\r\n\r\n    this.setSize(this.el.offsetWidth, this.el.offsetHeight);\r\n  }\r\n  readonly gl: WebGLRenderingContext;\r\n  readonly el: HTMLCanvasElement;\r\n\r\n  readonly glInfo: GLInfo;\r\n  private angleInstanceExt: Nullable<ANGLE_instanced_arrays> = null;\r\n\r\n  // enable this will cause great performance issue\r\n  // only enable this when debug draw range issue\r\n  enableRenderErrorCatch: boolean = false;\r\n  enableUniformDiff: boolean = true;\r\n\r\n  // width height is render size, not element size\r\n  private _width = 100;\r\n  get width() { return this._width };\r\n  private _height = 100;\r\n  get height() { return this._height };\r\n\r\n  private devicePixelRatio = window.devicePixelRatio;\r\n\r\n  // set render size by device logic size\r\n  setSize(width: number, height: number): boolean {\r\n    return this.setRawRenderSize(width * this.devicePixelRatio, height * this.devicePixelRatio);\r\n  }\r\n  setRawRenderSize(width: number, height: number): boolean {\r\n    let isChanged = this._width !== width || this._height !== height;\r\n    this._width = width;\r\n    this._height = height;\r\n    this.el.width = this._width;\r\n    this.el.height = this._height;\r\n    this.state.setViewport(0, 0, width, height);\r\n    return isChanged;\r\n  }\r\n\r\n  readonly state: GLState;\r\n  readonly stat: GLStat = new GLStat();\r\n  private activeProgram: Nullable<GLProgram> = null;\r\n  _programChangeId: number = 0;\r\n\r\n  // resource managers\r\n  readonly programManager = new GLProgramManager();\r\n  readonly textureManger = new GLTextureManager(this);\r\n  readonly attributeBufferManager = new GLAttributeBufferDataManager(this);\r\n  readonly vaoManager: GLVAOManager;\r\n  readonly framebufferManager: GLFrameBufferManager;\r\n\r\n  createProgram(conf: GLProgramConfig): GLProgram {\r\n    const program = new GLProgram(this, conf);\r\n    this.programManager.addNewProgram(program);\r\n    return program;\r\n  }\r\n\r\n  getProgram(storeId: string): GLProgram {\r\n    return this.programManager.getProgram(storeId);\r\n  }\r\n\r\n  useProgram(program: GLProgram) {\r\n    if (this.activeProgram !== program) {\r\n      this.stat.programSwitch++;\r\n      this.activeProgram = program;\r\n      this._programChangeId++;\r\n      this.gl.useProgram(program.getProgram());\r\n    }\r\n  }\r\n\r\n  draw(mode: DrawMode) {\r\n    const program = this.activeProgram;\r\n    if (program === null) {\r\n      throw 'renderer hasn\\'t active program'\r\n    }\r\n\r\n    if (!program.useInstance) {\r\n      if (program.useIndexDraw) {\r\n        this.gl.drawElements(\r\n          mode,\r\n          program.drawCount,\r\n          program._indexUINT ? this.gl.UNSIGNED_INT : this.gl.UNSIGNED_SHORT,\r\n          program.drawFrom\r\n        );\r\n      } else {\r\n        this.gl.drawArrays(mode, program.drawFrom, program.drawCount);\r\n      }\r\n    } else {\r\n      if (this.angleInstanceExt === null) {\r\n        throw 'instance not support'\r\n      }\r\n      if (program.useIndexDraw) {\r\n        // https://developer.mozilla.org/en-US/docs/Web/API/ANGLE_instanced_arrays/drawElementsInstancedANGLE\r\n        this.angleInstanceExt.drawElementsInstancedANGLE(\r\n          mode,\r\n          program.drawCount,\r\n          program._indexUINT ? this.gl.UNSIGNED_INT : this.gl.UNSIGNED_SHORT,\r\n          program.drawFrom,\r\n          program.instanceCount);\r\n      } else {\r\n        // https://developer.mozilla.org/en-US/docs/Web/API/ANGLE_instanced_arrays/drawArraysInstancedANGLE\r\n        this.angleInstanceExt.drawArraysInstancedANGLE(\r\n          mode,\r\n          program.drawFrom,\r\n          program.drawCount,\r\n          program.instanceCount);\r\n      }\r\n    }\r\n\r\n    if (this.enableRenderErrorCatch) {\r\n      this.checkGLError();\r\n    }\r\n\r\n    this.state.textureSlot.resetSlotIndex();\r\n\r\n    // update draw stat // TODO support other draw type\r\n    this.stat.drawcall++;\r\n    if (mode === DrawMode.TRIANGLES) {\r\n      this.stat.faceDraw += (program.drawCount / 3 * program.instanceCount)\r\n      this.stat.vertexDraw += (program.drawCount * program.instanceCount)\r\n    }\r\n  }\r\n\r\n  checkGLError() {\r\n    const errorCode = this.gl.getError();\r\n    if (errorCode !== this.gl.NO_ERROR) {\r\n      // debugger\r\n      throw `gl draw error: ${errorCode}`;\r\n    }\r\n  }\r\n\r\n  currentFramebuffer: Nullable<GLFramebuffer> = null;\r\n  setRenderTarget(framebuffer: Nullable<GLFramebuffer>) {\r\n    if (this.currentFramebuffer !== framebuffer) {\r\n      this.stat.framebufferSwitch++;\r\n      this.currentFramebuffer = framebuffer;\r\n      const gl = this.gl;\r\n      if (framebuffer === null) {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n      } else {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer.webglFrameBuffer);\r\n      }\r\n    }\r\n  }\r\n\r\n  setRenderTargetScreen() {\r\n    this.setRenderTarget(null);\r\n  }\r\n\r\n  releaseGL() {\r\n    this.attributeBufferManager.releaseGL();\r\n    this.programManager.releaseGL();\r\n    this.textureManger.releaseGL();\r\n    this.framebufferManager.releaseGL();\r\n    this.vaoManager.releaseGL();\r\n  }\r\n\r\n}\r\n","import { Vector3 } from \"../vector3\";\r\n\r\nexport class Vector3Observable extends Vector3{\r\n  constructor(x?: number, y?: number, z?: number) {\r\n    super();\r\n    this._x = x || 0;\r\n    this._y = y || 0;\r\n    this._z = z || 0;\r\n  }\r\n\r\n  onChange = () => { };\r\n\r\n  _x: number;\r\n  _y: number;\r\n  _z: number;\r\n\r\n  get x() {\r\n    return this._x;\r\n  }\r\n  set x(val) {\r\n    if (this.onChange) {\r\n      this.onChange();\r\n    }\r\n    \r\n    this._x = val;\r\n  }\r\n\r\n  get y() {\r\n    return this._y;\r\n  }\r\n  set y(val) {\r\n    if (this.onChange) {\r\n      this.onChange();\r\n    }\r\n    this._y = val;\r\n  }\r\n\r\n  get z() {\r\n    return this._z;\r\n  }\r\n  set z(val) {\r\n    if (this.onChange) {\r\n      this.onChange();\r\n    }\r\n    this._z = val;\r\n  }\r\n\r\n}\r\n","import { Matrix4, Euler, Quaternion, Vector3 } from \"../math/index\";\r\nimport { Vector3Observable } from \"../math/observable/vector3-observable\";\r\n\r\nconst tempVector3 = new Vector3();\r\nconst tempMatrix = new Matrix4();\r\n\r\n/**\r\n * Describe a node's local transformation info.\r\n * Users can set values and, from getter to get cleaned value\r\n * not need to update manually. All calculation is lazy.\r\n * @export\r\n * @class Transformation\r\n */\r\nexport class Transformation{\r\n  constructor() {\r\n    this._position.onChange = () => {\r\n      this.matrixIsDirty = true;\r\n      this.transformFrameChanged = true;\r\n    }\r\n\r\n    this._scale.onChange = () => {\r\n      this.matrixIsDirty = true;\r\n      this.transformFrameChanged = true;\r\n    }\r\n\r\n    this._rotation.onChangeCallback = () => {\r\n      this.matrixIsDirty = true;\r\n      this.transformFrameChanged = true;\r\n      this._quaternion.setFromEuler(this._rotation, false);\r\n    }\r\n\r\n    this._quaternion.onChangeCallback = () => {\r\n      this.matrixIsDirty = true;\r\n      this.transformFrameChanged = true;\r\n      this._rotation.setFromQuaternion(this._quaternion, this._rotation.order, false);\r\n    }\r\n  }\r\n\r\n  transformFrameChanged = true;\r\n\r\n  private _matrix: Matrix4 = new Matrix4();\r\n  private matrixIsDirty = true;\r\n\r\n  private _position: Vector3Observable = new Vector3Observable();\r\n  private positionIsDirty = false;\r\n\r\n  private _scale: Vector3Observable = new Vector3Observable(1, 1, 1);\r\n  private scaleIsDirty = false;\r\n\r\n  private _rotation: Euler = new Euler();\r\n  private eulerIsDirty = false;\r\n\r\n  private _quaternion: Quaternion = new Quaternion();\r\n  private quaternionIsDirty = false;\r\n\r\n  public notifyMatrixChange() {\r\n    this.matrixIsDirty = false;\r\n    this.positionIsDirty = true;\r\n    this.scaleIsDirty = true;\r\n    this.eulerIsDirty = true;\r\n    this.quaternionIsDirty = true;\r\n  }\r\n\r\n  get matrix(): Matrix4 {\r\n    if (this.matrixIsDirty) {\r\n      this._matrix.compose(this._position, this._quaternion, this._scale);\r\n    }\r\n    return this._matrix;\r\n  }\r\n\r\n  get position(): Vector3 {\r\n    if (this.positionIsDirty) {\r\n      this._position._x = this._matrix.elements[12];\r\n      this._position._y = this._matrix.elements[13];\r\n      this._position._z = this._matrix.elements[14];\r\n      this.positionIsDirty = false;\r\n    }\r\n    return this._position;\r\n  }\r\n\r\n  get scale(): Vector3 {\r\n    if (this.scaleIsDirty) {\r\n      tempVector3.set(this._matrix.elements[0], this._matrix.elements[1], this._matrix.elements[2])\r\n      this._scale._x = tempVector3.length();\r\n      tempVector3.set(this._matrix.elements[4], this._matrix.elements[5], this._matrix.elements[6])\r\n      this._scale._x = tempVector3.length();\r\n      tempVector3.set(this._matrix.elements[8], this._matrix.elements[9], this._matrix.elements[10])\r\n      this._scale._x = tempVector3.length();\r\n      this.scaleIsDirty = false;\r\n    }\r\n    return this._scale;\r\n  }\r\n\r\n  get rotation(): Euler {\r\n    if (this.eulerIsDirty) {\r\n      this._rotation.setFromQuaternion(this.quaternion, Euler.defaultOrder, false);\r\n      this.eulerIsDirty = false;\r\n    }\r\n    return this._rotation;\r\n  }\r\n\r\n  get quaternion(): Quaternion {\r\n    if (this.quaternionIsDirty) {\r\n      tempMatrix.copy(this._matrix);\r\n      tempMatrix.scale(1 / this.scale.x, 1 / this.scale.y, 1 / this.scale.z);\r\n      this._quaternion.setFromRotationMatrix(tempMatrix);\r\n      this.quaternionIsDirty = false;\r\n    }\r\n    return this._quaternion;\r\n  }\r\n\r\n\r\n}","import { Matrix4, generateUUID } from \"../math/index\";\r\nimport { Scene } from \"./scene\";\r\nimport { Nullable } from \"../type\";\r\nimport { Transformation } from \"./transformation\";\r\n\r\ninterface TreeNode{\r\n  children: TreeNode[];\r\n}\r\n\r\n/**\r\n * SceneNode is a node in a scene tree that\r\n * organize the scene hierarchy\r\n *\r\n * @export\r\n * @class SceneNode\r\n */\r\nexport class SceneNode {\r\n  uuid = generateUUID();\r\n  scene: Nullable<Scene> = null;\r\n  sceneNodeListIndex: number = -1;\r\n\r\n  parent: Nullable<SceneNode> = null;\r\n  children: SceneNode[] = [];\r\n\r\n  readonly transform: Transformation = new Transformation();\r\n  _worldMatrix = new Matrix4();\r\n  _worldMatrixUpdateFrameId: number = 0;\r\n  get worldMatrix() {\r\n    return this._worldMatrix;\r\n  }\r\n\r\n  _visible: boolean = true;\r\n  _visibleNet: Boolean = true;\r\n  _visibleUpdateFrameId: number = 0;\r\n  set visible(value: boolean) {\r\n    this._visible = value;\r\n    if (this.scene !== null) {\r\n      this.scene.isFrameVisibleChange = true;\r\n    }\r\n  };\r\n  get visible() {\r\n    return this._visible;\r\n  }\r\n\r\n  addChild(node: SceneNode): SceneNode {\r\n    if (node === this) {\r\n      throw 'Cant add a scene node to it self';\r\n    }\r\n\r\n    if (this.scene !== null) {\r\n      this.scene.isFrameStructureChange = true;\r\n      this.scene.addNode(node);\r\n    }\r\n\r\n    if (node.parent !== null) {\r\n      node.parent.removeChild(node);\r\n    }\r\n    node.parent = this;\r\n    this.children.push(node);\r\n    return this;\r\n  }\r\n\r\n  removeChild(node: SceneNode): SceneNode {\r\n    if (this.scene !== null) {\r\n      this.scene.isFrameStructureChange = true;\r\n      this.scene.removeNode(node);\r\n    }\r\n\r\n    let index = this.children.indexOf(node);\r\n    if (index !== - 1) {\r\n      node.parent = null;\r\n      this.children.splice(index, 1);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  traverse(fn: (sceneNode: SceneNode) => any): SceneNode  {\r\n    function visit(node: SceneNode) {\r\n      if (fn(node) !== false) {\r\n        for (let i = 0; i < node.children.length; i++) {\r\n          visit(node.children[i]);\r\n        }\r\n      }\r\n    }\r\n    visit(this);\r\n    return this;\r\n  }\r\n\r\n  traversePair(fn: (sceneNodeParent: Nullable<SceneNode>, sceneNode: SceneNode) => any): any {\r\n    function visit(nodeParent: Nullable<SceneNode>, node: SceneNode) {\r\n      const result = fn(nodeParent, node);\r\n      for (let i = 0; i < node.children.length; i++) {\r\n        visit(node, node.children[i]);\r\n      }\r\n      return result;\r\n    }\r\n    return visit(this.parent, this);\r\n  }\r\n\r\n  map(fn: (sceneNode: SceneNode) => TreeNode) {\r\n    const nodes: Map<SceneNode, TreeNode> = new Map();\r\n    const rootNode = this.traversePair((nodeParent: Nullable<SceneNode>, node: SceneNode) => {\r\n      const mapNode = fn(node);\r\n      nodes.set(node, mapNode);\r\n      if (nodeParent !== null && nodes.has(nodeParent)) {\r\n        const mapParentNode = nodes.get(nodeParent);\r\n        if (mapParentNode === undefined) {\r\n          throw 'tree map error: cant find mapped parent'\r\n        }\r\n        mapParentNode.children.push(mapNode);\r\n      }\r\n      return mapNode;\r\n    })\r\n    return rootNode;\r\n  }\r\n\r\n  findSubNode(id: string): Nullable<SceneNode> {\r\n    let result: Nullable<SceneNode> = null;\r\n    this.traverse(node => {\r\n      if (node.uuid === id) {\r\n        result = node;\r\n        return false;\r\n      }\r\n    })\r\n    return result;\r\n  }\r\n\r\n  updateWorldMatrix(force?: boolean): SceneNode  {\r\n    if (this.transform.transformFrameChanged || force) {\r\n\r\n      if (this.parent === null) {\r\n        this.worldMatrix.copy(this.transform.matrix);\r\n      } else {\r\n        this.worldMatrix.multiplyMatrices(this.parent.worldMatrix, this.transform.matrix);\r\n      }\r\n      this.transform.transformFrameChanged = false;\r\n      force = true;\r\n    }\r\n    var children = this.children;\r\n    for (var i = 0, l = children.length; i < l; i++) {\r\n      children[i].updateWorldMatrix(force);\r\n    }\r\n    return this;\r\n  }\r\n\r\n\r\n}","import { SceneNode } from \"../scene/scene-node\";\r\nimport { Matrix4 } from \"../math/index\";\r\nimport { RenderEngine, Size } from '../engine/render-engine';\r\nimport { Observer } from './observable';\r\nimport { Nullable } from '../type';\r\n\r\n/**\r\n * Camera is abstraction of a params set to a projection matrix.\r\n * extender can support more useful interface\r\n * to make the projection relation more easy to \r\n * understand and modified;\r\n * \r\n * @export\r\n * @class Camera\r\n * @extends {SceneNode}\r\n */\r\nexport class Camera extends SceneNode {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  projectionMatrix = new Matrix4();\r\n  projectionMatrixNeedUpdate = false;\r\n  updateProjectionMatrix() { };\r\n  onRenderResize(newSize: Size) {\r\n    \r\n  }\r\n\r\n  private renderSizeObserver: Nullable<Observer<Size>> = null;\r\n  bindEngineRenderSize(engine: RenderEngine) {\r\n    if (this.renderSizeObserver !== null) {\r\n      engine.resizeObservable.remove(this.renderSizeObserver);\r\n    }\r\n    this.renderSizeObserver = engine.resizeObservable.add(this.onRenderResize);\r\n  }\r\n  \r\n\r\n}","import { Vector3, Matrix4, MathUtil } from \"../math/index\";\r\nimport { Camera } from \"../core/camera\";\r\nimport { ScreenSpaceRayProvider, Raycaster } from \"../core/raycaster\";\r\n\r\nconst tempMatrix = new Matrix4();\r\n\r\nexport class PerspectiveCamera extends Camera implements ScreenSpaceRayProvider {\r\n  constructor(near?: number, far?: number,\r\n    fov?: number, aspect?: number, zoom?: number) {\r\n    super();\r\n    this._fov = fov !== undefined ? fov : 50;\r\n    this._zoom = 1;\r\n\r\n    this._near = near !== undefined ? near : 0.1;\r\n    this._far = far !== undefined ? far : 2000;\r\n\r\n    this._aspect = aspect !== undefined ? aspect : 1;\r\n\r\n    this.updateProjectionMatrix();\r\n  }\r\n\r\n  _near: number;\r\n  get near() { return this._near };\r\n  set near(value) { this._near = value; this.projectionMatrixNeedUpdate = true };\r\n  _far: number;\r\n  get far() { return this._far };\r\n  set far(value) { this._far = value; this.projectionMatrixNeedUpdate = true };\r\n\r\n  _fov: number;\r\n  get fov() { return this._fov };\r\n  set fov(value) { this._fov = value; this.projectionMatrixNeedUpdate = true };\r\n  _aspect: number;\r\n  get aspect() { return this._aspect };\r\n  set aspect(value) { this._aspect = value; this.projectionMatrixNeedUpdate = true };\r\n  _zoom: number;\r\n  get zoom() { return this._zoom };\r\n  set zoom(value) { this._zoom = value; this.projectionMatrixNeedUpdate = true };\r\n\r\n  up = new Vector3(0, 1, 0);\r\n\r\n  get width() {\r\n    return this._aspect * this.height;\r\n  }\r\n  get height() {\r\n    return 2 * this._near * Math.tan(MathUtil.DEG2RAD * 0.5 * this._fov) / this._zoom;\r\n  }\r\n\r\n  updateProjectionMatrix() {\r\n    const top = this._near * Math.tan(MathUtil.DEG2RAD * 0.5 * this._fov) / this._zoom;\r\n    const height = 2 * top;\r\n    const width = this._aspect * height;\r\n    const left = - 0.5 * width;\r\n    this.projectionMatrix.makePerspective(left, left + width, top, top - height, this._near, this._far);\r\n    this.projectionMatrixNeedUpdate = false;\r\n  }\r\n\r\n  lookAt(targetPosition: Vector3) {\r\n    tempMatrix.lookAt(this.transform.position, targetPosition, this.up);\r\n    this.transform.quaternion.setFromRotationMatrix(tempMatrix);\r\n  }\r\n\r\n  updateRaycaster(caster: Raycaster, xRate: number, yRate: number): void {\r\n    caster.worldRay.origin.setFromMatrixPosition(this.worldMatrix);\r\n    caster.worldRay.direction.set(xRate, yRate, 0.5)\r\n      .unProject(this.worldMatrix, this.projectionMatrix)\r\n      .sub(caster.worldRay.origin)\r\n      .normalize();\r\n  }\r\n\r\n}","\r\n/**\r\n * wrap class for uniform change cache and need update optimize\r\n *\r\n * @export\r\n * @class UniformProxy\r\n */\r\nexport class UniformProxy{\r\n  constructor(value:any) {\r\n    this._value = value;\r\n  }\r\n\r\n  _value: any;\r\n  _needUpdate: boolean = true;\r\n\r\n  setValue(val: any) {\r\n    this._value = val;\r\n    this._needUpdate = true;\r\n  }\r\n\r\n  setValueNeedUpdate() {\r\n    this._needUpdate = true;\r\n  }\r\n\r\n  get value() {\r\n    return this._value;\r\n  }\r\n\r\n  resetUpdate() {\r\n    this._needUpdate = false;\r\n  }\r\n}","\r\nimport { Nullable } from \"../type\";\r\n\r\n//https://github.com/BabylonJS/Babylon.js/blob/master/src/Misc/observable.ts\r\n\r\n/**\r\n * Represent an Observer registered to a given Observable object.\r\n */\r\nexport class Observer<T> {\r\n  /** @hidden */\r\n  public _willBeUnregistered = false;\r\n  /**\r\n   * Gets or sets a property defining that the observer as to be unregistered after the next notification\r\n   */\r\n  public unregisterOnNextCall = false;\r\n\r\n  /**\r\n   * Creates a new observer\r\n   * @param callback defines the callback to call when the observer is notified\r\n   */\r\n  constructor(\r\n    /**\r\n     * Defines the callback to call when the observer is notified\r\n     */\r\n    public callback: (eventData: T) => void\r\n  ) {\r\n  }\r\n}\r\n\r\n\r\n\r\nexport class Observable<T> {\r\n  private _observers = new Array<Observer<T>>();\r\n\r\n  private _onObserverAdded: Nullable<(observer: Observer<T>) => void>;\r\n\r\n  /**\r\n   * Creates a new observable\r\n   * @param onObserverAdded defines a callback to call when a new observer is added\r\n   */\r\n  constructor(onObserverAdded?: (observer: Observer<T>) => void) {\r\n    if (onObserverAdded) {\r\n      this._onObserverAdded = onObserverAdded;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a new Observer with the specified callback\r\n   * @param callback the callback that will be executed for that Observer\r\n   * @param unregisterOnFirstCall defines if the observer as to be unregistered after the next notification\r\n   * @returns the new observer created for the callback\r\n   */\r\n  public add(callback: (eventData: T) => void,  unregisterOnFirstCall = false): Nullable<Observer<T>> {\r\n    if (!callback) {\r\n      return null;\r\n    }\r\n\r\n    var observer = new Observer(callback);\r\n    observer.unregisterOnNextCall = unregisterOnFirstCall;\r\n\r\n    this._observers.push(observer);\r\n\r\n    if (this._onObserverAdded) {\r\n      this._onObserverAdded(observer);\r\n    }\r\n\r\n    return observer;\r\n  }\r\n\r\n  /**\r\n   * Create a new Observer with the specified callback and unregister after the next notification\r\n   * @param callback the callback that will be executed for that Observer\r\n   * @returns the new observer created for the callback\r\n   */\r\n  public addOnce(callback: (eventData: T) => void): Nullable<Observer<T>> {\r\n    return this.add(callback, true);\r\n  }\r\n\r\n  /**\r\n   * Remove an Observer from the Observable object\r\n   * @param observer the instance of the Observer to remove\r\n   * @returns false if it doesn't belong to this Observable\r\n   */\r\n  public remove(observer: Nullable<Observer<T>>): boolean {\r\n    if (!observer) {\r\n      return false;\r\n    }\r\n\r\n    var index = this._observers.indexOf(observer);\r\n\r\n    if (index !== -1) {\r\n      this._deferUnregister(observer);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private _deferUnregister(observer: Observer<T>): void {\r\n    observer.unregisterOnNextCall = false;\r\n    observer._willBeUnregistered = true;\r\n    setTimeout(() => {\r\n      this._remove(observer);\r\n    }, 0);\r\n  }\r\n\r\n  // This should only be called when not iterating over _observers to avoid callback skipping.\r\n  // Removes an observer from the _observer Array.\r\n  private _remove(observer: Nullable<Observer<T>>): boolean {\r\n    if (!observer) {\r\n      return false;\r\n    }\r\n\r\n    var index = this._observers.indexOf(observer);\r\n\r\n    if (index !== -1) {\r\n      this._observers.splice(index, 1);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  public notifyObservers(eventData: T): boolean {\r\n    if (this._observers.length === 0) {\r\n      return true;\r\n    }\r\n    for (var obs of this._observers) {\r\n      if (obs._willBeUnregistered) {\r\n        continue;\r\n      }\r\n\r\n      obs.callback(eventData);\r\n\r\n      if (obs.unregisterOnNextCall) {\r\n        this._deferUnregister(obs);\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  public notifyObserver(observer: Observer<T>, eventData: T): void {\r\n    observer.callback(eventData);\r\n  }\r\n\r\n  public hasObservers(): boolean {\r\n    return this._observers.length > 0;\r\n  }\r\n\r\n  public clear(): void {\r\n    this._observers = new Array<Observer<T>>();\r\n    this._onObserverAdded = null;\r\n  }\r\n\r\n  public clone(): Observable<T> {\r\n    var result = new Observable<T>();\r\n\r\n    result._observers = this._observers.slice(0);\r\n\r\n    return result;\r\n  }\r\n\r\n}","import {\r\n  DepthFunction, BlendingMode, CullSide,\r\n  BlendEquation, SrcAlphaFactor, OneMinusSrcAlphaFactor\r\n} from \"../webgl/const\";\r\nimport { GLRenderer } from \"../webgl/gl-renderer\";\r\n\r\n\r\nexport class DrawState {\r\n  cullSide = CullSide.CullFaceBack;\r\n\r\n  blending = BlendingMode.NormalBlending;\r\n  blendSrc = SrcAlphaFactor;\r\n  blendDst = OneMinusSrcAlphaFactor;\r\n  blendEquation = BlendEquation.FUNC_ADD;\r\n  blendSrcAlpha = null;\r\n  blendDstAlpha = null;\r\n  blendEquationAlpha = null;\r\n\r\n  depthFunc = DepthFunction.LessEqualDepth;\r\n  depthTest = true;\r\n  depthWrite = true;\r\n\r\n  colorWriteR = true;\r\n  colorWriteG = true;\r\n  colorWriteB = true;\r\n  colorWriteA = true;\r\n\r\n  polygonOffset = false;\r\n  polygonOffsetFactor = 0;\r\n  polygonOffsetUnits = 0;\r\n\r\n  alphaTest = 0;\r\n  premultipliedAlpha = false;\r\n\r\n  syncGL(renderer: GLRenderer) {\r\n    renderer.state.setCullFace(this.cullSide);\r\n\r\n    const depthBuffer = renderer.state.depthbuffer;\r\n    depthBuffer.enableTest = this.depthTest\r\n    depthBuffer.setFunc(this.depthFunc)\r\n    depthBuffer.setMask(this.depthWrite)\r\n\r\n    const colorBuffer = renderer.state.colorbuffer;\r\n    colorBuffer.setColorMask(\r\n      this.colorWriteR, this.colorWriteG,\r\n      this.colorWriteB, this.colorWriteA,\r\n    );\r\n\r\n    renderer.state.setPolygonOffset(\r\n      this.polygonOffset,\r\n      this.polygonOffsetFactor,\r\n      this.polygonOffsetUnits\r\n    )\r\n\r\n    // TODO blending staff\r\n  }\r\n}","import { Geometry } from \"./geometry\";\r\nimport { SceneNode } from \"../scene/scene-node\";\r\nimport { Material } from \"./material\";\r\nimport { DrawMode } from \"../webgl/const\";\r\nimport { DrawState } from \"./draw-state\";\r\nimport { Face3 } from \"../math/entity/face3\";\r\nimport { Line3 } from \"../math/entity/line3\";\r\nimport { Vector3 } from \"../math\";\r\nimport { Shading } from \"./shading\";\r\nimport { StandardGeometry } from \"../geometry/standard-geometry\";\r\n\r\nexport class RenderRange {\r\n  static fromStandardGeometry(geometry: StandardGeometry) {\r\n    return new RenderRange(0, geometry.indexBuffer.count);\r\n  }\r\n\r\n  constructor(start?: number, count?: number) {\r\n    if (start !== undefined) {\r\n      this.start = start;\r\n    }\r\n    if (count !== undefined) {\r\n      this.count = count;\r\n    }\r\n  }\r\n\r\n  setRange(start: number, count: number): void {\r\n    this.start = start;\r\n    this.count = count;\r\n  }\r\n\r\n  // static getFullRangeFromGeometry(geometry: Geometry): RenderRange {\r\n  //   if (geometry.indexBuffer !== undefined) {\r\n  //     return geometry.indexBuffer.data.length;\r\n  //   }\r\n  // }\r\n\r\n  start: number = 0;\r\n  count: number = 0;\r\n\r\n  instanceCount: number = 1;\r\n\r\n}\r\n\r\nexport const enum PrimitiveType {\r\n  triangle,\r\n  point,\r\n  lineSegment,\r\n}\r\n\r\nexport type RenderablePrimitive = Line3 | Vector3 | Face3\r\nexport type PrimitiveVisitor = (prim: RenderablePrimitive) => any\r\n\r\n/**\r\n * Class for render drawcall description,  which is describe all drawable things\r\n * a drawable thing should have a geometry to define what to draw\r\n * and a technique to defined how to draw\r\n * and many other draw config such as blending depth behavior defined in state object\r\n * engine will read these information and organize things properly\r\n * \r\n * @export\r\n * @class RenderObject\r\n * @extends {SceneNode}\r\n */\r\nexport class RenderObject extends SceneNode {\r\n\r\n  material?: Material;\r\n  geometry?: Geometry;\r\n  shading?: Shading;\r\n  range?: RenderRange;\r\n  state: DrawState =  new DrawState();\r\n\r\n  // sometimes something draw as mesh(tri), but act like line, like fatLine \r\n  // so, drawMode and primitiveType is different things \r\n  drawMode: DrawMode = DrawMode.TRIANGLES;\r\n  primitiveType: PrimitiveType = PrimitiveType.triangle;\r\n\r\n  foreachPrimitive(_visitor: PrimitiveVisitor) { throw \"not implement\" }\r\n\r\n  g(geometry: Geometry) {\r\n    this.geometry = geometry;\r\n    return this;\r\n  }\r\n\r\n  m(material: Material) {\r\n    this.material = material;\r\n    return this;\r\n  }\r\n\r\n  s(shading: Shading) {\r\n    this.shading = shading;\r\n    return this;\r\n  }\r\n}","import { Vector3, Matrix4 } from \"../../math\";\r\n\r\nexport class Sphere {\r\n  constructor(center?: Vector3, radius?: number) {\r\n    if (center !== undefined) {\r\n      this.center = center;\r\n    }\r\n    if (radius !== undefined) {\r\n      this.radius = radius;\r\n    }\r\n  }\r\n\r\n  center: Vector3 = new Vector3();\r\n  radius: number = 1;\r\n\r\n  clone() {\r\n    return new Sphere().copy(this);\r\n  }\r\n\r\n  copy(sphere: Sphere) {\r\n    this.center.copy(sphere.center);\r\n    this.radius = sphere.radius;\r\n    return this;\r\n  }\r\n\r\n  equals(sphere: Sphere) {\r\n    return sphere.center.equals(this.center) && (sphere.radius === this.radius);\r\n  }\r\n\r\n  applyMatrix4(matrix: Matrix4) {\r\n    this.center.applyMatrix4(matrix);\r\n    this.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n    return this;\r\n  }\r\n\r\n}","import { RenderObject, PrimitiveVisitor, PrimitiveType } from \"../core/render-object\";\r\nimport { DrawMode, CullSide } from \"../webgl/const\";\r\nimport { RayCasterable, Raycaster, RayCastResult } from \"../core/raycaster\";\r\nimport { Face3 } from \"../math/entity/face3\";\r\nimport { Matrix4, Vector3 } from \"../math\";\r\nimport { Sphere } from \"../math/entity/sphere\";\r\n\r\nconst inverse = new Matrix4();\r\nconst sphere = new Sphere();\r\n\r\nexport class Mesh extends RenderObject\r\n  implements RayCasterable {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.drawMode = DrawMode.TRIANGLES;\r\n    this.primitiveType = PrimitiveType.triangle;\r\n  }\r\n\r\n  foreachPrimitive(visitor: PrimitiveVisitor) {\r\n    if (this.geometry !== undefined) {\r\n      this.geometry.foreachFace(visitor, this.range)\r\n    }\r\n  }\r\n\r\n  raycast(raycaster: Raycaster, results: RayCastResult[]): RayCastResult[] {\r\n    inverse.getInverse(this.worldMatrix, false)\r\n    const localRay = raycaster.getLocalRay(inverse);\r\n    const hitPosition = new Vector3();\r\n\r\n    // filter by world sphere\r\n    sphere.copy(this.geometry.boundingSphere);\r\n    sphere.applyMatrix4(this.worldMatrix);\r\n    if (!raycaster.worldRay.ifIntersectSphere(sphere)) {\r\n      return;\r\n    }\r\n\r\n    // have to check face\r\n    this.geometry.foreachFace((face: Face3) => {\r\n\r\n      const result = localRay.intersectTriangle(\r\n        face.p1, face.p2, face.p3,\r\n        this.state.cullSide === CullSide.CullFaceBack,\r\n        hitPosition)\r\n\r\n      if (result !== null) {\r\n        results.push({\r\n          object: this,\r\n          hitLocalPosition: hitPosition.clone()\r\n        })\r\n      }\r\n\r\n    }, this.range)\r\n  }\r\n\r\n  raycastIfHit(raycaster: Raycaster): boolean {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n\r\n  raycastFirst(raycaster: Raycaster): RayCastResult {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n\r\n  raycasterable: true = true;\r\n}","import { Vector3 } from \"../vector3\";\r\n\r\nexport class Box3 {\r\n  constructor(min?: Vector3, max?: Vector3) {\r\n    if (min !== undefined) {\r\n      this.min.copy(min);\r\n      this.max.copy(max);\r\n    }\r\n  }\r\n\r\n  min: Vector3 = new Vector3();\r\n  max: Vector3 = new Vector3();\r\n\r\n  clone(): Box3 {\r\n    const b = new Box3();\r\n    return b.copy(this);\r\n  }\r\n\r\n  copy(box: Box3): Box3 {\r\n    this.min.copy(box.min);\r\n    this.max.copy(box.max);\r\n    return this;\r\n  }\r\n\r\n  makeEmpty(): Box3 {\r\n    this.min.x = this.min.y = this.min.z = + Infinity;\r\n    this.max.x = this.max.y = this.max.z = - Infinity;\r\n    return this;\r\n  }\r\n\r\n  isEmpty() {\r\n    // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n    return (this.max.x < this.min.x) || (this.max.y < this.min.y) || (this.max.z < this.min.z);\r\n  }\r\n\r\n  getCenter(target: Vector3) {\r\n    return this.isEmpty() ? target.set(0, 0, 0) : target.addVectors(this.min, this.max).multiplyScalar(0.5);\r\n  }\r\n\r\n  expandByPoint(point: Vector3) {\r\n    this.min.min(point);\r\n    this.max.max(point);\r\n    return this;\r\n  }\r\n\r\n}","import { BufferData } from \"./buffer-data\";\r\nimport { Box3 } from \"../math/entity/box3\";\r\nimport { Sphere } from \"../math/entity/sphere\";\r\nimport { generateUUID } from '../math/uuid';\r\nimport { RenderRange } from \"./render-object\";\r\nimport { Face3 } from \"../math/entity/face3\";\r\nimport { Line3 } from \"../math/entity/line3\";\r\nimport { Vector3 } from \"../math/vector3\";\r\n\r\n/**\r\n * geometry define what to draw\r\n * by defined data layout and data content\r\n * also handle gl buffer update\r\n * @export\r\n * @class Geometry\r\n */\r\nexport abstract class Geometry {\r\n  name: string = \"\"\r\n  uuid = generateUUID();\r\n\r\n  /**\r\n   * This for mark VAO need update, if buffer layout has changed,\r\n   * or bufferData it self changed, we need mark it, and after upload,\r\n   *  call _markBufferArrayHasUpload set it back;\r\n   */\r\n  _bufferArraysChange: boolean = true;\r\n  _markBufferArrayHasUpload() {\r\n    this._bufferArraysChange = false;\r\n  }\r\n\r\n  _bufferDatum: { [index: string]: BufferData } = {};\r\n  _indexBuffer: BufferData;\r\n  \r\n  getBuffer(name: string) {\r\n    return this._bufferDatum[name];\r\n  }\r\n\r\n  setBuffer(name: string, data: BufferData) {\r\n    this._bufferDatum[name] = data;\r\n    this._bufferArraysChange = true;\r\n    return this;\r\n  }\r\n\r\n  get indexBuffer() {\r\n    return this._indexBuffer;\r\n  }\r\n\r\n  set indexBuffer(value: BufferData) {\r\n    this._indexBuffer = value;\r\n    this._bufferArraysChange = true;\r\n  }\r\n\r\n  setIndexBuffer(value: BufferData) {\r\n    this.indexBuffer = value;\r\n    return this;\r\n  }\r\n\r\n  checkBufferArrayChange() {\r\n    if (this._bufferArraysChange) {\r\n      return this._bufferArraysChange\r\n    }\r\n    for (const key in this._bufferDatum) {\r\n      if (this._bufferDatum[key].dataChanged) {\r\n        this._bufferArraysChange = true;\r\n        return this._bufferArraysChange;\r\n      }\r\n    }\r\n    return this._bufferArraysChange;\r\n  }\r\n\r\n  _shapeChanged = true;\r\n  set shapeChanged(value: boolean) {\r\n    this._shapeChanged = value;\r\n    if (value) {\r\n      this._AABBBoxNeedUpdate = true;\r\n      this._boundingSphereNeedUpdate = true;\r\n    }\r\n  };\r\n\r\n  _AABBBox: Box3 = new Box3();\r\n  _AABBBoxNeedUpdate = true;\r\n  abstract updateAABBBox(): void;\r\n  get AABBBox(): Box3 {\r\n    if (this._AABBBoxNeedUpdate) {\r\n      this.updateAABBBox();\r\n      this._AABBBoxNeedUpdate = false;\r\n    }\r\n    return this._AABBBox;\r\n  }\r\n\r\n  _boundingSphere: Sphere = new Sphere();\r\n  _boundingSphereNeedUpdate = true;\r\n  abstract updateBoundingSphere(): void;\r\n  get boundingSphere(): Sphere {\r\n    if (this._boundingSphereNeedUpdate) {\r\n      this.updateBoundingSphere();\r\n      this._boundingSphereNeedUpdate = false;\r\n    }\r\n    return this._boundingSphere;\r\n  }\r\n\r\n  buildShape() {\r\n    this.shape();\r\n    this.shapeChanged = true;\r\n  }\r\n\r\n  /**\r\n   * creat or update the geometry's data in BufferDatum\r\n   */\r\n  abstract shape(): void;\r\n\r\n  abstract foreachFace(visitor: (face: Face3) => any, range?: RenderRange): any;\r\n  abstract foreachLineSegment(visitor:  (face: Line3) => any, range?: RenderRange): any;\r\n  abstract foreachVertex(visitor:  (face: Vector3) => any, range?: RenderRange): any;\r\n\r\n}\r\n\r\n\r\n","import { Vector3 } from \"../vector3\";\r\n\r\nexport class Face3 {\r\n  p1: Vector3 = new Vector3();\r\n  p2: Vector3 = new Vector3();\r\n  p3: Vector3 = new Vector3();\r\n\r\n}","import { Vector3 } from \"../vector3\";\r\nimport { Matrix4 } from \"../matrix4\";\r\n\r\nexport class Line3 {\r\n  p1: Vector3;\r\n  p2: Vector3;\r\n\r\n  constructor(p1?: Vector3, p2?: Vector3) {\r\n    this.p1 = ( p1 !== undefined ) ? p1 : new Vector3();\r\n\t  this.p2 = ( p2 !== undefined ) ? p2 : new Vector3();\r\n    return this;\r\n  }\r\n\r\n  lengthSq() {\r\n    return this.p1.distanceToSquared(this.p2);\r\n  }\r\n\r\n  length() {\r\n    return this.p1.distanceTo(this.p2);\r\n  }\r\n\r\n  applyMatrix4 ( matrix: Matrix4 ): Line3 {\r\n\t\tthis.p1.applyMatrix4( matrix );\r\n\t\tthis.p2.applyMatrix4( matrix );\r\n\t\treturn this;\r\n  }\r\n  \r\n  clone() {\r\n    const l = new Line3();\r\n\t\treturn l.copy( this );\r\n\t}\r\n\r\n\tcopy (line: Line3 ): Line3 {\r\n\t\tthis.p1.copy( line.p1 );\r\n\t\tthis.p2.copy( line.p2 );\r\n\t\treturn this;\r\n\t}\r\n\r\n}","import { RenderEngine } from \"../engine/render-engine\";\r\nexport type BufferDataType = Float32Array | Uint16Array | Uint32Array;\r\n\r\n/**\r\n * BufferData is a container for webglBuffer.\r\n * Provided some convenient methods for data manipulating\r\n */\r\nexport class BufferData{\r\n  static f3(data: number[]): BufferData {\r\n    return new BufferData(new Float32Array(data), 3)\r\n  }\r\n  static f2(data: number[]): BufferData {\r\n    return new BufferData(new Float32Array(data), 2)\r\n  }\r\n  static u32Index(data: number[]): BufferData {\r\n    return new BufferData(new Uint32Array(data), 1)\r\n  }\r\n\r\n  constructor(data: BufferDataType, stride: number) {\r\n    this.data = data;\r\n    this.stride = stride;\r\n  }\r\n  data: BufferDataType;\r\n  stride: number = 1;\r\n  dataChanged = true;\r\n\r\n  get count() {\r\n    return this.data.length / this.stride;\r\n  }\r\n\r\n  foreach(\r\n    visitor: (data: BufferDataType, index: number, stride: number, countIndex: number) => any,\r\n    start?:number, end?: number\r\n  ) {\r\n    const s = Math.max(0, start);\r\n    const e = Math.max(this.count, end);\r\n    for (let i = s; i < e; i ++) {\r\n      visitor(this.data, i * this.stride, this.stride, i);\r\n    }\r\n  }\r\n\r\n  setIndex(index: number, value: number, offset:number) {\r\n    this.dataChanged = true;\r\n    this.data[index * this.stride + offset] = value;\r\n  }\r\n\r\n  getIndex(index: number, offset: number): number {\r\n    return this.data[index * this.stride + offset];\r\n  }\r\n\r\n  setData(data: BufferDataType) {\r\n    this.dataChanged = true;\r\n    this.data = data;\r\n  }\r\n\r\n  getGLAttribute(engine: RenderEngine): WebGLBuffer {\r\n    return engine.getGLAttributeBuffer(this);\r\n  }\r\n\r\n  getDataSizeByte() {\r\n    return this.data.byteLength;\r\n  }\r\n}\r\n\r\nexport class InstancedBufferData extends BufferData{\r\n  constructor(data: BufferDataType, stride: number, divisor: number) {\r\n    super(data, stride);\r\n    this.divisor = divisor;\r\n  }\r\n\r\n  divisor: number = 1;\r\n}","import { Geometry } from \"../core/geometry\";\r\nimport { RenderRange } from \"../core/render-object\";\r\nimport { Face3 } from \"../math/entity/face3\";\r\nimport { Line3 } from \"../math/entity/line3\";\r\nimport { Vector3 } from \"../math/vector3\";\r\nimport { BufferData } from \"../core/buffer-data\";\r\nimport { CommonAttribute } from \"../webgl/attribute\";\r\n\r\nconst tempFace3 = new Face3();\r\nconst tempLine3 = new Line3();\r\nconst tempVector3 = new Vector3();\r\n\r\n/**\r\n * StandardGeometry is indexed Geometry that has position uv normal channel\r\n */\r\nexport class StandardGeometry extends Geometry {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  static create(index: number[], position: number[], normal: number[], uv: number[]): StandardGeometry {\r\n    return new StandardGeometry().create(index, position, normal, uv)\r\n  }\r\n\r\n  create(index: number[], position: number[], normal: number[], uv: number[]): StandardGeometry {\r\n    const positionBuffer = BufferData.f3(position);\r\n    this.setBuffer(CommonAttribute.position, positionBuffer);\r\n\r\n    const normalBuffer = BufferData.f3(normal);\r\n    this.setBuffer(CommonAttribute.normal, normalBuffer);\r\n\r\n    const uvBuffer = BufferData.f2(uv);\r\n    this.setBuffer(CommonAttribute.uv, uvBuffer);\r\n\r\n    // TODO distinguish u16 case\r\n    const indexBuffer = BufferData.u32Index(index);\r\n    this.indexBuffer = indexBuffer;\r\n\r\n    return this;\r\n  }\r\n\r\n  updateBoundingSphere() {\r\n    const sphere = this._boundingSphere;\r\n    const box = this.AABBBox; // update box\r\n    const center = box.getCenter(sphere.center);\r\n    let maxRadiusSq = 0;\r\n    this.foreachVertex((point) => {\r\n      maxRadiusSq = Math.max(maxRadiusSq, center.distanceToSquared(point));\r\n    })\r\n    sphere.radius = Math.sqrt(maxRadiusSq);\r\n  }\r\n\r\n  updateAABBBox() {\r\n    const box = this._AABBBox;\r\n    box.makeEmpty();\r\n    this.foreachVertex((point) => {\r\n      box.expandByPoint(point);\r\n    })\r\n  }\r\n\r\n  foreachFace(visitor: (face: Face3) => any, range?: RenderRange) {\r\n    const position = this.getBuffer(CommonAttribute.position);\r\n    const index = this.indexBuffer;\r\n    const start = range === undefined ? 0 : range.start;\r\n    const end = range === undefined ? index.count : (range.start + range.count);\r\n    for (let i = start; i < end; i++) {\r\n      const p1Index = index.getIndex(i * 3, 0);\r\n      const p2Index = index.getIndex(i * 3 + 1, 0);\r\n      const p3Index = index.getIndex(i * 3 + 2, 0);\r\n      tempFace3.p1.set(position.getIndex(p1Index, 0), position.getIndex(p1Index, 1), position.getIndex(p1Index, 2));\r\n      tempFace3.p2.set(position.getIndex(p2Index, 0), position.getIndex(p2Index, 1), position.getIndex(p2Index, 2));\r\n      tempFace3.p3.set(position.getIndex(p3Index, 0), position.getIndex(p3Index, 1), position.getIndex(p3Index, 2));\r\n      visitor(tempFace3);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * this may redundant visit \r\n   */\r\n  foreachLineSegment(visitor: (line: Line3) => any, range?: RenderRange) {\r\n    const position = this.getBuffer(CommonAttribute.position);\r\n    const index = this.indexBuffer;\r\n    const start = range === undefined ? 0 : range.start;\r\n    const end = range === undefined ? index.count : (range.start + range.count);\r\n    for (let i = start; i < end; i++) {\r\n      const p1Index = index.getIndex(i * 3, 0);\r\n      const p2Index = index.getIndex(i * 3 + 1, 0);\r\n      const p3Index = index.getIndex(i * 3 + 2, 0);\r\n      tempFace3.p1.set(position.getIndex(p1Index, 0), position.getIndex(p1Index, 1), position.getIndex(p1Index, 2));\r\n      tempFace3.p2.set(position.getIndex(p2Index, 0), position.getIndex(p2Index, 1), position.getIndex(p2Index, 2));\r\n      tempFace3.p3.set(position.getIndex(p3Index, 0), position.getIndex(p3Index, 1), position.getIndex(p3Index, 2));\r\n\r\n      tempLine3.p1.copy(tempFace3.p1)\r\n      tempLine3.p2.copy(tempFace3.p2)\r\n      visitor(tempLine3);\r\n      tempLine3.p2.copy(tempFace3.p3)\r\n      visitor(tempLine3);\r\n      tempLine3.p1.copy(tempFace3.p2)\r\n      visitor(tempLine3);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * this may redundant visit \r\n   */\r\n  foreachVertex(visitor: (point: Vector3) => any, range?: RenderRange) {\r\n    const position = this.getBuffer(CommonAttribute.position);\r\n    const index = this.indexBuffer;\r\n    const start = range === undefined ? 0 : range.start;\r\n    const end = range === undefined ? index.count : (range.start + range.count);\r\n    for (let i = start; i < end; i++) {\r\n      const p1Index = index.getIndex(i, 0);\r\n      tempVector3.set(position.getIndex(p1Index, 0), position.getIndex(p1Index, 1), position.getIndex(p1Index, 2));\r\n      visitor(tempVector3);\r\n    }\r\n  };\r\n\r\n  shape() {\r\n    throw 'generate methods not impl'\r\n  }\r\n}","import { StandardGeometry } from '../standard-geometry';\r\n\r\nexport class PlaneGeometry extends StandardGeometry {\r\n  constructor(width?: number, height?: number,\r\n    widthSegments?: number, heightSegments?: number) {\r\n    super();\r\n\r\n    this.width = width !== undefined ? width : 1;\r\n    this.height = height !== undefined ? height : 1;\r\n    this.widthSegments = widthSegments !== undefined ? widthSegments : 1;\r\n    this.heightSegments = heightSegments !== undefined ? heightSegments : 1;\r\n\r\n    this.buildShape();\r\n  }\r\n  name = 'PlaneGeometry'\r\n  width: number;\r\n  height: number;\r\n  widthSegments: number;\r\n  heightSegments: number;\r\n\r\n  shape() {\r\n\r\n    var width_half = this.width / 2;\r\n    var height_half = this.height / 2;\r\n  \r\n    var gridX = Math.floor( this.widthSegments ) || 1;\r\n    var gridY = Math.floor( this.heightSegments ) || 1;\r\n  \r\n    var gridX1 = gridX + 1;\r\n    var gridY1 = gridY + 1;\r\n  \r\n    var segment_width = this.width / gridX;\r\n    var segment_height = this.height / gridY;\r\n  \r\n    var ix, iy;\r\n  \r\n    // buffers\r\n    var indices: number[] = [];\r\n    var vertices: number[] = [];\r\n    var normals: number[] = [];\r\n    var uvs: number[] = [];\r\n  \r\n    // generate vertices, normals and uvs\r\n    for ( iy = 0; iy < gridY1; iy ++ ) {\r\n      var y = iy * segment_height - height_half;\r\n      for ( ix = 0; ix < gridX1; ix ++ ) {\r\n        var x = ix * segment_width - width_half;\r\n        vertices.push( x, - y, 0 );\r\n        normals.push( 0, 0, 1 );\r\n        uvs.push( ix / gridX );\r\n        uvs.push( 1 - ( iy / gridY ) );\r\n      }\r\n    }\r\n  \r\n    // indices\r\n    for ( iy = 0; iy < gridY; iy ++ ) {\r\n      for ( ix = 0; ix < gridX; ix ++ ) {\r\n        const a = ix + gridX1 * iy;\r\n        const b = ix + gridX1 * ( iy + 1 );\r\n        const c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n        const d = ( ix + 1 ) + gridX1 * iy;\r\n        // faces\r\n        indices.push( a, b, d );\r\n        indices.push( b, c, d );\r\n      }\r\n    }\r\n\r\n    this.create(indices, vertices, normals, uvs);\r\n  }\r\n\r\n}\r\n","import { RenderSource } from \"../engine/render-engine\";\r\nimport { Mesh } from \"../object/mesh\";\r\nimport { PlaneGeometry } from \"../geometry/geo-lib/plane-geometry\";\r\n\r\nconst quadMesh = new Mesh();\r\nconst geometry = new PlaneGeometry(2, 2, 1, 1);\r\nquadMesh.geometry = geometry;\r\nexport class QuadSource implements RenderSource{\r\n  hasRendered: boolean = false;\r\n\r\n  resetSource() {\r\n    this.hasRendered = false;\r\n  }\r\n\r\n  nextRenderable() {\r\n    if (this.hasRendered) {\r\n      return null\r\n    }\r\n    this.hasRendered = true;\r\n    return quadMesh\r\n  }\r\n\r\n  updateSource() {}\r\n\r\n}\r\n","\r\n// this is not working when preserveDrawingBuffer set false\r\n// TODO use read framebuffer\r\nexport function downloadCanvasPNGImage(canvas: HTMLCanvasElement, name: string) {\r\n  const link = document.createElement('a');\r\n  link.setAttribute('download', name + '.png');\r\n  link.setAttribute('href', canvas.toDataURL(\"image/png\")\r\n     .replace(\"image/png\", \"image/octet-stream\"));\r\n  link.click();\r\n}\r\n\r\nasync function getStringContentFromFile(file) {\r\n  const reader = new FileReader();\r\n  return new Promise<string>(function (resolve, _) {\r\n    reader.onload = function (e) {\r\n      const str = reader.result;\r\n      resolve(str as string);\r\n    };\r\n    reader.readAsText(file);\r\n  });\r\n}\r\n\r\nexport function openFile() {\r\n  return new Promise((resolve) => {\r\n    const input = document.createElement('input');\r\n    input.setAttribute('type', 'file');\r\n    const func = (e) => {\r\n      resolve(e.target.files[0])\r\n    }\r\n    input.addEventListener('change', func);\r\n    input.click();\r\n  })\r\n}\r\n\r\nexport async function loadStringFromFile() {\r\n  const file = await openFile();\r\n  const str = await getStringContentFromFile(file);\r\n  return str;\r\n}\r\n\r\nexport async function loadImageFromURL(url: string): Promise<HTMLImageElement> {\r\n  return new Promise((resolve, reject) => {\r\n    const image = new Image();\r\n    image.src = url;\r\n    image.onload = () => {\r\n      resolve(image);\r\n    };\r\n    image.onerror = (err) => {\r\n      reject(err);\r\n    }\r\n  })\r\n}\r\n","export function findFirst<T>(array: Array<T>, visitor: (item: T)=>boolean) {\r\n  for (let i = 0; i < array.length; i++) {\r\n    if (visitor(array[i])) {\r\n      return array[i]\r\n    }\r\n  }\r\n}\r\n","const indentSpaceSize = 2;\r\nlet indentUnit = '';\r\nfor (let i = 0; i < indentSpaceSize; i++) {\r\n  indentUnit += ' ';\r\n  \r\n}\r\nconst indentStringCache: string[] = [];\r\nexport function getIndent(indentCount: number):string {\r\n  if (indentStringCache[indentCount] !== undefined) {\r\n    return indentStringCache[indentCount];\r\n  }\r\n  let str = '';\r\n  for (let i = 0; i < indentCount; i++) {\r\n    str += indentUnit;\r\n  }\r\n  indentStringCache[indentCount] = str;\r\n  return str;\r\n}","import { getIndent } from \"./indent\";\r\n\r\nexport class CodeBuilder{\r\n\r\n  currentIndent: number = 0;\r\n  result: string = \"\"\r\n\r\n  addIndent() {\r\n    this.currentIndent++;\r\n  }\r\n  reduceIndent() {\r\n    this.currentIndent--;\r\n  }\r\n\r\n  emptyLine() {\r\n    this.writeLine(\"\")\r\n  }\r\n\r\n  writeLine(value: string) {\r\n    this.result += getIndent(this.currentIndent) + value + \"\\n\"\r\n  }\r\n\r\n  writeBlock(value: string) {\r\n    const lines = value.split(\"\\n\");\r\n    lines.forEach(line => {\r\n      const trimmed = line.trim()\r\n      if (trimmed.length > 0) {\r\n        this.writeLine(trimmed);\r\n      }\r\n    })\r\n  }\r\n\r\n  writeBlockRaw(value: string) {\r\n    this.result += value;\r\n  }\r\n\r\n  writeCommentBlock(value: string) {\r\n    this.writeLine(\"/*\")\r\n    value.split(\"\\n\").forEach(line => {\r\n      this.writeLine(\" * \" + line)\r\n    })\r\n    this.writeLine(\" */\")\r\n  }\r\n\r\n  reset() {\r\n    this.currentIndent = 0;\r\n    this.result = \"\"\r\n  }\r\n  output() {\r\n    const result = this.result;\r\n    this.reset();\r\n    return result\r\n  }\r\n}","import { generateUUID } from \"../math/uuid\";\r\n\r\nexport class DAGNode {\r\n  uuid: string = generateUUID();\r\n  toNodes: Set<DAGNode> = new Set();\r\n  fromNodes: Set<DAGNode> = new Set();\r\n  protected fulfillList: Map<string, boolean> = new Map();\r\n\r\n  connectTo(node: DAGNode) {\r\n    this.toNodes.add(node);\r\n    node._addFromRef(this);\r\n  }\r\n\r\n  disconnectTo(node: DAGNode) {\r\n    this.toNodes.delete(node);\r\n    node._removeFromRef(this);\r\n  }\r\n\r\n  clearAllTo() {\r\n    this.toNodes.forEach((node) => {\r\n      node._removeFromRef(this)\r\n    })\r\n    this.toNodes.clear();\r\n  }\r\n\r\n  clearAllFrom() {\r\n    this.fromNodes.forEach((node) => {\r\n      node._removeToRef(this);\r\n    })\r\n    this.fromNodes.clear();\r\n  }\r\n\r\n  _addFromRef(node: DAGNode) {\r\n    this.fromNodes.add(node);\r\n  }\r\n\r\n  _removeFromRef(node: DAGNode) {\r\n    this.fromNodes.delete(node);\r\n  }\r\n\r\n  _addToRef(node: DAGNode) {\r\n    this.toNodes.add(node);\r\n  }\r\n\r\n  _removeToRef(node: DAGNode) {\r\n    this.toNodes.delete(node);\r\n  }\r\n\r\n  // TODO this should be optimized\r\n  generateDependencyOrderList(): DAGNode[] {\r\n    // get all possible depend node, and reset fulfill list\r\n    let allDepNodes = this.generateAllDependencyList();\r\n    allDepNodes.forEach(node => {\r\n      node.fulfillList.clear();\r\n      node.fromNodes.forEach((n) => {\r\n        node.fulfillList.set(n.uuid, false);\r\n      })\r\n    })\r\n\r\n    let preventEndlessCounter = 1;\r\n    const result: DAGNode[] = [];\r\n\r\n    function resolveNext(node: DAGNode) {\r\n      result.push(node);\r\n      node.toNodes.forEach((n) => {\r\n        n.fulfillList.delete(node.uuid);\r\n      })\r\n    }\r\n\r\n    while (allDepNodes.length > 0) {\r\n      allDepNodes = allDepNodes.filter(node => {\r\n        if (node.fulfillList.size === 0) {\r\n          resolveNext(node);\r\n          return false\r\n        }\r\n        return true;\r\n      });\r\n\r\n      preventEndlessCounter++;\r\n      if (preventEndlessCounter > 10000) {\r\n        throw 'generateDependencyOrderList failed, graph may contains loop.';\r\n      }\r\n\r\n    }\r\n    return result;\r\n  }\r\n\r\n  traverseDFS(visitor: (node: DAGNode) => any) {\r\n    const visited: Set<DAGNode> = new Set();\r\n    function visit(node: DAGNode) {\r\n      if (!visited.has(node)) {\r\n        visited.add(node);\r\n        visitor(node);\r\n        node.fromNodes.forEach(n => {\r\n          visit(n);\r\n        });\r\n      }\r\n    }\r\n    visit(this);\r\n  }\r\n\r\n  traverseDFS2(visitor: (node: DAGNode) => any) {\r\n    const visited: Map<DAGNode, number> = new Map();\r\n    function visit(node: DAGNode, depth: number) {\r\n      if (!visited.has(node)) {\r\n        visited.set(node, depth);\r\n        visitor(node);\r\n        node.fromNodes.forEach(n => {\r\n          visit(n, depth + 1);\r\n        });\r\n      } else {\r\n        if (visited.get(node) < depth) {\r\n          throw 'graph contains cycle.'\r\n        }\r\n      }\r\n    }\r\n    visit(this, 0);\r\n  }\r\n\r\n\r\n  generateAllDependencyList(): DAGNode[] {\r\n    const result: DAGNode[] = [];\r\n    this.traverseDFS((n) => {\r\n      result.push(n);\r\n    })\r\n    return result;\r\n  }\r\n}","import { DAGNode } from \"../core/dag-node\";\r\nimport { ShaderFunction } from \"./shader-function\";\r\nimport { GLDataType } from \"../webgl/shader-util\";\r\nimport {\r\n  InnerSupportUniform, UniformDescriptor,\r\n  InnerUniformMapDescriptor, InnerUniformMap\r\n} from \"../webgl/uniform/uniform\";\r\nimport { AttributeDescriptor } from \"../webgl/attribute\";\r\nimport { Vector2 } from \"../math/vector2\";\r\nimport { Vector3 } from \"../math/index\";\r\nimport { Vector4 } from \"../math/vector4\";\r\nimport { GLTextureType } from \"../webgl/uniform/uniform-texture\";\r\n\r\nexport class ShaderNode extends DAGNode {\r\n  constructor(\r\n    public type: GLDataType\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  swizzling(swizzleType: string) {\r\n    return new ShaderSwizzleNode(this, swizzleType);\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * A node instance of a shader function\r\n * used in shadergraph for connection\r\n *\r\n * @export\r\n * @class ShaderFunctionNode\r\n * @extends {DAGNode}\r\n */\r\nexport class ShaderFunctionNode extends ShaderNode {\r\n  constructor(factory: ShaderFunction) {\r\n    super(factory.define.returnType);\r\n    this.factory = factory;\r\n  }\r\n\r\n  meaningfulName: string\r\n  factory: ShaderFunction\r\n  inputMap: Map<string, ShaderNode> = new Map();\r\n\r\n  /**\r\n   * give this node a meaningful name!, this name may show in compiled shader.\r\n   */\r\n  name(name: string): ShaderFunctionNode {\r\n    this.meaningfulName = name;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * fill this node a input!\r\n   */\r\n  input(key: string, node: ShaderNode): ShaderFunctionNode {\r\n    const dataType = this.factory.define.inputs[key]\r\n    if (dataType === undefined) {\r\n      throw `this shader function node has not a input which key is ${key}`\r\n    }\r\n    if (dataType !== node.type) {\r\n      console.warn(\"node:\", this);\r\n      console.warn(\"inputNode:\", node);\r\n      throw \"constructFragmentGraph failed: type mismatch\"\r\n    }\r\n    node.connectTo(this);\r\n    this.inputMap.set(key, node);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n\r\nexport class ShaderInputNode extends ShaderNode {\r\n  constructor(name: string, type: GLDataType) {\r\n    super(type);\r\n    this.name = name;\r\n    this.type = type;\r\n  }\r\n  name: string;\r\n}\r\n\r\nexport class ShaderCommonUniformInputNode extends ShaderInputNode {\r\n  constructor(des: UniformDescriptor) {\r\n    super(des.name, des.type);\r\n  }\r\n\r\n  defaultValue: any;\r\n\r\n  default(value: any): ShaderCommonUniformInputNode {\r\n    this.defaultValue = value;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class ShaderVaryInputNode extends ShaderInputNode {\r\n  constructor(name: string, type: GLDataType) {\r\n    super(name, type);\r\n  }\r\n}\r\n\r\nexport class ShaderInnerUniformInputNode extends ShaderInputNode {\r\n  constructor(uni: InnerUniformMapDescriptor) {\r\n    super(uni.name, InnerUniformMap.get(uni.mapInner).type)\r\n    this.mapInner = uni.mapInner;\r\n  }\r\n  mapInner: InnerSupportUniform\r\n}\r\n\r\nexport class ShaderAttributeInputNode extends ShaderInputNode {\r\n  constructor(des: AttributeDescriptor) {\r\n    super(des.name, des.type);\r\n  }\r\n\r\n  isInstance: boolean;\r\n  makeInstance() {\r\n    this.isInstance = true;\r\n    return this;\r\n  }\r\n}\r\n\r\n// castValidFloat\r\nfunction svf(value: number) {\r\n  let str = value + \"\";\r\n  if (str.indexOf(\".\") === -1) {\r\n    str = str + \".0\"\r\n  }\r\n  return str\r\n}\r\n\r\nexport type ShaderConstType = number | Vector2 | Vector3 | Vector4;\r\n\r\nexport class ShaderConstNode extends ShaderNode {\r\n  constructor(value: ShaderConstType) {\r\n    if (typeof value === \"number\") {\r\n      super(GLDataType.float)\r\n      this.shaderString = svf(value);\r\n    } else if (value instanceof Vector2) {\r\n      super(GLDataType.floatVec2)\r\n      this.shaderString = `vec2(${svf(value.x)}, ${svf(value.y)})`;\r\n    } else if (value instanceof Vector3) {\r\n      super(GLDataType.floatVec3)\r\n      this.shaderString = `vec2(${svf(value.x)}, ${svf(value.y)}, ${svf(value.z)})`;\r\n    } else if (value instanceof Vector4) {\r\n      super(GLDataType.floatVec4)\r\n      this.shaderString = `vec4(${svf(value.x)}, ${svf(value.y)}, ${svf(value.z)}, ${svf(value.w)})`;\r\n    } else {\r\n      throw \"un support shader const node value\"\r\n    }\r\n    this.value = value;\r\n  }\r\n  value: ShaderConstType\r\n  shaderString: string;\r\n}\r\n\r\nexport class ShaderTextureNode extends ShaderInputNode {\r\n  constructor(\r\n    public name: string,\r\n    public type: GLDataType,\r\n    public textureType: GLTextureType\r\n  ) {\r\n    super(name, type);\r\n  }\r\n\r\n  fetch(node: ShaderNode): ShaderTextureFetchNode {\r\n    return new ShaderTextureFetchNode(this, node);\r\n  }\r\n}\r\n\r\nexport class ShaderTextureFetchNode extends ShaderNode {\r\n  constructor(\r\n    public source: ShaderTextureNode,\r\n    public fetchByNode: ShaderNode\r\n  ) {\r\n    super(fetchByNode.type);\r\n    source.connectTo(this);\r\n    fetchByNode.connectTo(this);\r\n    this.type = GLDataType.floatVec4\r\n  }\r\n}\r\n\r\nfunction getValueCount(type: GLDataType) {\r\n  switch (type) {\r\n    case GLDataType.float:\r\n      return 1\r\n    case GLDataType.floatVec2:\r\n      return 2\r\n    case GLDataType.floatVec3:\r\n      return 3\r\n    case GLDataType.floatVec4:\r\n      return 4\r\n    default:\r\n      throw \"not support combine type\"\r\n  }\r\n}\r\n\r\nexport class ShaderCombineNode extends ShaderNode {\r\n  constructor(combines: ShaderNode[], type: GLDataType) {\r\n    super(type);\r\n    let count = 0;\r\n    combines.forEach(node => {\r\n      count += getValueCount(node.type)\r\n    })\r\n    if (count !== getValueCount(type)) {\r\n      throw 'combine node input not satisfied'\r\n    }\r\n    this.combineCount = count;\r\n    this.combines = combines;\r\n    this.combines.forEach(node => {\r\n      node.connectTo(this);\r\n    })\r\n  }\r\n\r\n  combines: ShaderNode[];\r\n  combineCount: number;\r\n\r\n\r\n}\r\n\r\nfunction length2Type(value: string) {\r\n  switch (value.length) {\r\n    case 1: return GLDataType.float\r\n    case 2: return GLDataType.floatVec2\r\n    case 3: return GLDataType.floatVec3\r\n    case 4: return GLDataType.floatVec4\r\n    default: throw \"error\"\r\n  }\r\n}\r\n\r\nexport class ShaderSwizzleNode extends ShaderNode {\r\n  constructor(node: ShaderNode, swizzleType: string) {\r\n    super(node.type);\r\n\r\n    const swizzledSourceCount = getValueCount(node.type)\r\n\r\n    const parts = swizzleType.trim().split(\"\");\r\n    if (parts.length > 4) {\r\n      // TODO check more\r\n      throw \"swizzle not valid\"\r\n    }\r\n\r\n    if (parts.length > swizzledSourceCount) {\r\n      throw \"swizzle not valid, swizzle part exceed swizzledSource\"\r\n    }\r\n\r\n    this.from = node;\r\n    node.connectTo(this);\r\n    this.swizzleType = swizzleType\r\n    this.type = length2Type(swizzleType)\r\n  }\r\n  swizzleType: string = \"\";\r\n  from: ShaderNode;\r\n\r\n}","import { ShaderGraph } from \"./shader-graph\";\r\nimport { ShaderFunction } from \"./shader-function\";\r\nimport { getShaderTypeStringFromGLDataType } from \"../webgl/shader-util\";\r\nimport { findFirst } from \"../util/array\";\r\nimport { CodeBuilder } from \"./util/code-builder\";\r\nimport {\r\n  ShaderFunctionNode, ShaderNode, ShaderInputNode, ShaderTextureFetchNode,\r\n  ShaderCombineNode, ShaderConstNode, ShaderSwizzleNode\r\n} from \"./shader-node\";\r\n\r\n\r\nexport function genFragShader(graph: ShaderGraph): string {\r\n  const builder = new CodeBuilder()\r\n  builder.reset();\r\n\r\n  builder.writeLine(\"void main(){\")\r\n  builder.addIndent()\r\n\r\n  const evaluatedNode = new Map<ShaderNode, varRecord>();\r\n  const nodeDependList = graph.fragmentRoot.generateDependencyOrderList() as ShaderNode[];\r\n  const fragResult = codeGenGraph(nodeDependList, \"gl_FragColor\", evaluatedNode);\r\n  builder.writeBlock(fragResult.code)\r\n  pushListToMap(evaluatedNode, fragResult.varList)\r\n\r\n  builder.reduceIndent()\r\n  builder.writeLine(\"}\")\r\n  const mainCode = builder.output();\r\n  \r\n  const includedCode = genShaderFunctionDepend(evaluatedNode);\r\n\r\n  return includedCode + mainCode\r\n}\r\n\r\n\r\nexport function genVertexShader(graph: ShaderGraph): string {\r\n  const builder = new CodeBuilder()\r\n  builder.reset();\r\n\r\n  builder.writeLine(\"void main(){\")\r\n  builder.addIndent()\r\n\r\n  const evaluatedNode = new Map<ShaderNode, varRecord>();\r\n  const nodeDependList = graph.vertexRoot.generateDependencyOrderList() as ShaderNode[];\r\n  const vertexResult = codeGenGraph(nodeDependList, \"gl_Position\", evaluatedNode)\r\n  pushListToMap(evaluatedNode, vertexResult.varList)\r\n  builder.writeBlock(vertexResult.code)\r\n  builder.writeLine(\"gl_PointSize = 5.0;\") // TODO\r\n  builder.emptyLine()\r\n\r\n  graph.varyings.forEach((varyNode, key) => {\r\n    const varyDependList = varyNode.generateDependencyOrderList() as ShaderNode[];\r\n    const varyResult = codeGenGraph(varyDependList, key, evaluatedNode);\r\n    pushListToMap(evaluatedNode, varyResult.varList)\r\n    builder.writeBlock(varyResult.code)\r\n    builder.emptyLine()\r\n  })\r\n\r\n  builder.reduceIndent()\r\n  builder.writeLine(\"}\")\r\n  const mainCode = builder.output();\r\n  \r\n  const includedCode = genShaderFunctionDepend(evaluatedNode);\r\n\r\n  return includedCode + mainCode\r\n}\r\n\r\nfunction pushListToMap(map:Map<ShaderNode, varRecord>, list:varRecord[]) {\r\n  list.forEach(item => {\r\n    if (!map.has(item.refedNode)) {\r\n      map.set(item.refedNode, item)\r\n    }\r\n  })\r\n}\r\n\r\n\r\nfunction genShaderFunctionDepend(nodes: Map<ShaderNode, varRecord>): string {\r\n  let functionsStr = \"\\n\";\r\n  const dependFunctions = new Set<ShaderFunction>();\r\n  nodes.forEach((_record, node) => {\r\n    if (node instanceof ShaderFunctionNode) {\r\n      dependFunctions.add(node.factory)\r\n    }\r\n  })\r\n\r\n  const resolvedFunction = new Set<ShaderFunction>();\r\n  dependFunctions.forEach(func => {\r\n    functionsStr += func.genShaderFunctionIncludeCode(resolvedFunction)\r\n    functionsStr += \"\\n\"\r\n  })\r\n  return functionsStr\r\n}\r\n\r\n// temp1 = asd(12 + d);\r\ninterface varRecord {\r\n  refedNode: ShaderNode,\r\n  varKey: string,\r\n  expression: string,\r\n}\r\n\r\nfunction genTempVarExpFromShaderNode(\r\n  node: ShaderNode,\r\n  ctx: varRecord[],\r\n  preEvaluatedList: Map<ShaderNode, varRecord>\r\n): string {\r\n  function findRecordFromEvaluatedNode(node: ShaderNode) {\r\n    let record: varRecord;\r\n    if (preEvaluatedList.has(node)) {\r\n      record = preEvaluatedList.get(node)\r\n    } else {\r\n      record = findFirst(ctx, varRc => {\r\n        return varRc.refedNode === node\r\n      })\r\n    }\r\n    return record;\r\n  }\r\n\r\n  function genRecordVar(record: varRecord): string {\r\n    let key = \"\";\r\n\r\n    // if depends input node, just use it.\r\n    if (record.refedNode instanceof ShaderInputNode) {\r\n      key = record.refedNode.name;\r\n    } else {\r\n      key = record.varKey;\r\n    }\r\n\r\n    // if (record.refedNode.enableSwizzle) {\r\n    //   return key + \".\" + record.refedNode.swizzleType;\r\n    // } else {\r\n    //   return key;\r\n    // }\r\n    return key\r\n  }\r\n\r\n  function getParamKeyFromVarList(node: ShaderNode): string {\r\n    const record = findRecordFromEvaluatedNode(node);\r\n    if (record === undefined) {\r\n      throw \"_var_miss\"\r\n    }\r\n    return genRecordVar(record);\r\n  }\r\n\r\n  let record = findRecordFromEvaluatedNode(node)\r\n  if (record) {\r\n    return genRecordVar(record);\r\n  }\r\n\r\n  if (node instanceof ShaderFunctionNode) {\r\n    const functionDefine = node.factory.define;\r\n    let functionInputs = \"\";\r\n    Object.keys(functionDefine.inputs).forEach((key, index) => {\r\n      const nodeDepend = node.inputMap.get(key) as ShaderNode;\r\n      if (nodeDepend === undefined) {\r\n        throw `we have a shader function node but the input <${key}> has no input node`\r\n      }\r\n      functionInputs += getParamKeyFromVarList(nodeDepend);\r\n      if (index !== Object.keys(functionDefine.inputs).length - 1) {\r\n        functionInputs += \", \"\r\n      }\r\n    })\r\n    const result = `${functionDefine.name}(${functionInputs})`\r\n    return result;\r\n  }\r\n\r\n  if (node instanceof ShaderInputNode) {\r\n    return (node as ShaderInputNode).name;\r\n  }\r\n\r\n  if (node instanceof ShaderTextureFetchNode) {\r\n    return `texture2D(${node.source.name}, ${getParamKeyFromVarList(node.fetchByNode)})`\r\n  }\r\n\r\n  if (node instanceof ShaderCombineNode) {\r\n    let combineResult = \"\";\r\n    node.combines.forEach((nodeDepend, index) => {\r\n      combineResult += getParamKeyFromVarList(nodeDepend);\r\n      if (index !== node.combines.length - 1) {\r\n        combineResult += \", \"\r\n      }\r\n    })\r\n    const result = `vec${node.combineCount}(${combineResult})`\r\n    return result;\r\n  }\r\n\r\n  if (node instanceof ShaderConstNode) {\r\n    return node.shaderString;\r\n  }\r\n\r\n  if (node instanceof ShaderSwizzleNode) {\r\n    return getParamKeyFromVarList(node.from) + '.' + node.swizzleType;\r\n  }\r\n\r\n\r\n  throw \"unknown shader node\"\r\n}\r\n\r\n\r\nfunction codeGenGraph(\r\n  nodeDependList: ShaderNode[],\r\n  rootOutputName: string,\r\n  preEvaluatedList: Map<ShaderNode, varRecord>\r\n): {\r\n    code: string,\r\n    varList: varRecord[]\r\n  } {\r\n  const builder = new CodeBuilder()\r\n  builder.reset();\r\n  const varList: varRecord[] = [];\r\n  nodeDependList.forEach(nodeToGen => {\r\n    const varName = 'var' + nodeToGen.uuid.slice(0, 4);\r\n    varList.push({\r\n      refedNode: nodeToGen,\r\n      varKey: varName,\r\n      expression: genTempVarExpFromShaderNode(nodeToGen, varList, preEvaluatedList),\r\n    })\r\n  })\r\n  varList.forEach(varRc => {\r\n    if (varRc.refedNode instanceof ShaderInputNode) {\r\n      return;\r\n    }\r\n    if (preEvaluatedList.has(varRc.refedNode)) {\r\n      return;\r\n    }\r\n    const varType = getShaderTypeStringFromGLDataType(varRc.refedNode.type);\r\n    builder.writeLine(`${varType} ${varRc.varKey} = ${varRc.expression};`)\r\n  })\r\n\r\n  const selfRecord = varList[varList.length - 1];\r\n  if (selfRecord.refedNode instanceof ShaderInputNode) {\r\n    builder.writeLine(`${rootOutputName} = ${selfRecord.refedNode.name};`)\r\n  } else {\r\n    builder.writeLine(`${rootOutputName} = ${selfRecord.varKey};`)\r\n  }\r\n  return {\r\n    code: builder.output(),\r\n    varList\r\n  };\r\n}\r\n","import { ShaderFunctionDefine, ShaderFunctionParsedDefine } from \"../shader-function\";\r\nimport { GLDataType } from \"../../webgl/shader-util\";\r\n\r\nexport function parseShaderFunctionMetaInfo(input: ShaderFunctionDefine)\r\n  : ShaderFunctionParsedDefine {\r\n  try {\r\n    const [head, body] = splitStrUntilChar(input.source, '{')\r\n    const [funcHead, funcParam] = splitStrUntilChar(head, '(')\r\n    const { name, returnType } = getFuncHead(funcHead)\r\n    const inputs = getParamList(funcParam)\r\n    const source = getFuncBody(body)\r\n    return {\r\n      name,\r\n      description: input.description,\r\n      source,\r\n      inputs,\r\n      returnType,\r\n    }\r\n  } catch (error) {\r\n    throw \"shader function parsed error\"\r\n  }\r\n}\r\n\r\nexport function splitStrUntilChar(str: string, char: string) {\r\n  for (let i = 0; i < str.length; i++) {\r\n    const c = str[i];\r\n    if (c === char) {\r\n      return [str.substr(0, i), str.substr(i)];\r\n    }\r\n  }\r\n  throw \"split error\"\r\n}\r\n\r\nexport function getDataType(input: string): GLDataType {\r\n  switch (input.trim()) {\r\n    case \"float\": return GLDataType.float\r\n    case \"vec2\": return GLDataType.floatVec2\r\n    case \"vec3\": return GLDataType.floatVec3\r\n    case \"vec4\": return GLDataType.floatVec4\r\n    case \"mat2\": return GLDataType.Mat2\r\n    case \"mat3\": return GLDataType.Mat3\r\n    case \"mat4\": return GLDataType.Mat4\r\n    case \"sampler2D\": return GLDataType.sampler2D\r\n\r\n    default: throw 'parse error'\r\n  }\r\n}\r\n\r\nexport function getOneParam(input: string) {\r\n  const split = input.trim().split(' ').filter(char => char !== \"\");\r\n  return {\r\n    name: split[1].trim(),\r\n    type: getDataType(split[0])\r\n  }\r\n}\r\n\r\nexport function getParamList(input: string) {\r\n  const para = input.trim();\r\n  if (para[para.length - 1] !== ')' || para[0] !== '(') {\r\n    throw 'err'\r\n  }\r\n\r\n  const unbrace = para.substring(1, para.length - 1)\r\n\r\n  const split = unbrace.split(',').filter(char => char.trim() !== \"\");\r\n  const result = {};\r\n  split.forEach(item => {\r\n    const { name, type } = getOneParam(item)\r\n    result[name] = type\r\n  })\r\n  return result;\r\n}\r\n\r\n\r\nexport function getFuncBody(input: string) {\r\n  const para = input.trim();\r\n  if (para[para.length - 1] !== '}' || para[0] !== '{') {\r\n    throw 'err'\r\n  }\r\n  return para.substring(1, para.length - 1);\r\n}\r\n\r\nfunction getFuncHead(input: string) {\r\n  const split = input.split(' ').filter(char => char.trim() !== \"\");\r\n  return {\r\n    name: split[1].trim(),\r\n    returnType: getDataType(split[0])\r\n  }\r\n\r\n}","import { GLDataType, getShaderTypeStringFromGLDataType } from \"../webgl/shader-util\";\r\nimport { ShaderFunctionNode } from \"./shader-node\";\r\nimport { parseShaderFunctionMetaInfo } from \"./parser/shader-function-meta\";\r\nimport { CodeBuilder } from \"./util/code-builder\";\r\n\r\nexport interface ShaderFunctionDefine {\r\n  source: string, \r\n  description?: string;\r\n  dependFunction?: ShaderFunction[];\r\n}\r\n\r\nexport interface ShaderFunctionParsedDefine{\r\n  name: string;\r\n  description?: string;\r\n  source: string;\r\n  inputs: { [index: string]: GLDataType };\r\n  returnType: GLDataType\r\n}\r\n\r\n\r\nconst functionNamesRecord = {};\r\n\r\n/**\r\n *  Define a shader function node factory\r\n *  that with depend some input \r\n *  and output\r\n * @export\r\n * @class ShaderFunction\r\n */\r\nexport class ShaderFunction{\r\n  constructor(define: ShaderFunctionDefine) {\r\n\r\n    this.define = parseShaderFunctionMetaInfo(define);\r\n\r\n    this.name = this.define.name;\r\n    const record = functionNamesRecord[this.define.name];\r\n    if (record !== undefined) {\r\n      functionNamesRecord[this.define.name] = record + 1;\r\n      this.define.name = this.define.name + record\r\n    } else {\r\n      functionNamesRecord[this.define.name] = 1;\r\n    }\r\n\r\n    if (define.dependFunction !== undefined) {\r\n      this.dependShaderFunction = define.dependFunction\r\n    }\r\n  }\r\n\r\n  readonly name: string;\r\n  readonly define: ShaderFunctionParsedDefine\r\n\r\n  dependShaderFunction: ShaderFunction[] = [];\r\n\r\n  make(): ShaderFunctionNode {\r\n    const node = new ShaderFunctionNode(this);\r\n    return node;\r\n  }\r\n\r\n  genShaderFunctionIncludeCode(resolvedFunction: Set<ShaderFunction>): string {\r\n    const builder = new CodeBuilder()\r\n    builder.reset();\r\n\r\n    this.dependShaderFunction.forEach(func => {\r\n      if (!resolvedFunction.has(func)) {\r\n        builder.writeBlock(func.genShaderFunctionIncludeCode(resolvedFunction));\r\n        resolvedFunction.add(func)\r\n      }\r\n    })\r\n    resolvedFunction.add(this)\r\n\r\n    const define = this.define;\r\n    const varType = getShaderTypeStringFromGLDataType(define.returnType);\r\n    let functionInputs = \"\";\r\n    const keys = Object.keys(define.inputs)\r\n    keys.forEach((key, index) => {\r\n      const paramType = getShaderTypeStringFromGLDataType(define.inputs[key]);\r\n      const paramStr = `${paramType} ${key}`\r\n      functionInputs += paramStr\r\n      if (index !== keys.length - 1) {\r\n        functionInputs += \", \"\r\n      }\r\n    })\r\n\r\n    if (define.description !== undefined) {\r\n      builder.writeCommentBlock(define.description)\r\n    }\r\n  \r\n    builder.writeLine(`${varType} ${define.name}(${functionInputs}){`)\r\n    builder.addIndent()\r\n    builder.writeBlock(this.replaceFunctionCalls(define.source))\r\n    builder.reduceIndent()\r\n    builder.writeLine(\"}\")\r\n    return builder.output();\r\n  }\r\n\r\n  // TODO maybe need check cycle depend\r\n  private replaceFunctionCalls(src: string) {\r\n    let source = src.slice();\r\n    this.dependShaderFunction.forEach(func => {\r\n      if (func.name.trim() !== func.define.name.trim()) {\r\n        replaceFunctionCallByName(source, func.name, func.define.name)\r\n      }\r\n    })\r\n    return source;\r\n  }\r\n\r\n}\r\n\r\nfunction replaceFunctionCallByName(source: string, functionName: string, replaceName: string) {\r\n  return source.replace(new RegExp(functionName, 'g'), replaceName);\r\n}","import { ShaderFunction } from \"../shader-function\";\r\n\r\nexport const DivW = new ShaderFunction({\r\n  source: `\r\n    vec3 DivW ( vec4 position){\r\n      return position.xyz / position.w;\r\n    }\r\n  `\r\n})\r\n\r\nexport const MTransform = new ShaderFunction({\r\n  source: `\r\n    vec4 MTransform (mat4 MMatrix, vec3 position){\r\n      return MMatrix * vec4(position, 1.0);\r\n    }\r\n  `\r\n})\r\n\r\nexport const VPTransform = new ShaderFunction({\r\n  source: `\r\n    vec4 VPTransform (mat4 VPMatrix, vec4 position){\r\n      return VPMatrix * position;\r\n    }\r\n  `\r\n})\r\n\r\nexport const getWorldPosition = new ShaderFunction({\r\n  description:\r\n    `Transform from the current view projection matrix and its inverse, \r\n     and uv coordinates to world position`,\r\n  source:\r\n    `\r\n    vec4 getWorldPosition(\r\n      vec2 uv, \r\n      float depth, \r\n      mat4 VPMatrix, \r\n      mat4 VPMatrixInverse\r\n    ){\r\n      float clipW = VPMatrix[2][3] * depth + VPMatrix[3][3];\r\n      vec4 position = VPMatrixInverse * (vec4(uv * 2.0 - 1.0, depth, 1.0) * clipW);\r\n      return position / position.w;\r\n    }\r\n    `\r\n})\r\n\r\nexport const NDCxyToUV = new ShaderFunction({\r\n  description:\r\n    `Get texture uv lookup position from NDC`,\r\n  source: `\r\n  vec2 NDCTextureLookUp(vec3 ndc){\r\n    return vec2(ndc.x / 2.0 + 0.5, ndc.y / 2.0 + 0.5);\r\n  }`\r\n})\r\n\r\nexport const UVDepthToNDC = new ShaderFunction({\r\n  source: `\r\n  vec4 UVDepthToNDC(float depth, vec2 uv){\r\n    return vec4(uv.x * 2.0 - 1.0, uv.y * 2.0 - 1.0,depth, 1.0);\r\n  }`\r\n})\r\n\r\n\r\nexport const getLastPixelNDC = new ShaderFunction({\r\n  source: `\r\n  vec3 getLastPixelNDC(vec4 ndc, mat4 VPMatrixInverse, mat4 LastVPMatrix){\r\n\r\n    // we consider frag too far is background\r\n    if(ndc.z > 0.99){\r\n      return ndc.xyz;\r\n    }\r\n    \r\n    vec4 worldPosition = VPMatrixInverse * ndc;\r\n    vec4 oldPosition = LastVPMatrix * worldPosition;\r\n    oldPosition = oldPosition / oldPosition.w;\r\n    return  oldPosition.xyz;\r\n  }\r\n  `\r\n})\r\n\r\nexport const dir3D = new ShaderFunction({\r\n  source: `\r\n  vec3 randDir(float x, float y){\r\n    float PI =  3.14159265; // TODO\r\n    float lambda = acos(2.0 * x - 1.0) - PI / 2.0;\r\n    float phi = 2.0 * PI * y;\r\n    return vec3(\r\n      cos(lambda) * cos(phi),\r\n      cos(lambda) * sin(phi),\r\n      sin(lambda)\r\n    );\r\n  }\r\n  `\r\n})","import {\r\n  ShaderAttributeInputNode, ShaderCommonUniformInputNode, ShaderInnerUniformInputNode,\r\n  ShaderTextureNode, ShaderNode, ShaderConstType, ShaderConstNode, ShaderCombineNode\r\n} from \"./shader-node\";\r\nimport { GLDataType } from \"../webgl/shader-util\";\r\nimport { InnerSupportUniform, InnerUniformMap } from \"../webgl/uniform/uniform\";\r\nimport { GLTextureType } from \"../webgl/uniform/uniform-texture\";\r\nimport { VPTransform, MTransform } from \"./built-in/transform\";\r\nimport { Vector2 } from \"../math/vector2\";\r\nimport { Vector3, Matrix4 } from \"../math\";\r\nimport { Vector4 } from \"../math/vector4\";\r\nimport { CommonAttribute } from \"../webgl/attribute\";\r\n\r\n// TODO simplify it\r\nexport function attribute(name: string, type: GLDataType) {\r\n  return new ShaderAttributeInputNode({ name, type });\r\n}\r\n\r\nexport function texture(name: string, type?: GLTextureType) {\r\n  const t = type !== undefined ? type : GLTextureType.texture2D;\r\n  return new ShaderTextureNode(name, GLDataType.sampler2D, t);\r\n}\r\n\r\nexport function uniform(name: string, type: GLDataType) {\r\n  return new ShaderCommonUniformInputNode({ name, type });\r\n}\r\n\r\nexport function uniformFromValue(name: string, value: any) {\r\n  if (typeof value === \"number\") {\r\n    return uniform(name, GLDataType.float).default(value);\r\n  } else if (value instanceof Vector2) {\r\n    return uniform(name, GLDataType.floatVec2).default(value);\r\n  } else if (value instanceof Vector3) {\r\n    return uniform(name, GLDataType.floatVec3).default(value);\r\n  } else if (value instanceof Vector4) {\r\n    return uniform(name, GLDataType.floatVec4).default(value);\r\n  } else if (value instanceof Matrix4) {\r\n    return uniform(name, GLDataType.Mat4).default(value);\r\n  } else {\r\n    throw \"un support uniform value\"\r\n  }\r\n}\r\n\r\nexport function innerUniform(type: InnerSupportUniform) {\r\n  return new ShaderInnerUniformInputNode({\r\n    name: 'inner' + InnerUniformMap.get(type).name,\r\n    mapInner: type,\r\n  })\r\n}\r\n\r\nexport function value(value: ShaderConstType) {\r\n  return new ShaderConstNode(value);\r\n}\r\n\r\nexport function vec2(...args: ShaderNode[]) {\r\n  return new ShaderCombineNode(args, GLDataType.floatVec2)\r\n}\r\n\r\nexport function vec3(...args: ShaderNode[]) {\r\n  return new ShaderCombineNode(args, GLDataType.floatVec3)\r\n}\r\n\r\nexport function vec4(...args: ShaderNode[]) {\r\n  return new ShaderCombineNode(args, GLDataType.floatVec4)\r\n}\r\n\r\nexport function constValue(value: any) {\r\n  return new ShaderConstNode(value);\r\n}\r\n\r\nexport function MVPWorld() {\r\n  return VPTransform.make()\r\n    .input(\"VPMatrix\", innerUniform(InnerSupportUniform.VPMatrix))\r\n    .input(\"position\",\r\n      MTransform.make()\r\n        .input('MMatrix', innerUniform(InnerSupportUniform.MMatrix))\r\n        .input('position', attribute(CommonAttribute.position, GLDataType.floatVec3))\r\n    )\r\n}\r\n\r\nexport function screenQuad() {\r\n  return vec4(\r\n    attribute(CommonAttribute.position, GLDataType.floatVec3),\r\n    constValue(1)\r\n  )\r\n}\r\n\r\nexport function makeInstance(\r\n  node: ShaderCommonUniformInputNode | ShaderAttributeInputNode\r\n) {\r\n  return new ShaderAttributeInputNode({\r\n    name: node.name, type: node.type\r\n  }).makeInstance();\r\n}","import { GLProgramConfig } from \"../webgl/program\";\r\nimport { genFragShader, genVertexShader } from \"./code-gen\";\r\nimport {\r\n  ShaderInputNode, ShaderTextureNode, ShaderFunctionNode,\r\n  ShaderAttributeInputNode, ShaderInnerUniformInputNode,\r\n  ShaderCommonUniformInputNode, ShaderNode, ShaderVaryInputNode,\r\n} from \"./shader-node\";\r\nimport { attribute, constValue, MVPWorld } from \"./node-maker\";\r\nimport { GLDataType } from \"../webgl/shader-util\";\r\nimport { CommonAttribute } from \"../webgl/attribute\";\r\nimport { Vector4 } from \"../math\";\r\n\r\n\r\nexport const UvFragVary = \"v_uv\"\r\nexport const NormalFragVary = \"v_normal\"\r\nexport const NDCPositionFragVary = \"v_position_ndc\"\r\nexport const WorldPositionFragVary = \"v_position_world\"\r\n\r\nexport class ShaderGraph {\r\n  constructor() {\r\n    this.reset();\r\n  }\r\n\r\n  fragmentRoot: ShaderNode;\r\n  vertexRoot: ShaderNode;\r\n  varyings: Map<string, ShaderNode> = new Map();\r\n\r\n  setFragmentRoot(root: ShaderNode): ShaderGraph {\r\n    this.fragmentRoot = root;\r\n    return this;\r\n  }\r\n\r\n  // TODO maybe can do better\r\n  // this for:  if user use node maker MVPWorld, it can auto gen world position vary for convenient\r\n  updateAutoWorldPositionVary(root: ShaderNode) {\r\n    this.varyings.delete(WorldPositionFragVary);\r\n    if (root instanceof ShaderFunctionNode && root.factory.define.name === \"VPTransform\") {\r\n      const next = root.inputMap.get(\"position\")\r\n      if (next === undefined) {\r\n        throw `we have a shader function node but the input <position> has no input node`\r\n      }\r\n      if (next instanceof ShaderFunctionNode && next.factory.define.name === \"MTransform\") {\r\n        this.setVary(WorldPositionFragVary, next.swizzling(\"xyz\"));\r\n      }\r\n    }\r\n  }\r\n\r\n  setVertexRoot(root: ShaderNode): ShaderGraph {\r\n    this.vertexRoot = root;\r\n    this.updateAutoWorldPositionVary(root)\r\n    return this;\r\n  }\r\n\r\n  private declareFragNormal(): ShaderGraph {\r\n    if (this.varyings.has(NormalFragVary)) {\r\n      return this;\r\n    }\r\n    return this.setVary(NormalFragVary, attribute(CommonAttribute.normal, GLDataType.floatVec3))\r\n  }\r\n\r\n  declareFragUV(): ShaderGraph {\r\n    if (this.varyings.has(UvFragVary)) {\r\n      return this;\r\n    }\r\n    return this.setVary(UvFragVary, attribute(CommonAttribute.uv, GLDataType.floatVec2))\r\n  }\r\n\r\n  setVary(key: string, root: ShaderNode): ShaderGraph {\r\n    this.varyings.set(key, root);\r\n    return this;\r\n  }\r\n\r\n  getFragRoot(): ShaderNode {\r\n    return this.fragmentRoot;\r\n  }\r\n\r\n  getVary(key: string): ShaderVaryInputNode {\r\n    let ret = this.varyings.get(key);\r\n    if (ret === undefined) {\r\n      if (key === NormalFragVary) {\r\n        this.declareFragNormal();\r\n        ret =  this.varyings.get(key);\r\n      } else {\r\n        throw 'cant get vary'\r\n      }\r\n    }\r\n    return new ShaderVaryInputNode(key, ret.type);\r\n  }\r\n\r\n  reset(): ShaderGraph {\r\n    this.varyings.clear();\r\n    this.setVertexRoot(MVPWorld());\r\n    this.setFragmentRoot(constValue(new Vector4()))\r\n    return this;\r\n  }\r\n\r\n  compile(): GLProgramConfig {\r\n    return {\r\n      ...this.collectInputs(),\r\n      vertexShaderString: this.compileVertexSource(),\r\n      fragmentShaderString: this.compileFragSource(),\r\n      autoInjectHeader: true,\r\n    };\r\n  }\r\n\r\n  // TODO maybe should cache\r\n  get nodes() {\r\n    const nodes: Set<ShaderNode> = new Set();\r\n    this.fragmentRoot.traverseDFS(node => {\r\n      nodes.add(node as ShaderNode);\r\n    })\r\n    this.vertexRoot.traverseDFS(node => {\r\n      nodes.add(node as ShaderNode);\r\n    })\r\n    this.varyings.forEach(vary => {\r\n      vary.traverseDFS(node => {\r\n        nodes.add(node as ShaderNode);\r\n      })\r\n    })\r\n    const nodeList: ShaderNode[] = [];\r\n    nodes.forEach(n => {\r\n      nodeList.push(n);\r\n    })\r\n    return nodeList\r\n  }\r\n\r\n  collectInputs() {\r\n    const nodes = this.nodes;\r\n    const inputNodes = nodes.filter(\r\n      n => n instanceof ShaderInputNode\r\n    );\r\n\r\n    const attributes = inputNodes\r\n      .filter(node => node instanceof ShaderAttributeInputNode)\r\n      .map((node: ShaderAttributeInputNode) => {\r\n        return {\r\n          name: node.name,\r\n          type: node.type,\r\n        }\r\n      });\r\n    const uniforms = inputNodes\r\n      .filter(node => node instanceof ShaderCommonUniformInputNode)\r\n      .map((node: ShaderCommonUniformInputNode) => {\r\n        return {\r\n          name: node.name,\r\n          type: node.type,\r\n          default: node.defaultValue\r\n        }\r\n      });\r\n    const uniformsIncludes = inputNodes\r\n      .filter(node => node instanceof ShaderInnerUniformInputNode)\r\n      .map((node: ShaderInnerUniformInputNode) => {\r\n        return {\r\n          name: node.name,\r\n          mapInner: node.mapInner,\r\n        }\r\n      });\r\n\r\n    const textures = inputNodes\r\n      .filter(node => node instanceof ShaderTextureNode)\r\n      .map((node: ShaderTextureNode) => {\r\n        return {\r\n          name: node.name,\r\n          type: node.textureType,\r\n        }\r\n      });\r\n\r\n    const varyings = [];\r\n    this.varyings.forEach((node, key) => {\r\n      varyings.push({\r\n        name: key,\r\n        type: node.type,\r\n      })\r\n    })\r\n\r\n    return { attributes, uniforms, textures, varyings, uniformsIncludes }\r\n  }\r\n\r\n  compileVertexSource(): string {\r\n    return genVertexShader(this);\r\n  }\r\n\r\n  compileFragSource(): string {\r\n    return genFragShader(this);\r\n  }\r\n\r\n}\r\n\r\n","\r\nimport { generateUUID } from \"../math\";\r\nimport { Nullable } from \"../type\";\r\nimport { GLProgramConfig, GLProgram } from \"../webgl/program\";\r\nimport { ShaderGraph } from \"../shader-graph/shader-graph\";\r\nimport { Observable, Observer } from \"./observable\";\r\nimport { RenderEngine } from \"../engine/render-engine\";\r\nimport { ShaderCommonUniformInputNode } from '../shader-graph/shader-node';\r\nimport { uniformFromValue } from '../shader-graph/node-maker';\r\n\r\nexport interface ShaderUniformDecorator {\r\n  /**\r\n  * impl this to decorate your shader source, add uniform input\r\n  */\r\n  decorate(graph: ShaderGraph): void;\r\n\r\n  /**\r\n   * one UniformProvider can have others provider depends and inject, return them in a array\r\n   */\r\n  foreachProvider(visitor: (p: ShaderUniformProvider) => any): void;\r\n\r\n  notifyNeedRedecorate: Observable<ShaderUniformDecorator>;\r\n}\r\n\r\ntype propertyName = string;\r\ntype uniformName = string;\r\nexport interface ShaderUniformProvider {\r\n\r\n  // mark any change in this uniform group\r\n  hasAnyUniformChanged: boolean;\r\n\r\n  // mark the shader need recompile\r\n  uniforms: Map<uniformName, any>;\r\n  propertyUniformNameMap: Map<propertyName, uniformName>;\r\n}\r\n\r\ntype decoratorRegisterName = string;\r\nexport class Shading {\r\n  uuid = generateUUID();\r\n  graph: ShaderGraph = new ShaderGraph();\r\n\r\n  private _programConfigCache: Nullable<GLProgramConfig> = null;\r\n  private _needRebuildShader: boolean = true;\r\n\r\n  _decorators: ShaderUniformDecorator[] = [];\r\n  private _decoratorSlot: Map<decoratorRegisterName, ShaderUniformDecorator> = new Map();\r\n  private _decoratorObs: Map<ShaderUniformDecorator, Observer<ShaderUniformDecorator>> = new Map();\r\n\r\n  updateDecorator(decorator: ShaderUniformDecorator, slot: decoratorRegisterName) {\r\n    if (slot === undefined) {\r\n      slot = decorator.constructor.name\r\n    }\r\n\r\n    const previous = this._decoratorSlot.get(slot);\r\n    if (previous === undefined) {\r\n      throw `slot ${slot} has not been decorate before`\r\n    }\r\n    if (decorator instanceof previous.constructor) {\r\n      this._decoratorSlot.set(slot, decorator);\r\n    } else {\r\n      throw `provider not the same type before`\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    this._decoratorObs.forEach((obs, dec) => {\r\n      dec.notifyNeedRedecorate.remove(obs);\r\n    })\r\n    this._decoratorObs.clear();\r\n    this._decoratorSlot.clear();\r\n    this._decorators = [];\r\n    this._needRebuildShader = true;\r\n    this._programConfigCache = null;\r\n  }\r\n\r\n  decorate(decorator: ShaderUniformDecorator, decorateSlot?: string, ): Shading {\r\n    if (decorateSlot === undefined) {\r\n      decorateSlot = decorator.constructor.name\r\n    }\r\n\r\n    if (this._decoratorSlot.has(decorateSlot)) {\r\n      throw `slot ${decorateSlot} has been decorate before`\r\n    }\r\n\r\n    const obs = decorator.notifyNeedRedecorate.add((_deco) => {\r\n      this._needRebuildShader = true;\r\n    })\r\n    this._decoratorObs.set(decorator, obs);\r\n\r\n    this._decoratorSlot.set(decorateSlot, decorator)\r\n    this._decorators.push(decorator);\r\n    return this;\r\n  }\r\n\r\n  afterShaderCompiled: Observable<GLProgramConfig> = new Observable();\r\n  build() {\r\n    this.graph.reset()\r\n    this._decorators.forEach(decorator => {\r\n      decorator.decorate(this.graph);\r\n    })\r\n  }\r\n\r\n  getProgramConfig() {\r\n\r\n    if (this._needRebuildShader) {\r\n      this.build();\r\n      this._programConfigCache = this.graph.compile();\r\n      this.afterShaderCompiled.notifyObservers(this._programConfigCache)\r\n      this._needRebuildShader = false;\r\n    }\r\n    return this._programConfigCache;\r\n  }\r\n\r\n  getProgram(engine: RenderEngine): GLProgram {\r\n    if (this._needRebuildShader) {\r\n      this.disposeProgram(engine);\r\n    }\r\n    let program = engine.getProgram(this);\r\n    if (program === undefined) {\r\n      program = engine.createProgram(this);\r\n    }\r\n    return program;\r\n  }\r\n\r\n  disposeProgram(engine: RenderEngine): void {\r\n    engine.deleteProgram(this);\r\n  }\r\n\r\n}\r\n\r\nexport function MarkNeedRedecorate() {\r\n  return (target: ShaderUniformDecorator, key: string) => {\r\n    if (target.notifyNeedRedecorate === undefined) {\r\n      target.notifyNeedRedecorate = new Observable();\r\n    }\r\n    let val = target[key];\r\n    const getter = () => {\r\n      return val;\r\n    };\r\n    const setter = (value) => {\r\n      const oldValue = val;\r\n      val = value;\r\n      if (oldValue !== value) {\r\n        target.notifyNeedRedecorate.notifyObservers(target);\r\n      }\r\n    };\r\n\r\n    Object.defineProperty(target, key, {\r\n      get: getter,\r\n      set: setter,\r\n      enumerable: true,\r\n      configurable: true,\r\n    });\r\n  };\r\n}\r\n\r\n\r\nexport function MapUniform(remapName: string) {\r\n  return (target: ShaderUniformProvider, key: string) => {\r\n    if (target.uniforms === undefined) {\r\n      target.uniforms = new Map();\r\n    }\r\n    if (target.propertyUniformNameMap === undefined) {\r\n      target.propertyUniformNameMap = new Map();\r\n    }\r\n\r\n    let val = target[key];\r\n    const getter = () => {\r\n      return val;\r\n    };\r\n    const setter = (value) => {\r\n      target.uniforms.set(remapName, value);\r\n      target.hasAnyUniformChanged = true;\r\n      val = value;\r\n    };\r\n\r\n    target.propertyUniformNameMap.set(key, remapName);\r\n\r\n    Object.defineProperty(target, key, {\r\n      get: getter,\r\n      set: setter,\r\n      enumerable: true,\r\n      configurable: true,\r\n    });\r\n  };\r\n}\r\n\r\nexport abstract class BaseEffectShading<T>\r\n  implements ShaderUniformProvider, ShaderUniformDecorator {\r\n  constructor() {\r\n    // need check if has initialized by decorator\r\n    if (this.uniforms === undefined) {\r\n      this.uniforms = new Map();\r\n    }\r\n    if (this.propertyUniformNameMap === undefined) {\r\n      this.propertyUniformNameMap = new Map();\r\n    }\r\n\r\n    if (this.notifyNeedRedecorate === undefined) {\r\n      this.notifyNeedRedecorate = new Observable()\r\n    }\r\n  }\r\n\r\n  abstract decorate(graph: ShaderGraph): void;\r\n\r\n  foreachProvider(visitor: (p: ShaderUniformProvider) => any) {\r\n    return visitor(this);\r\n  }\r\n\r\n  notifyNeedRedecorate: Observable<ShaderUniformDecorator>\r\n\r\n  hasAnyUniformChanged: boolean = true;\r\n  propertyUniformNameMap: Map<string, string>;\r\n  uniforms: Map<string, any>;\r\n\r\n  getPropertyUniform(name: keyof T): ShaderCommonUniformInputNode {\r\n    const uniformName = this.propertyUniformNameMap.get(name as string);\r\n    const value = this[name as string];\r\n    if (value === undefined) {\r\n      throw \"uniform value not given\"\r\n    }\r\n    return uniformFromValue(uniformName, value);\r\n  }\r\n}\r\n\r\n\r\n// type Constructor<T = SceneNode> = new (...args: any[]) => T;\r\n// type ConstructorTypeOf<T> = new (...args:any[]) => T;\r\n\r\n// export function ShaderUniformSceneNodeProvidable<T extends Constructor>(_target: T)\r\n//   : ConstructorTypeOf<SceneNode & BaseEffectShading<T>>\r\n// {\r\n//   return class <K> extends SceneNode implements ShaderUniformProvider{\r\n//     constructor() {\r\n//       super();\r\n//       // need check if has initialized by decorator\r\n//       if (this.uniforms === undefined) {\r\n//         this.uniforms = new Map();\r\n//       }\r\n//       if (this.propertyUniformNameMap === undefined) {\r\n//         this.propertyUniformNameMap = new Map();\r\n//       }\r\n//     }\r\n\r\n//     decorate(_graph: ShaderGraph): void {\r\n//       throw new Error(\"Method not implemented.\");\r\n//     }\r\n\r\n//     hasAnyUniformChanged: boolean;\r\n\r\n//     propertyUniformNameMap: Map<string, string>;\r\n\r\n//     uniforms: Map<string, any>;\r\n\r\n//     getPropertyUniform(name: keyof K): ShaderCommonUniformInputNode {\r\n//       const uniformName = this.propertyUniformNameMap.get(name as string);\r\n//       const value = this[name as string];\r\n//       if (value === undefined) {\r\n//         throw \"uniform value not given\"\r\n//       }\r\n//       if (typeof value === \"number\") {\r\n//         return uniform(uniformName, GLDataType.float).default(value);\r\n//       } else if (value instanceof Vector2) {\r\n//         return uniform(uniformName, GLDataType.floatVec2).default(value);\r\n//       } else if (value instanceof Vector3) {\r\n//         return uniform(uniformName, GLDataType.floatVec3).default(value);\r\n//       } else if (value instanceof Vector4) {\r\n//         return uniform(uniformName, GLDataType.floatVec4).default(value);\r\n//       } else if (value instanceof Matrix4) {\r\n//         return uniform(uniformName, GLDataType.Mat4).default(value);\r\n//       } else {\r\n//         throw \"un support uniform value\"\r\n//       }\r\n//     }\r\n//   };\r\n// }","import { BaseEffectShading } from \"../../core/shading\";\r\nimport { texture, screenQuad } from \"../../shader-graph/node-maker\";\r\nimport { UvFragVary, ShaderGraph } from '../../shader-graph/shader-graph';\r\n\r\nexport class CopyShading extends BaseEffectShading<CopyShading> {\r\n\r\n  decorate(graph: ShaderGraph) {\r\n    graph\r\n      .setVertexRoot(screenQuad())\r\n      .declareFragUV()\r\n      .setFragmentRoot(\r\n        texture(\"copySource\").fetch(graph.getVary(UvFragVary))\r\n      )\r\n  }\r\n\r\n}\r\n","import { Controller } from \"./controller\";\r\nimport { Vector2 } from \"../math/vector2\";\r\n\r\ninterface ControllerCallback {\r\n  controller: Controller,\r\n  callback: Function\r\n}\r\n\r\n// const prev = new Vector2();\r\nconst mousePosition = new Vector2();\r\nconst v1 = new Vector2();\r\n\r\n// interactor responsible for handle web event from an element\r\n// and dispatch control event to controllers\r\nexport class Interactor{\r\n  constructor(inputElement:HTMLElement) {\r\n    this.inputElement = inputElement;\r\n    this.bind();\r\n  }\r\n\r\n  enabled: boolean = true;\r\n  mouseButton: number = -1; // -1 is default state for no button pressed \r\n  inputElement: HTMLElement;\r\n  prev = new Vector2();\r\n\r\n  private controllers: Controller[] = [];\r\n\r\n  private bind(): void {\r\n    const el = this.inputElement;\r\n    this.mouseButton = -1;\r\n    el.addEventListener('mousemove', this.onMouseMove, false);\r\n    el.addEventListener('mousedown', this.onMouseDown, false);\r\n    el.addEventListener('mouseup', this.onMouseUp, false);\r\n    el.addEventListener('wheel', this.onMouseWheel, false);\r\n    // el.addEventListener('keydown', this.eventLoop, false);\r\n    // el.addEventListener('keyup', this.cancelLoop, false);\r\n    el.addEventListener('contextmenu', this.preventContentMenu, false);\r\n  }\r\n  private unbind(): void {\r\n    const el = this.inputElement;\r\n    this.mouseButton = -1;\r\n    el.removeEventListener('mousemove', this.onMouseMove);\r\n    el.removeEventListener('mousedown', this.onMouseDown);\r\n    el.removeEventListener('mouseup', this.onMouseUp);\r\n    el.removeEventListener('wheel', this.onMouseWheel);\r\n    // el.removeEventListener('keydown', this.eventLoop);\r\n    // el.removeEventListener('keyup', this.cancelLoop);\r\n    el.removeEventListener('contextmenu', this.preventContentMenu, false);\r\n  }\r\n\r\n  private preventContentMenu(event: MouseEvent) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  }\r\n\r\n  private onMouseMove = (event: MouseEvent) => {\r\n    if (!this.enabled) {\r\n      return;\r\n    }\r\n    mousePosition.set(event.clientX, event.clientY);\r\n    v1.copy(this.prev).sub(mousePosition);\r\n    if (this.mouseButton === 0) {\r\n      this.groupEmit(this.leftMouseMoveCallBacks, v1);\r\n    }\r\n    if (this.mouseButton === 2) {\r\n      this.groupEmit(this.rightMouseMoveCallBacks, v1);\r\n    }\r\n    this.prev.copy(mousePosition);\r\n  }\r\n\r\n  private onMouseDown = (event: MouseEvent) => {\r\n    if (!this.enabled) {\r\n      return;\r\n    }\r\n    this.prev.set(event.clientX, event.clientY);\r\n    this.mouseButton = event.button;\r\n    event.preventDefault();\r\n  }\r\n\r\n  private onMouseUp = (event: MouseEvent) => {\r\n    if (!this.enabled) {\r\n      return;\r\n    }\r\n    this.groupEmit(this.mouseUpCallBacks);\r\n    this.mouseButton = -1;\r\n  }\r\n\r\n  private onMouseWheel = (event: WheelEvent) => {\r\n    if (!this.enabled) {\r\n      return;\r\n    }\r\n    let delta = 0;\r\n    if ((event as any).wheelDelta !== void 0) {\r\n      // WebKit / Opera / Explorer 9\r\n      delta = (event as any).wheelDelta;\r\n    } else if (event.deltaY !== void 0) {\r\n      // Firefox\r\n      delta = -event.deltaY;\r\n    }\r\n    delta = delta > 0 ? 1.1 : 0.9;\r\n    this.groupEmit(this.mouseWheelCallBacks, delta);\r\n  }\r\n\r\n  private leftMouseMoveCallBacks: ControllerCallback[] = [];\r\n  private rightMouseMoveCallBacks: ControllerCallback[] = [];\r\n  private mouseWheelCallBacks: ControllerCallback[] = [];\r\n  private mouseDownCallBacks: ControllerCallback[] = [];\r\n  private mouseUpCallBacks: ControllerCallback[] = [];\r\n\r\n  private groupEmit(callBackList: ControllerCallback[], ...param: any) {\r\n    callBackList.forEach(callback => {\r\n      callback.callback(...param);\r\n    });\r\n  }\r\n  private removeController(controller: Controller, callBackList: ControllerCallback[]) {\r\n    callBackList = callBackList.filter(callback => { return callback.controller === controller });\r\n  }\r\n\r\n  public bindLeftMouseMove(controller: Controller, callback: (offset: Vector2) => any) {\r\n    this.leftMouseMoveCallBacks.push({controller, callback});\r\n  }\r\n\r\n  public bindRightMouseMove(controller: Controller, callback: (offset: Vector2) => any) {\r\n    this.rightMouseMoveCallBacks.push({controller, callback});\r\n  }\r\n\r\n  public bindMouseWheel(controller: Controller, callback: (delta: number) => any) {\r\n    this.mouseWheelCallBacks.push({controller, callback});\r\n  }\r\n\r\n  public bindMouseDown(controller: Controller, callback: () => any) {\r\n    this.mouseDownCallBacks.push({controller, callback});\r\n  }\r\n\r\n  public bindMouseUp(controller: Controller, callback: () => any) {\r\n    this.mouseUpCallBacks.push({controller, callback});\r\n  }\r\n\r\n  public unbindControllerAllListener(controller: Controller) {\r\n    this.removeController(controller, this.mouseUpCallBacks);\r\n    this.removeController(controller, this.rightMouseMoveCallBacks);\r\n    this.removeController(controller, this.mouseWheelCallBacks);\r\n    this.removeController(controller, this.mouseDownCallBacks);\r\n    this.removeController(controller, this.mouseUpCallBacks);\r\n  }\r\n\r\n  dispose() {\r\n    this.unbind();\r\n    this.leftMouseMoveCallBacks = [];\r\n    this.rightMouseMoveCallBacks = [];\r\n    this.mouseWheelCallBacks = [];\r\n    this.mouseDownCallBacks = [];\r\n    this.mouseUpCallBacks = [];\r\n  }\r\n}","import { GLRenderer } from \"../webgl/gl-renderer\";\r\nimport { RenderObject, RenderRange } from \"../core/render-object\";\r\nimport { Camera } from \"../core/camera\";\r\nimport { Matrix4 } from \"../math/matrix4\";\r\nimport { GLProgram } from \"../webgl/program\";\r\nimport { Geometry } from \"../core/geometry\";\r\nimport { BufferData } from \"../core/buffer-data\";\r\nimport { Material } from \"../core/material\";\r\nimport { GLTextureUniform } from \"../webgl/uniform/uniform-texture\";\r\nimport { PerspectiveCamera } from \"../camera/perspective-camera\";\r\nimport { Nullable, GLReleasable } from \"../type\";\r\nimport { InnerSupportUniform, InnerUniformMap } from \"../webgl/uniform/uniform\";\r\nimport { UniformProxy } from \"./uniform-proxy\";\r\nimport { Observable } from \"../core/observable\";\r\nimport { GLFramebuffer } from '../webgl/gl-framebuffer';\r\nimport { QuadSource } from '../render-graph/quad-source';\r\nimport { downloadCanvasPNGImage } from \"../util/file-io\";\r\nimport { CopyShading } from \"../shading/pass-lib/copy\";\r\nimport { NormalShading } from \"../artgl\";\r\nimport { VAOCreateCallback } from \"../webgl/vao\";\r\nimport { Vector4 } from \"../math/vector4\";\r\nimport { Shading, ShaderUniformProvider } from \"../core/shading\";\r\nimport { Interactor } from \"../interact/interactor\";\r\n\r\nexport interface RenderSource{\r\n  resetSource(): void;\r\n  nextRenderable(): Nullable<RenderObject>;\r\n  updateSource(): void;\r\n}\r\n\r\nexport function foreachRenderableInSource(source: RenderSource, visitor: (obj: RenderObject) => any) {\r\n  source.updateSource();\r\n  source.resetSource();\r\n  let nextSource: RenderObject | null = null;\r\n  do {\r\n    nextSource = source.nextRenderable();\r\n    if (nextSource !== null) {\r\n      visitor(nextSource);\r\n    }\r\n  } while (nextSource !== null);\r\n}\r\n\r\nexport interface Size{\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\n\r\nconst copyShading = new Shading().decorate(new CopyShading());\r\nconst quad = new QuadSource();\r\n\r\nexport class RenderEngine implements GLReleasable{\r\n  constructor(el?: HTMLCanvasElement, ctxOptions?: any) {\r\n    this.renderer = new GLRenderer(el, ctxOptions);\r\n    // if we have a element param, use it as the default camera's param for convenience\r\n    if (el !== undefined) {\r\n      (this.camera as PerspectiveCamera).aspect = el.width / el.height;\r\n    }\r\n\r\n    this.interactor = new Interactor(el);\r\n\r\n    InnerUniformMap.forEach((des, key) => {\r\n      this.globalUniforms.set(key, new UniformProxy(des.default))\r\n    })\r\n    \r\n    this.preferVAO = true;\r\n  }\r\n\r\n  readonly interactor: Interactor\r\n\r\n  readonly renderer: GLRenderer;\r\n\r\n  _preferVAO: boolean = true;\r\n  _vaoEnabled: boolean = false;\r\n  get vaoEnabled(): boolean { return this._vaoEnabled };\r\n  get preferVAO(): boolean { return this._preferVAO };\r\n  set preferVAO(val: boolean) {\r\n    this._preferVAO = val;\r\n    if (val) {\r\n      if (!this.renderer.vaoManager.isSupported) {\r\n        console.warn(`prefer vao is set to true, but your environment cant support vao, vaoEnabled is false`)\r\n      }\r\n      this._vaoEnabled = true\r\n    } else {\r\n      this.renderer.vaoManager.releaseGL();\r\n      this._vaoEnabled = false\r\n    }\r\n  }\r\n\r\n  // resize\r\n  readonly resizeObservable: Observable<Size> = new Observable<Size>();\r\n  setSize(width:number, height: number) {\r\n    if (this.renderer.setSize(width, height)) {\r\n      this.resizeObservable.notifyObservers({\r\n        width, height\r\n      })\r\n    }\r\n  }\r\n  setActualSize(width: number, height: number) {\r\n    if (this.renderer.setRawRenderSize(width, height)) {\r\n      this.resizeObservable.notifyObservers({\r\n        width, height\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  public overrideShading: Nullable<Shading> = null;\r\n  public defaultTechnique: Shading = new Shading().decorate(new NormalShading());\r\n\r\n  ////\r\n\r\n\r\n\r\n\r\n  //// camera related\r\n  _camera: Camera = new PerspectiveCamera();\r\n  public isCameraChanged = true;\r\n  get camera() { return this._camera };\r\n  set camera(camera) {\r\n    this._camera = camera;\r\n    this.isCameraChanged = true;\r\n  };\r\n  private cameraMatrixReverse = new Matrix4();\r\n  private ProjectionMatrix = new Matrix4();\r\n  private VPMatrix = new Matrix4();\r\n  private LastVPMatrix = new Matrix4();\r\n\r\n  private jitterPMatrix = new Matrix4();\r\n  private jitterVPMatrix = new Matrix4();\r\n\r\n  jitterProjectionMatrix() {\r\n    this.jitterPMatrix.copy(this.ProjectionMatrix);\r\n    this.jitterPMatrix.elements[8] += ((2 * Math.random() - 1) / this.renderer.width);\r\n    this.jitterPMatrix.elements[9] += ((2 * Math.random() - 1) / this.renderer.height);\r\n    this.jitterVPMatrix.multiplyMatrices(this.jitterPMatrix, this.cameraMatrixReverse);\r\n    this.getGlobalUniform(InnerSupportUniform.VPMatrix).setValue(this.jitterVPMatrix);\r\n  }\r\n\r\n  unJit() {\r\n    this.getGlobalUniform(InnerSupportUniform.VPMatrix).setValue(this.VPMatrix);\r\n  }\r\n\r\n  /**\r\n   * call this to update engine layer camera related render info\r\n   * such as matrix global uniform.\r\n   *\r\n   * @memberof RenderEngine\r\n   */\r\n  connectCamera() {\r\n    let needUpdateVP = false;\r\n    // \r\n    if (this.camera.projectionMatrixNeedUpdate) {\r\n      this.camera.updateProjectionMatrix();\r\n      this.ProjectionMatrix.copy(this.camera.projectionMatrix);\r\n      needUpdateVP = true;\r\n    }\r\n    if (this.camera.transform.transformFrameChanged) {\r\n      this.camera.transform.matrix;\r\n      this.camera.updateWorldMatrix(true);\r\n      this.cameraMatrixReverse.getInverse(this.camera.worldMatrix, true);\r\n      needUpdateVP = true;\r\n    }\r\n\r\n    this.LastVPMatrix.copy(this.VPMatrix);\r\n    this.getGlobalUniform(InnerSupportUniform.LastVPMatrix).setValue(this.LastVPMatrix);\r\n\r\n    if (needUpdateVP) {\r\n      this.VPMatrix.multiplyMatrices(this.ProjectionMatrix, this.cameraMatrixReverse);\r\n      this.getGlobalUniform(InnerSupportUniform.VPMatrix).setValue(this.VPMatrix);\r\n      needUpdateVP = false;\r\n      this.isCameraChanged = true;\r\n    } else {\r\n      this.isCameraChanged = false;\r\n    }\r\n   \r\n  }\r\n  ////\r\n\r\n\r\n\r\n\r\n  //// render APIs\r\n  // render renderList from given source\r\n  render(source: RenderSource) {\r\n    foreachRenderableInSource(source, (obj) => {\r\n      this.renderObject(obj);\r\n    })\r\n  }\r\n\r\n  renderObject(object: RenderObject) {\r\n\r\n    // prepare technique\r\n    const program = this.connectShading(object);\r\n\r\n    // prepare material\r\n    this.connectMaterial(object.material, program);\r\n\r\n    // prepare geometry\r\n    this.connectGeometry(object.geometry, program);\r\n\r\n    this.connectRange(object.range, program, object.geometry)\r\n\r\n    object.state.syncGL(this.renderer)\r\n\r\n    // render\r\n    this.renderer.draw(object.drawMode);\r\n  }\r\n\r\n  renderFrameBuffer(framebuffer: GLFramebuffer, debugViewPort: Vector4) {\r\n    this.renderer.setRenderTargetScreen();\r\n    this.renderer.state.setViewport(\r\n      debugViewPort.x, debugViewPort.y,\r\n      debugViewPort.z, debugViewPort.w\r\n    );\r\n\r\n    this.overrideShading = copyShading;\r\n    this.overrideShading.getProgram(this).defineFrameBufferTextureDep(\r\n      framebuffer.name, 'copySource'\r\n    );\r\n    this.render(quad);\r\n    this.overrideShading = null;\r\n  }\r\n  ////\r\n\r\n\r\n\r\n\r\n  //// low level resource binding\r\n\r\n  /**\r\n   * GlobalUniforms is store useful inner support uniforms\r\n   * Engine will update these values and auto bind them to\r\n   * program that you will draw as needed\r\n   *\r\n   * @private\r\n   * @type {Map<InnerSupportUniform, UniformProxy>}\r\n   * @memberof RenderEngine\r\n   */\r\n  private globalUniforms: Map<InnerSupportUniform, UniformProxy> = new Map();\r\n  getGlobalUniform(uniform: InnerSupportUniform): UniformProxy {\r\n    return this.globalUniforms.get(uniform) as UniformProxy \r\n  }\r\n\r\n  private lastUploadedShaderUniformProvider: Set<ShaderUniformProvider> = new Set();\r\n  private lastProgramRendered: GLProgram;\r\n\r\n\r\n  private connectShading(object: RenderObject): GLProgram {\r\n\r\n    // // get shading, check override, default situation\r\n    let shading: Shading;\r\n    if (this.overrideShading !== null) {\r\n      shading = this.overrideShading;\r\n    } else if (object.shading !== undefined) {\r\n      shading = object.shading;\r\n    } else {\r\n      shading = this.defaultTechnique;\r\n    }\r\n\r\n    // get program, refresh provider cache if changed\r\n    const program = shading.getProgram(this);\r\n    if (this.lastProgramRendered !== program) {\r\n      this.lastUploadedShaderUniformProvider.clear();\r\n    }\r\n\r\n    this.renderer.useProgram(program);\r\n\r\n    this.getGlobalUniform(InnerSupportUniform.MMatrix).setValue(object.worldMatrix);\r\n    program.updateInnerGlobalUniforms(this); // TODO maybe minor optimize here\r\n\r\n    shading._decorators.forEach(decorator => {\r\n      decorator.foreachProvider(provider => {\r\n        if (this.lastUploadedShaderUniformProvider.has(provider)\r\n          && !provider.hasAnyUniformChanged\r\n        ) {\r\n          // if we found this uniform provider has updated before and not changed, we can skip!\r\n          return;\r\n        }\r\n        provider.uniforms.forEach((value, key) => {\r\n          program.setUniformIfExist(key, value); // maybe user defined, but not really in shader\r\n        })\r\n        provider.hasAnyUniformChanged = false;\r\n        this.lastUploadedShaderUniformProvider.add(provider);\r\n      })\r\n    })\r\n\r\n    return program;\r\n  }\r\n\r\n  private connectMaterial(material: Material, program: GLProgram) {\r\n\r\n    program.forTextures((tex: GLTextureUniform) => {\r\n      let glTexture: WebGLTexture | undefined;\r\n\r\n      // acquire texture from material\r\n      if (material !== undefined) {\r\n        if (tex.channel === undefined) {\r\n          throw 'use texture in material / use material to render should set texture uniform channel type'\r\n        }\r\n        const texture = material.getChannelTexture(tex.channel);\r\n        glTexture = texture.getGLTexture(this);\r\n      } \r\n\r\n      // acquire texture from framebuffer\r\n      if (glTexture === undefined) {\r\n        const framebufferName = program.framebufferTextureMap[tex.name];\r\n        if (framebufferName === undefined) {\r\n          throw  `cant find framebuffer for tex ${tex.name}, please define before use`\r\n        }\r\n        glTexture = this.renderer.framebufferManager.getFramebufferTexture(framebufferName);\r\n      }\r\n\r\n      if (glTexture === undefined) {\r\n        throw 'texture bind failed'\r\n      }\r\n      \r\n      tex.useTexture(glTexture);\r\n    })\r\n  }\r\n\r\n  private connectGeometry(geometry: Geometry, program: GLProgram) {\r\n    \r\n    // check index buffer and update program.indexUINT\r\n    if (program.useIndexDraw) {\r\n      if (geometry.indexBuffer === null) {\r\n        throw 'indexBuffer not found for index draw'\r\n      }\r\n      const geometryIndexBuffer = geometry.indexBuffer;\r\n      if (geometryIndexBuffer.data instanceof Uint32Array) {\r\n        program.indexUINT = true;\r\n      } else {\r\n        program.indexUINT = false;\r\n      }\r\n    }\r\n\r\n    // vao check\r\n    let vaoUnbindCallback: VAOCreateCallback;\r\n    if (this._vaoEnabled) {\r\n      const vaoManager = this.renderer.vaoManager;\r\n      const webglVAO = vaoManager.getVAO(geometry)\r\n      if (webglVAO === undefined && geometry.checkBufferArrayChange()) {\r\n        vaoManager.deleteVAO(geometry);\r\n        vaoUnbindCallback = vaoManager.createVAO(geometry);\r\n      } else {\r\n        vaoManager.useVAO(webglVAO)\r\n        return;\r\n      }\r\n    }\r\n\r\n    // common procedure\r\n    program.forAttributes(att => {\r\n      const bufferData = geometry.getBuffer(att.name);\r\n      if (bufferData === undefined) {\r\n        throw `program needs an attribute named ${att.name}, but cant find in geometry data`;\r\n      }\r\n      let glBuffer = this.getGLAttributeBuffer(bufferData);\r\n      if (glBuffer === undefined && bufferData.dataChanged) {\r\n        glBuffer = this.createOrUpdateAttributeBuffer(bufferData, false);\r\n        bufferData.dataChanged = false;\r\n      }\r\n      att.useBuffer(glBuffer);\r\n    })\r\n\r\n    if (program.useIndexDraw) {\r\n      const geometryIndexBuffer = geometry.indexBuffer;\r\n      let glBuffer = this.getGLAttributeBuffer(geometryIndexBuffer);\r\n      if (glBuffer === undefined) {\r\n        glBuffer = this.createOrUpdateAttributeBuffer(geometryIndexBuffer, true);\r\n      }\r\n      program.useIndexBuffer(glBuffer);\r\n    }\r\n\r\n    // create vao\r\n    if (this._vaoEnabled) {\r\n      if (vaoUnbindCallback !== undefined) {\r\n        vaoUnbindCallback.unbind();\r\n        geometry._markBufferArrayHasUpload();\r\n        this.renderer.vaoManager.useVAO(vaoUnbindCallback.vao)\r\n      }\r\n    }\r\n  }\r\n\r\n  private connectRange(range: RenderRange, program: GLProgram, geometry: Geometry) {\r\n    let start = 0;\r\n    let count = 0;\r\n    if (range === undefined) {\r\n      if (geometry.indexBuffer !== null) {\r\n        count = geometry.indexBuffer.data.length;\r\n      } else {\r\n        throw 'range should be set if use none index geometry'\r\n      }\r\n    } else {\r\n      start = range.start;\r\n      count = range.count;\r\n    }\r\n    program.drawFrom = start;\r\n    program.drawCount = count;\r\n  }\r\n\r\n\r\n\r\n  //  GL resource acquisition\r\n  private programShadingMap: Map<Shading, GLProgram> = new Map();\r\n  getProgram(shading: Shading): GLProgram {\r\n    return this.programShadingMap.get(shading);\r\n  }\r\n\r\n  createProgram(shading: Shading): GLProgram  {\r\n    const program = this.renderer.createProgram(shading.getProgramConfig());\r\n    this.programShadingMap.set(shading, program);\r\n    return program;\r\n  }\r\n\r\n  deleteProgram(shading: Shading) {\r\n    const program = this.programShadingMap.get(shading);\r\n    if (program !== undefined) {\r\n      program.dispose();\r\n      this.programShadingMap.delete(shading);\r\n    }\r\n  }\r\n\r\n  getGLAttributeBuffer(bufferData: BufferData): WebGLBuffer {\r\n    return this.renderer.attributeBufferManager.getGLBuffer(bufferData.data.buffer as ArrayBuffer);\r\n  }\r\n\r\n  createOrUpdateAttributeBuffer(bufferData: BufferData, useForIndex: boolean): WebGLBuffer {\r\n    return this.renderer.attributeBufferManager.updateOrCreateBuffer(bufferData.data.buffer as ArrayBuffer, useForIndex);\r\n  }\r\n\r\n\r\n\r\n  downloadCurrentRender() {\r\n    downloadCanvasPNGImage(this.renderer.el, 'artgl-renderscreenshot');\r\n  }\r\n\r\n  releaseGL() {\r\n    this.renderer.releaseGL();\r\n  }\r\n\r\n  dispose() {\r\n    this.resizeObservable.clear();\r\n    this.releaseGL();\r\n    this.interactor.dispose();\r\n  }\r\n\r\n\r\n}","export class Accumulator {\r\n  constructor(size?: number) {\r\n    this.size = size === undefined ? 10: size;\r\n    this.reset();\r\n  }\r\n  private size = 10;\r\n  private count = 0;\r\n  private records: number[] = [];\r\n\r\n  private all = 0;\r\n\r\n  get average() {\r\n    if (this.count >= this.size) {\r\n      return this.all / this.size;\r\n    } else {\r\n      return this.all / this.count;\r\n    }\r\n  }\r\n\r\n  get last() {\r\n    return  Math.max(0, this.count - this.size) % this.size;\r\n  }\r\n\r\n  push(record: number) {\r\n    this.count++;\r\n\r\n    const current = this.count % this.size;\r\n\r\n    this.all -= this.records[this.last];\r\n    this.all += record;\r\n    this.records[current] = record;\r\n\r\n  }\r\n\r\n  reset() {\r\n    this.count = 0;\r\n    this.all = 0;\r\n    this.records = [];\r\n    for (let i = 0; i < this.size; i++) {\r\n      this.records.push(0);\r\n    }\r\n  }\r\n\r\n  resetWithNewSize(size: number) {\r\n    this.size = size;\r\n    this.reset();\r\n  }\r\n\r\n}\r\n","import { Nullable } from \"../type\";\r\nimport { Accumulator } from \"../util/accumulator\";\r\n\r\n\r\n/**\r\n * Framer is for render schedules\r\n *\r\n * @export\r\n * @class Framer\r\n */\r\nexport class Framer{\r\n\r\n  avgRenderFrameTimeLast120Frame: Accumulator = new Accumulator(120)\r\n\r\n  private userRenderFrame: Nullable<FrameRequestCallback> = null;\r\n  setFrame(frame: FrameRequestCallback) {\r\n    this.userRenderFrame = frame;\r\n  }\r\n\r\n  private renderFrame: FrameRequestCallback = (time) => {\r\n    this.frameStart(time);\r\n    if (this.userRenderFrame !== null) {\r\n      this.userRenderFrame(time);\r\n    }\r\n    this.frameEnd(performance.now());\r\n    if (this.active) {\r\n      this.tickId = window.requestAnimationFrame(this.renderFrame);\r\n    }\r\n  }\r\n  \r\n  active = false;\r\n  private tickId?: number;\r\n\r\n  run() {\r\n    this.active = true;\r\n    this.tickId = window.requestAnimationFrame(this.renderFrame);\r\n  }\r\n\r\n  step() {\r\n    if (!this.active) {\r\n      this.renderFrame(performance.now());\r\n    }\r\n  }\r\n\r\n  stop() {\r\n    this.active = false;\r\n    if (this.tickId !== undefined) {\r\n      window.cancelAnimationFrame(this.tickId);\r\n    }\r\n  }\r\n\r\n  frameStartTime = 0;\r\n  private frameStart(frameStartTime: number) {\r\n    this.frameStartTime = frameStartTime;\r\n  }\r\n\r\n  private frameEnd(frameEndTime: number) {\r\n    this.avgRenderFrameTimeLast120Frame.push(frameEndTime - this.frameStartTime)\r\n  }\r\n  \r\n}","import { RenderObject } from \"../core/render-object\";\r\nimport { DrawMode } from \"../webgl/const\";\r\n\r\nexport class Line extends RenderObject{\r\n  constructor() {\r\n    super();\r\n    this.drawMode = DrawMode.LINES;\r\n  }\r\n\r\n}","import { RenderObject } from \"../core/render-object\";\r\nimport { DrawMode } from \"../webgl/const\";\r\n\r\nexport class Points extends RenderObject{\r\n  constructor() {\r\n    super();\r\n    this.drawMode = DrawMode.POINTS\r\n  }\r\n\r\n}","import { Texture, DataTexture } from \"./texture\";\r\nimport { generateUUID } from \"../math/uuid\";\r\nimport { Vector3 } from \"../math/index\";\r\n\r\nexport const enum ChannelType{\r\n  diffuse = 'diffuse',\r\n  roughness = 'roughness',\r\n  metallic = 'metallic',\r\n  ao = 'ao'\r\n}\r\n\r\n\r\n/**\r\n * Material is collection of textures\r\n * contains bitmap render data\r\n * @export\r\n * @class Material\r\n */\r\nexport class Material{\r\n\r\n  uuid = generateUUID();\r\n  private channels: Map<ChannelType, Texture> = new Map();\r\n\r\n  setChannelColor(channel: ChannelType, color: Vector3) {\r\n    let channelTexture = this.channels.get(channel);\r\n    if (channelTexture === undefined) {\r\n      channelTexture = generateTextureToPureColor(color);\r\n    } else {\r\n      updateTextureToPureColor(channelTexture, color);\r\n    }\r\n  }\r\n\r\n  setChannelTexture(channel: ChannelType, texture: Texture) {\r\n    this.channels.set(channel, texture);\r\n  }\r\n\r\n  getChannelTexture(type: ChannelType): Texture {\r\n    const texture = this.channels.get(type);\r\n    if (texture === undefined) {\r\n      throw 'cant get channel texture'\r\n    }\r\n    return texture;\r\n  }\r\n\r\n}\r\n\r\nfunction generateTextureToPureColor(color: Vector3): Texture {\r\n  const texture = new DataTexture(); \r\n  const R = Math.floor(color.x * 256);\r\n  const G = Math.floor(color.y * 256);\r\n  const B = Math.floor(color.z * 256);\r\n  texture.data = new Uint8ClampedArray([\r\n    R, G, B, R, G, B, R, G, B, R, G, B, \r\n  ]);\r\n  return texture;\r\n}\r\n\r\nfunction updateTextureToPureColor(texture: Texture, color: Vector3): Texture {\r\n  return texture;\r\n}","import { Vector4 } from \"../math/vector4\";\r\nimport { Nullable } from \"../type\";\r\nimport { RenderSource } from \"../engine/render-engine\";\r\nimport { PixelFormat } from \"../webgl/const\";\r\nimport { Shading } from \"../core/shading\";\r\nexport interface GraphDefine {\r\n  passes: PassDefine[],\r\n  renderTargets: RenderTargetDefine[];\r\n}\r\n\r\nexport interface PassInputMapInfo{\r\n  [index:string]: string\r\n}\r\n\r\nexport interface PassDefine {\r\n  name: string,\r\n  inputs?: () => PassInputMapInfo,\r\n  source: RenderSource[],\r\n  filter?: () => boolean,\r\n  sorter?: () => number,\r\n  states?: stateType[],\r\n  shading?: Shading,\r\n  enableColorClear?:boolean,\r\n  enableDepthClear?:boolean,\r\n  clearColor?: Vector4,\r\n  afterPassExecute?: () => any,\r\n  beforePassExecute?: () => any,\r\n}\r\n\r\nexport enum DimensionType {\r\n  bindRenderSize,\r\n  fixed\r\n}\r\n\r\nexport interface RenderTargetDefine {\r\n  name: string,\r\n  from: () => Nullable<string>\r\n  format?: {\r\n    pixelFormat: PixelFormat,\r\n    dimensionType: DimensionType,\r\n    width?: number,\r\n    height?: number,\r\n    disableDepthBuffer?: boolean\r\n  }\r\n}\r\n\r\nexport interface SourceDefine {\r\n  name: string,\r\n  from: string,\r\n  filter?: () => boolean,\r\n  transformer?: () => void,\r\n  sorter?: () => number,\r\n}\r\n\r\nenum stateType {\r\n  DisableColorWrite,\r\n  DisableAlphaWrite\r\n}\r\n","import { RenderObject } from \"../core/render-object\";\r\nimport { Nullable } from \"../type\";\r\n\r\nexport class RenderList {\r\n\r\n  private list: Nullable<RenderObject>[] = [];\r\n  private realLength: number = 0;\r\n\r\n  public addRenderItem(object: RenderObject) {\r\n    if (this.realLength < this.list.length) {\r\n      this.list[this.realLength] = object;\r\n    } else {\r\n      this.list.push(object);\r\n    }\r\n    this.realLength++;\r\n  }\r\n\r\n  forEach(visitor: (object: RenderObject) => any) {\r\n    for (let i = 0; i < this.realLength; i++) {\r\n      visitor(this.list[i] as RenderObject);\r\n    }\r\n  }\r\n\r\n  renderListCursor: number = 0;\r\n  next() {\r\n    if (this.renderListCursor >= this.list.length) {\r\n      return null;\r\n    }\r\n    const item = this.list[this.renderListCursor];\r\n    this.renderListCursor++;\r\n    return item\r\n  }\r\n\r\n  reset() {\r\n    this.realLength = 0;\r\n  }\r\n\r\n  resetCursor() {\r\n    this.renderListCursor = 0;\r\n  }\r\n\r\n  clear() {\r\n    this.list = [];\r\n  }\r\n\r\n  sort(){\r\n    \r\n  }\r\n\r\n\r\n}","import { SceneNode } from \"./scene-node\";\r\nimport { RenderObject } from \"../core/render-object\";\r\nimport { RenderSource } from \"../engine/render-engine\";\r\nimport { RenderList } from \"../engine/render-list\";\r\nimport { GeometryLoader } from \"../core/loader\";\r\n\r\n/**\r\n * scene data management\r\n * contains full scene tree, and other scene data\r\n * also responsible for list structure cache for performance\r\n * @export\r\n * @class Scene\r\n */\r\nexport class Scene implements RenderSource {\r\n  root: SceneNode = new SceneNode();\r\n  \r\n\r\n  objectList: RenderList = new RenderList();\r\n  // mark scene structure changed between frame render\r\n  isFrameStructureChange: boolean = true;\r\n  isFrameTransformChange: boolean = true;\r\n  isFrameVisibleChange: boolean = true;\r\n  get isFrameChange(){\r\n    return this.isFrameStructureChange || this.isFrameTransformChange || this.isFrameVisibleChange\r\n  }\r\n  onRemoveList: Set<SceneNode> = new Set();\r\n  onAddList: Set<SceneNode> = new Set();\r\n\r\n  addNode(object: SceneNode) {\r\n    this.onRemoveList.delete(object);\r\n    this.onAddList.add(object);\r\n    this.isFrameStructureChange = true;\r\n  }\r\n\r\n  removeNode(object: SceneNode) {\r\n    this.onAddList.delete(object);\r\n    this.onRemoveList.add(object);\r\n    this.isFrameStructureChange = true;\r\n  }\r\n\r\n  updateSource() {\r\n    if (this.isFrameStructureChange) {\r\n      this.updateObjectList();\r\n    }\r\n  }\r\n\r\n  resetSource() {\r\n    this.objectList.resetCursor();\r\n  }\r\n\r\n  nextRenderable() {\r\n    return this.objectList.next();\r\n  }\r\n\r\n  updateObjectList() { \r\n    // TODO optimize\r\n    this.objectList.reset();\r\n    this.onRemoveList.clear();\r\n    this.onAddList.clear();\r\n    this.root.traverse((node) => {\r\n      node.scene = this;\r\n      if (this.isFrameStructureChange || this.isFrameTransformChange) {\r\n        if (node.parent !== null) {\r\n          node._worldMatrix.multiplyMatrices(node.parent._worldMatrix, node.transform.matrix);\r\n        } else {\r\n          node._worldMatrix.copy(node.transform.matrix);\r\n        }\r\n      }\r\n      if (node instanceof RenderObject) {\r\n        this.objectList.addRenderItem(node);\r\n      }\r\n    });\r\n    this.isFrameStructureChange = false;\r\n    this.isFrameTransformChange = false;\r\n    this.isFrameVisibleChange = false;\r\n\r\n  }\r\n\r\n  updateWorldMatrix() {\r\n    this.root.updateWorldMatrix(true);\r\n  }\r\n\r\n  setRootNode(node: SceneNode) {\r\n    if (node.scene) {\r\n      throw 'node has set to scene, abort';\r\n    }\r\n    this.root = node;\r\n    this.isFrameStructureChange = true;\r\n  }\r\n\r\n  disposeRootNode() {\r\n    if (!this.root) {\r\n      throw 'scene hasn\\'t root';\r\n    }\r\n    this.root.traverse((node) => {\r\n      node.scene = null;\r\n    });\r\n    this.root = null;\r\n  }\r\n\r\n  registGeometryLoader(loader: GeometryLoader) {\r\n    \r\n  }\r\n\r\n}","import { GLFramebuffer } from \"../webgl/gl-framebuffer\";\r\nimport { RenderEngine } from \"../engine/render-engine\";\r\nimport { RenderGraph } from \"./render-graph\";\r\nimport { PassDefine, PassInputMapInfo } from \"./interface\";\r\nimport { RenderTargetNode } from \"./node/render-target-node\";\r\nimport { Vector4 } from \"../math/vector4\";\r\nimport { Nullable } from \"../type\";\r\nimport { Shading } from \"../core/shading\";\r\n\r\nexport class RenderPass{\r\n  constructor(define: PassDefine) {\r\n    this.define = define;\r\n    this.name = define.name;\r\n    if (define.shading !== undefined) {\r\n      const overrideShading = define.shading;\r\n      if (overrideShading === undefined) {\r\n        throw `technique '${define.shading}' not defined`\r\n      }\r\n      this.overrideShading = overrideShading;\r\n    }\r\n\r\n    this.clearColor = define.clearColor;\r\n    this.enableColorClear = define.enableColorClear === undefined ? true : define.enableColorClear\r\n    this.enableDepthClear = define.enableDepthClear === undefined ? true : define.enableDepthClear\r\n\r\n    this.beforePassExecute = define.beforePassExecute;\r\n    this.afterPassExecute = define.afterPassExecute;\r\n\r\n  }\r\n\r\n  updateInputTargets(inputs: PassInputMapInfo) {\r\n    this.inputTarget.clear();\r\n    Object.keys(inputs).forEach(inputKey => {\r\n      const mapTo = inputs[inputKey];\r\n      this.inputTarget.set(inputKey, mapTo)\r\n    })\r\n  }\r\n\r\n  readonly define: PassDefine;\r\n  public name: string;\r\n\r\n  private clearColor: Vector4;\r\n  private enableDepthClear: boolean = true;\r\n  private enableColorClear: boolean = true;\r\n\r\n  private afterPassExecute?: () => any;\r\n  private beforePassExecute?: () => any;\r\n  \r\n  private overrideShading: Nullable<Shading> = null;\r\n\r\n  // key: uniformName ;   value: inputFramebufferName\r\n  private inputTarget: Map<string, string> = new Map();\r\n  private outputTarget: GLFramebuffer\r\n\r\n\r\n  setOutPutTarget(engine: RenderEngine, renderTargetNode: RenderTargetNode) {\r\n    if (renderTargetNode.name === RenderGraph.screenRoot) {\r\n      this.outputTarget = undefined;\r\n      this.isOutputScreen = true;\r\n    } else {\r\n      this.outputTarget = renderTargetNode.getOrCreateFrameBuffer(engine);\r\n      this.isOutputScreen = false;\r\n    }\r\n  }\r\n  private isOutputScreen: boolean = true;\r\n\r\n  renderDebugResult(engine: RenderEngine, graph: RenderGraph) {\r\n    const debugOutputViewport = graph.renderTargetNodes.get(this.outputTarget.name).debugViewPort;\r\n    engine.renderFrameBuffer(this.outputTarget, debugOutputViewport)\r\n    // this will cause no use draw TODO optimize\r\n    this.inputTarget.forEach((inputFramebufferName, _uniformName) => {\r\n      const framebuffer = engine.renderer.framebufferManager.getFramebuffer(inputFramebufferName);\r\n      const debugInputViewport = graph.renderTargetNodes.get(framebuffer.name).debugViewPort;\r\n      engine.renderFrameBuffer(framebuffer, debugInputViewport)\r\n    })\r\n  } \r\n\r\n  execute(engine: RenderEngine, graph: RenderGraph) {\r\n\r\n    // setup viewport and render target\r\n    if (this.isOutputScreen) {\r\n      engine.renderer.setRenderTargetScreen();\r\n      if (graph.enableDebuggingView) {\r\n        const debugViewPort = graph.screenNode.debugViewPort;\r\n        engine.renderer.state.setViewport(\r\n          debugViewPort.x, debugViewPort.y,\r\n          debugViewPort.z, debugViewPort.w\r\n        );\r\n\r\n      } else {\r\n        engine.renderer.state.setFullScreenViewPort();\r\n      }\r\n    } else {\r\n      engine.renderer.setRenderTarget(this.outputTarget);\r\n      engine.renderer.state.setViewport(0, 0, this.outputTarget.width, this.outputTarget.height);\r\n    }\r\n  \r\n    // input binding \r\n    if (this.overrideShading !== null) {\r\n      engine.overrideShading = this.overrideShading;\r\n      this.inputTarget.forEach((inputFramebufferName, uniformName) => {\r\n        (engine.overrideShading as Shading).getProgram(engine).defineFrameBufferTextureDep(\r\n          inputFramebufferName, uniformName\r\n        );\r\n      })\r\n    }\r\n\r\n    // clear setting\r\n    if (this.enableColorClear) {\r\n      if (this.clearColor !== undefined) {\r\n        engine.renderer.state.colorbuffer.setClearColor(this.clearColor);\r\n      }\r\n      engine.renderer.state.colorbuffer.clear();\r\n    }\r\n    if (this.enableDepthClear) {\r\n      if (!this.isOutputScreen && this.outputTarget.enableDepth) {\r\n        engine.renderer.state.depthbuffer.clear();\r\n      }\r\n    }\r\n\r\n    if (this.beforePassExecute !== undefined) {\r\n      this.beforePassExecute();\r\n    }\r\n\r\n    //////  render //////\r\n    this.define.source.forEach(source => {\r\n      engine.render(source);\r\n    })\r\n    /////////////////////\r\n\r\n    if (this.afterPassExecute !== undefined) {\r\n      this.afterPassExecute();\r\n    }\r\n\r\n    engine.overrideShading = null;\r\n    engine.renderer.state.colorbuffer.resetDefaultClearColor();\r\n\r\n\r\n    if (graph.enableDebuggingView && !this.isOutputScreen) {\r\n      this.renderDebugResult(engine, graph);\r\n    }\r\n\r\n  }\r\n\r\n  checkIsValid() {\r\n    if (this.isOutputScreen) {\r\n      return\r\n    }\r\n    const target = this.outputTarget.name;\r\n    this.inputTarget.forEach(input => {\r\n      if (input === target) {\r\n        throw `you cant output to the render target which is depend on: \r\nDuplicate target: ${this.outputTarget.name};`\r\n      }\r\n    })\r\n  }\r\n}","import { PassDefine, GraphDefine, RenderTargetDefine } from \"./interface\";\r\nimport { PassGraphNode } from \"./node/pass-graph-node\";\r\nimport { RenderTargetNode } from \"./node/render-target-node\";\r\nimport { RenderEngine } from \"../engine/render-engine\";\r\nimport { QuadSource } from './quad-source';\r\nimport { RenderPass } from \"./pass\";\r\n\r\n\r\nexport type RenderGraphNode = PassGraphNode | RenderTargetNode;\r\n\r\nexport class EffectComposer {\r\n\r\n  private passes: RenderPass[] = [];\r\n  private nodeMap: Map<PassGraphNode, RenderPass> = new Map();\r\n\r\n  render(engine: RenderEngine, graph: RenderGraph) {\r\n    this.passes.forEach(pass => {\r\n      pass.execute(engine, graph);\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.passes = [];\r\n  }\r\n\r\n  addPass(pass: RenderPass) {\r\n    this.passes.push(pass);\r\n  }\r\n\r\n  registerNode(node: PassGraphNode, define: PassDefine ) {\r\n    const pass = new RenderPass(define)\r\n    this.nodeMap.set(node, pass);\r\n  }\r\n\r\n  clear() {\r\n    this.passes = [];\r\n    this.nodeMap.clear();\r\n  }\r\n\r\n  getPass(node: PassGraphNode): RenderPass {\r\n    return this.nodeMap.get(node);\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\nexport class RenderGraph {\r\n\r\n  static screenRoot: string = 'artgl-rendergraph-screen-rt';\r\n  static quadSource = new QuadSource();\r\n\r\n  enableDebuggingView: boolean = false;\r\n\r\n  screenNode: RenderTargetNode;\r\n  renderTargetNodes: Map<string, RenderTargetNode> = new Map();\r\n  passNodes: Map<string, PassGraphNode> = new Map();\r\n\r\n  get nodes() {\r\n    const nodes = [];\r\n    this.passNodes.forEach(node => {\r\n      nodes.push(node);\r\n    })\r\n    this.renderTargetNodes.forEach(node => {\r\n      nodes.push(node);\r\n    })\r\n    return nodes;\r\n  }\r\n\r\n  /**\r\n   * Clear the graph pass info as needed\r\n   *\r\n   * @memberof RenderGraph\r\n   */\r\n  reset() {\r\n    this.renderTargetNodes.clear();\r\n    this.passNodes.clear();\r\n  }\r\n\r\n  /**\r\n   * Setup a new Graph configuration\r\n   *\r\n   * @param {GraphDefine} graphDefine\r\n   * @memberof RenderGraph\r\n   */\r\n  defineGraph(composer: EffectComposer, graphDefine: GraphDefine): void {\r\n    this.reset();\r\n    this.allocateRenderTargetNodes(graphDefine.renderTargets);\r\n    this.constructPassGraph(graphDefine.passes, composer);\r\n  }\r\n\r\n  /**\r\n   * Update the pass queue from current graph configure\r\n   *\r\n   * @memberof RenderGraph\r\n   */\r\n  update(engine: RenderEngine, composer: EffectComposer) {\r\n    \r\n    //updateNodesConnection\r\n    this.passNodes.forEach(node => {\r\n      node.updateDependNode(this);\r\n    });\r\n    this.renderTargetNodes.forEach(node => {\r\n      node.updateDependNode(this);\r\n    });\r\n\r\n    // update pass queue\r\n    const nodeQueue = this.screenNode.generateDependencyOrderList() as RenderGraphNode[];\r\n    composer.reset();\r\n    nodeQueue.forEach(node => {\r\n      if (node instanceof RenderTargetNode) {\r\n        node.updateSize(engine);\r\n      }\r\n    })\r\n    nodeQueue.forEach(node => {\r\n      if (node instanceof PassGraphNode) {\r\n        const pass = composer.getPass(node);\r\n        if (pass === undefined) {\r\n          throw \"err\" // TODO\r\n        }\r\n        node.updatePass(engine, pass, nodeQueue);\r\n        composer.addPass(pass);\r\n      }\r\n    })\r\n  }\r\n\r\n  private constructPassGraph(passesDefine: PassDefine[], composer: EffectComposer) {\r\n    passesDefine.forEach(define => {\r\n      if (!this.passNodes.has(define.name)) {\r\n        const node = new PassGraphNode(this, define);\r\n        this.passNodes.set(define.name, node);\r\n        composer.registerNode(node, define);\r\n      } else {\r\n        throw 'duplicate pass define found'\r\n      }\r\n    })\r\n  }\r\n\r\n  getRenderTargetDependence(name: string): RenderTargetNode {\r\n    return this.renderTargetNodes.get(name);\r\n  }\r\n\r\n  getRenderPassDependence(name: string): PassGraphNode {\r\n    return this.passNodes.get(name);\r\n  }\r\n\r\n  getRootScreenTargetNode() {\r\n    let screenNode;\r\n    this.renderTargetNodes.forEach(node => {\r\n      if (node.isScreenNode) {\r\n        screenNode = node;\r\n      }\r\n    })\r\n    return screenNode;\r\n  }\r\n\r\n  private allocateRenderTargetNodes(textsDefine: RenderTargetDefine[]) {\r\n    textsDefine.forEach(define => {\r\n      if (this.renderTargetNodes.has(define.name)) {\r\n        throw 'render graph build error, duplicate texture key name found '\r\n      }\r\n      const renderTargetNode = new RenderTargetNode(define);\r\n      if (define.name === RenderGraph.screenRoot) {\r\n        if (this.screenNode !== undefined) {\r\n          throw \"duplicate screen root node\"\r\n        }\r\n        this.screenNode = renderTargetNode\r\n      }\r\n      this.renderTargetNodes.set(define.name, renderTargetNode);\r\n    })\r\n\r\n    if (this.screenNode === undefined) {\r\n      throw \"screen root not found\"\r\n    }\r\n  }\r\n\r\n}","import { DAGNode } from \"../../core/dag-node\";\r\nimport { RenderTargetDefine, DimensionType } from \"../interface\";\r\nimport { RenderGraph } from \"../render-graph\";\r\nimport { GLFramebuffer } from \"../../webgl/gl-framebuffer\";\r\nimport { MathUtil } from '../../math/util'\r\nimport { RenderEngine } from \"../../engine/render-engine\";\r\nimport { Nullable } from \"../../type\";\r\nimport { Vector4 } from '../../math/vector4';\r\nimport { PixelFormat } from \"../../webgl/const\";\r\n\r\nexport class RenderTargetNode extends DAGNode{\r\n  constructor(define: RenderTargetDefine) {\r\n    super();\r\n    this.name = define.name;\r\n    this.define = define;\r\n\r\n    this.fromGetter = define.from;\r\n\r\n    this.isScreenNode = define.name === RenderGraph.screenRoot;\r\n    if (this.isScreenNode) {\r\n      return\r\n    }\r\n\r\n    // set a default format config\r\n    if (define.format === undefined) {\r\n      define.format = {\r\n        pixelFormat: PixelFormat.RGBA,\r\n        dimensionType: DimensionType.bindRenderSize,\r\n      }\r\n    }\r\n\r\n    if (define.format.dimensionType === DimensionType.bindRenderSize) {\r\n      this.autoWidthRatio = define.format.width !== undefined ? MathUtil.clamp(define.format.width, 0, 1) : 1;\r\n      this.autoHeightRatio = define.format.height !== undefined ? MathUtil.clamp(define.format.height, 0, 1) : 1;\r\n    }\r\n    this.enableDepth = define.format.disableDepthBuffer !== undefined ? define.format.disableDepthBuffer : true;\r\n    \r\n  }\r\n  readonly isScreenNode: boolean;\r\n  readonly name: string;\r\n  readonly define: RenderTargetDefine;\r\n\r\n  debugViewPort: Vector4 = new Vector4(0, 0, 200, 200);\r\n\r\n  autoWidthRatio: number = 0;\r\n  autoHeightRatio: number = 0;\r\n  enableDepth: boolean = true;\r\n\r\n  widthAbs: number = 0;\r\n  heightAbs: number = 0;\r\n\r\n  private fromGetter: () => Nullable<string>\r\n  private from: string = null;\r\n\r\n  getOrCreateFrameBuffer(engine: RenderEngine): GLFramebuffer {\r\n    const f = engine.renderer.framebufferManager.getFramebuffer(this.name);\r\n    if (f) {\r\n      return f\r\n    } else {\r\n      return engine.renderer.framebufferManager.createFrameBuffer(\r\n        engine, this.name, this.widthAbs, this.heightAbs, this.enableDepth);\r\n    }\r\n  }\r\n\r\n  updateSize(engine: RenderEngine) {\r\n    if (this.isScreenNode) {\r\n      return;\r\n    }\r\n    const define = this.define;\r\n    let width: number;\r\n    let height: number;\r\n    // decide initial size and create resize observer\r\n    if (define.format.dimensionType === DimensionType.fixed) {\r\n      width = define.format.width !== undefined ? define.format.width : engine.renderer.width;\r\n      height = define.format.height !== undefined ? define.format.height : engine.renderer.height;\r\n    } else { //  === DimensionType.bindRenderSize\r\n      width = Math.max(5, engine.renderer.width * this.autoWidthRatio);\r\n      height = Math.max(5, engine.renderer.height * this.autoHeightRatio);\r\n    }\r\n    this.widthAbs = Math.max(5, width);\r\n    this.heightAbs = Math.max(5, height);\r\n    \r\n    this.getOrCreateFrameBuffer(engine).resize(engine, width, height);\r\n  }\r\n\r\n  updateDependNode(graph: RenderGraph) {\r\n    \r\n    // disconnect depends pass node\r\n    this.clearAllFrom();\r\n\r\n    this.from = this.fromGetter();\r\n\r\n    if (this.from !== null) {\r\n      const passNode = graph.getRenderPassDependence(this.from);\r\n      passNode.connectTo(this);\r\n    }\r\n    \r\n  }\r\n\r\n}","import { DAGNode } from \"../../core/dag-node\";\r\nimport { PassDefine, PassInputMapInfo } from \"../interface\";\r\nimport { RenderGraph, RenderGraphNode } from \"../render-graph\";\r\nimport { RenderPass } from \"../pass\";\r\nimport { RenderTargetNode } from './render-target-node';\r\nimport { Nullable } from \"../../type\";\r\nimport { RenderEngine } from \"../../engine/render-engine\";\r\n\r\nexport class PassGraphNode extends DAGNode {\r\n  constructor(graph: RenderGraph, define: PassDefine) {\r\n    super();\r\n    this.name = define.name;\r\n\r\n    if (define.inputs !== undefined) {\r\n      this.inputsGetter = define.inputs;\r\n    }\r\n\r\n  }\r\n  private inputsGetter: Nullable<() => PassInputMapInfo> = null\r\n  inputs: PassInputMapInfo = {}\r\n  readonly name: string;\r\n\r\n  updateDependNode(graph: RenderGraph) {\r\n    // disconnect all depends node \r\n    this.clearAllFrom();\r\n\r\n    // reval getter\r\n    if (this.inputsGetter !== null) {\r\n      this.inputs = this.inputsGetter();\r\n    }\r\n    const inputs = this.inputs;\r\n    // connect new depends node\r\n    Object.keys(inputs).forEach(inputUniformKey => {\r\n      const framebufferName = inputs[inputUniformKey]\r\n      const renderTargetNode = graph.getRenderTargetDependence(framebufferName);\r\n      if (renderTargetNode === undefined) {\r\n        throw `render graph updating error, renderTarget depend node ${framebufferName} cant found`;\r\n      }\r\n      renderTargetNode.connectTo(this);\r\n    })\r\n  }\r\n\r\n  updatePass(engine: RenderEngine, pass: RenderPass, activeNodes: RenderGraphNode[]) {\r\n    pass.updateInputTargets(this.inputs);\r\n    let foundedNode = null;\r\n    if (this.toNodes.size === 0) {\r\n      throw \"cant found render target node for a render pass\"\r\n    }\r\n    this.toNodes.forEach(node => {\r\n      if (node instanceof RenderTargetNode) {\r\n        for (let i = 0; i < activeNodes.length; i++) {\r\n          if (activeNodes[i] === node) {\r\n            if (foundedNode !== null) {\r\n              throw `RenderGraph update error: one target node should only has one pass targeted;\r\nprevious found target pass: ${foundedNode.name};\r\nnew found target pass: ${activeNodes[i].name};\r\n              `\r\n            }\r\n            foundedNode = node\r\n            pass.setOutPutTarget(engine, node);\r\n          }\r\n        }\r\n      }\r\n    })\r\n    pass.checkIsValid();\r\n  }\r\n\r\n}","import { BaseEffectShading } from \"../../core/shading\";\r\nimport { ShaderFunction } from \"../../shader-graph/shader-function\";\r\nimport { NormalFragVary, ShaderGraph } from \"../../shader-graph/shader-graph\";\r\n\r\nconst normalShading = new ShaderFunction({\r\n  source:\r\n    `vec4 normalShading(vec3 normal){\r\n      return vec4(normal * 0.5 + 0.5, 1.0);\r\n    }`\r\n})\r\n\r\nexport class NormalShading extends BaseEffectShading<NormalShading> {\r\n\r\n  decorate(graph: ShaderGraph): void {\r\n    graph\r\n      .setFragmentRoot(\r\n        normalShading.make().input(\"normal\", graph.getVary(NormalFragVary))\r\n      )\r\n  }\r\n\r\n}","import { ShaderFunction } from \"../shader-function\";\r\n\r\nexport const depthPack = new ShaderFunction({\r\n  description: 'pack depth to RGBA output',\r\n  source: `\r\n    vec4 depthPack(float frag_depth){\r\n      vec4 bitSh = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\r\n      vec4 bitMsk = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\r\n      vec4 enc = fract(frag_depth * bitSh);\r\n      enc -= enc.xxyz * bitMsk;\r\n      return enc;\r\n    }\r\n  `,\r\n})\r\n\r\nexport const unPackDepth = new ShaderFunction({\r\n  description: 'unpack depth from RGBA channel',\r\n  source: `\r\n  float UnpackDepth( vec4 enc ) {\r\n    const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\r\n    return dot( enc, bit_shift );\r\n}`\r\n})","import { ShaderFunction } from \"../shader-function\";\r\n\r\nexport const rand = new ShaderFunction({\r\n  source: `float rand(float n) {return fract(sin(n) * 43758.5453123);}`\r\n})\r\n\r\nexport const rand2D = new ShaderFunction({\r\n  source: `\r\n  float rand(vec2 cood){\r\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\r\n}\r\n  `\r\n})\r\n\r\nexport const rand2DT = new ShaderFunction({\r\n  source: `\r\n  float rand(vec2 cood, float t){\r\n    vec2 co = cood;\r\n    co.x = sin(t) + co.x;\r\n    co.y = cos(t) + co.y;\r\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\r\n}\r\n  `\r\n})\r\n","import { MapUniform, BaseEffectShading } from \"../../core/shading\";\r\nimport { InnerSupportUniform } from \"../../webgl/uniform/uniform\";\r\nimport { texture, innerUniform, screenQuad } from \"../../shader-graph/node-maker\";\r\nimport { ShaderFunction } from \"../../shader-graph/shader-function\";\r\nimport { unPackDepth } from \"../../shader-graph/built-in/depth-pack\";\r\nimport { dir3D } from \"../../shader-graph/built-in/transform\";\r\nimport { getWorldPosition, NDCxyToUV } from \"../../shader-graph/built-in/transform\";\r\nimport { Matrix4 } from \"../../math/index\";\r\nimport { rand2DT, rand } from \"../../shader-graph/built-in/rand\";\r\nimport { UvFragVary, ShaderGraph } from '../../shader-graph/shader-graph';\r\n\r\nconst newSamplePosition = new ShaderFunction({\r\n  source: `\r\n  vec3 newPosition(vec3 positionOld, float distance, vec3 dir, float rand){\r\n    return distance * rand * dir + positionOld;\r\n  }\r\n  `\r\n})\r\n\r\nconst NDCFromWorldPositionAndVPMatrix = new ShaderFunction({\r\n  source: `\r\n  vec3 depthFromWorldPositionAndVPMatrix(vec3 position, mat4 matrix){\r\n    vec4 ndc = matrix * vec4(position, 1.0);\r\n    ndc = ndc / ndc.w;\r\n    return ndc.xyz;\r\n  }\r\n  `\r\n})\r\n\r\nconst sampleAO = new ShaderFunction({\r\n  source: `\r\n  vec3 sampleAO(float depth, float newDepth){\r\n    if (depth >0.999){\r\n      return vec3(0.5);\r\n    }\r\n    float rate =  depth > newDepth ? 0.0 : 1.0;\r\n    return vec3(rate);\r\n  }\r\n  `\r\n})\r\n\r\nconst tssaoMix = new ShaderFunction({\r\n  source: `\r\n  vec4 tssaoMix(vec3 oldColor, vec3 newColor, float sampleCount){\r\n    return vec4((oldColor * sampleCount + newColor) / (sampleCount + 1.0), 1.0);\r\n  }\r\n  `\r\n})\r\n\r\nexport class TSSAOShading extends BaseEffectShading<TSSAOShading> {\r\n  \r\n  @MapUniform(\"u_sampleCount\")\r\n  sampleCount: number = 0;\r\n\r\n  @MapUniform(\"VPMatrixInverse\")\r\n  VPMatrixInverse: Matrix4 = new Matrix4()\r\n\r\n  @MapUniform(\"u_aoRadius\")\r\n  aoRadius: number = 1\r\n\r\n  decorate(graph: ShaderGraph) {\r\n    const VPMatrix = innerUniform(InnerSupportUniform.VPMatrix);\r\n    const sampleCount = this.getPropertyUniform(\"sampleCount\");\r\n    const depthTex = texture(\"depthResult\");\r\n    graph\r\n      .setVertexRoot(screenQuad())\r\n      .declareFragUV()\r\n\r\n    const vUV = graph.getVary(UvFragVary);\r\n    const depth = unPackDepth.make().input(\"enc\", depthTex.fetch(vUV))\r\n\r\n    const worldPosition = getWorldPosition.make()\r\n      .input(\"uv\", vUV)\r\n      .input(\"depth\", depth)\r\n      .input(\"VPMatrix\", VPMatrix)\r\n      .input(\"VPMatrixInverse\", this.getPropertyUniform(\"VPMatrixInverse\"))\r\n\r\n    const Random2D1 = rand2DT.make()\r\n      .input(\"cood\", vUV)\r\n      .input(\"t\", sampleCount)\r\n    \r\n    const Random2D2 = rand.make()\r\n    .input(\"n\", Random2D1)\r\n    \r\n    const randDir = dir3D.make()\r\n      .input(\"x\", Random2D1)\r\n      .input(\"y\", Random2D2)\r\n\r\n    const newPositionRand = newSamplePosition.make()\r\n      .input(\"positionOld\", worldPosition.swizzling(\"xyz\"))\r\n      .input(\"distance\", this.getPropertyUniform(\"aoRadius\"))\r\n      .input(\"dir\", randDir)\r\n      .input(\"rand\", Random2D1)\r\n\r\n    const newDepth = unPackDepth.make()\r\n      .input(\"enc\",\r\n        depthTex.fetch(\r\n          NDCxyToUV.make()\r\n            .input(\r\n              \"ndc\", NDCFromWorldPositionAndVPMatrix.make()\r\n                .input(\r\n                  \"position\", newPositionRand\r\n                ).input(\r\n                  \"matrix\", VPMatrix\r\n                )\r\n            )\r\n        )\r\n    )\r\n\r\n    graph.setFragmentRoot(\r\n      tssaoMix.make()\r\n        .input(\"oldColor\", texture(\"AOAcc\").fetch(vUV).swizzling(\"xyz\"))\r\n        .input(\"newColor\",\r\n          sampleAO.make()\r\n            .input(\"depth\", depth)\r\n            .input(\"newDepth\", newDepth)\r\n        )\r\n        .input(\"sampleCount\", sampleCount)\r\n    )\r\n  }\r\n}","import { BaseEffectShading, MapUniform } from \"../../core/shading\";\r\nimport { ShaderFunction } from \"../../shader-graph/shader-function\";\r\nimport { texture, screenQuad } from \"../../shader-graph/node-maker\";\r\nimport { UvFragVary, ShaderGraph } from '../../shader-graph/shader-graph';\r\n\r\nconst tssaoBlend = new ShaderFunction({\r\n  source: `\r\n  vec4 tssaoBlend(\r\n    sampler2D colorMap, \r\n    sampler2D aoMap, \r\n    vec2 uvInput,\r\n    float sampleCount, \r\n    float tssaoComposeRate,\r\n    float tssaoShowThreshold,\r\n    float tssaoComposeThreshold\r\n    ) {\r\n      vec3 color = texture2D(colorMap, uvInput).xyz;\r\n      vec3 aoColor = texture2D(aoMap, uvInput).xyz;\r\n      vec3 aoModify = vec3(1.0) - tssaoComposeRate * (vec3(1.0) - aoColor) * vec3(min(sampleCount / tssaoShowThreshold, 1.0));\r\n      aoModify = clamp(aoModify + vec3(tssaoComposeThreshold), vec3(0.0), vec3(1.0));\r\n      return vec4(color * aoModify, 1.0);\r\n  }\r\n  `\r\n})\r\n\r\nexport class TSSAOBlendShading extends BaseEffectShading<TSSAOBlendShading> {\r\n\r\n  @MapUniform(\"u_sampleCount\")\r\n  sampleCount: number = 0;\r\n\r\n  @MapUniform(\"u_tssaoComposeRate\")\r\n  tssaoComposeRate: number = 1;\r\n\r\n  @MapUniform(\"u_tssaoShowThreshold\")\r\n  tssaoShowThreshold: number = 200;\r\n\r\n  @MapUniform(\"u_tssaoComposeThreshold\")\r\n  tssaoComposeThreshold: number = 0.5;\r\n\r\n  decorate(graph: ShaderGraph) {\r\n    graph\r\n      .setVertexRoot(screenQuad())\r\n      .declareFragUV()\r\n      .setFragmentRoot(\r\n        tssaoBlend.make()\r\n          .input(\"colorMap\", texture(\"basic\"))\r\n          .input(\"aoMap\", texture(\"tssao\"))\r\n          .input(\"uvInput\", graph.getVary(UvFragVary))\r\n          .input('sampleCount', this.getPropertyUniform('sampleCount'))\r\n          .input('tssaoComposeRate', this.getPropertyUniform('tssaoComposeRate'))\r\n          .input('tssaoShowThreshold', this.getPropertyUniform('tssaoShowThreshold'))\r\n          .input('tssaoComposeThreshold', this.getPropertyUniform('tssaoComposeThreshold'))\r\n      )\r\n  }\r\n\r\n\r\n\r\n}","import { BaseEffectShading } from \"../../core/shading\";\r\nimport { MVPWorld } from \"../../shader-graph/node-maker\";\r\nimport { ShaderFunction } from \"../../shader-graph/shader-function\";\r\nimport { depthPack } from \"../../shader-graph/built-in/depth-pack\";\r\nimport { ShaderGraph } from \"../../shader-graph/shader-graph\";\r\n\r\n\r\nconst depthV = new ShaderFunction(\r\n  {\r\n    source: `\r\n    float depthVary(vec4 worldPosition){\r\n      return worldPosition.z / worldPosition.w;\r\n    }\r\n    `}\r\n)\r\n\r\nexport class DepthShading extends BaseEffectShading<DepthShading> {\r\n\r\n  decorate(graph: ShaderGraph): void {\r\n    const worldPosition = MVPWorld()\r\n    graph.setVertexRoot(worldPosition)\r\n      .setVary(\"depth\", depthV.make().input(\"worldPosition\", worldPosition))\r\n      .setFragmentRoot(\r\n        depthPack.make().input(\"frag_depth\", graph.getVary(\"depth\"))\r\n      )\r\n  }\r\n\r\n}","import { BaseEffectShading, MapUniform } from \"../../core/shading\";\r\nimport { Matrix4 } from \"../../math/matrix4\";\r\nimport { InnerSupportUniform } from \"../../webgl/uniform/uniform\";\r\nimport { ShaderFunction } from \"../../shader-graph/shader-function\";\r\nimport { texture, innerUniform, screenQuad } from \"../../shader-graph/node-maker\";\r\nimport { NDCxyToUV, getLastPixelNDC, UVDepthToNDC } from \"../../shader-graph/built-in/transform\";\r\nimport { unPackDepth } from \"../../shader-graph/built-in/depth-pack\";\r\nimport { UvFragVary, ShaderGraph } from '../../shader-graph/shader-graph';\r\n\r\nconst TAAMix = new ShaderFunction({\r\n  source:\r\n    `\r\n  vec4 TAAMix (vec3 oldColor, vec3 newColor, float sampleCount){\r\n    float rate = 0.05;\r\n    // return vec4(newColor * rate + (1.0 - rate) * oldColor, 1.0);\r\n    \r\n    return vec4((oldColor * sampleCount + newColor) / (sampleCount + 1.0), 1.0);\r\n\r\n    // need figure out how to clamp color\r\n    // if(sampleCount < 0.1){\r\n    //   // vec3 clampedOldColor = getClampColor(v_uv, oldColor);\r\n    //   // return vec4(newColor * rate + (1.0 - rate) * clampedOldColor, 1.0);\r\n    //   return vec4(newColor * rate + (1.0 - rate) * oldColor, 1.0);\r\n    // } else{\r\n    //   return vec4((oldColor * sampleCount + newColor) / (sampleCount + 1.0), 1.0);\r\n    // }\r\n\r\n  }\r\n    `\r\n})\r\n\r\nexport class TAAShading extends BaseEffectShading<TAAShading> {\r\n\r\n  @MapUniform(\"VPMatrixInverse\")\r\n  VPMatrixInverse: Matrix4 = new Matrix4()\r\n\r\n  @MapUniform(\"u_sampleCount\")\r\n  sampleCount: number = 0;\r\n\r\n  decorate(graph: ShaderGraph) {\r\n    graph\r\n      .setVertexRoot(screenQuad())\r\n      .declareFragUV()\r\n\r\n    const vUV = graph.getVary(UvFragVary);\r\n    const depth = unPackDepth.make().input(\"enc\", texture(\"depthResult\").fetch(vUV))\r\n\r\n    const colorOld = texture(\"TAAHistoryOld\").fetch(\r\n      NDCxyToUV.make().input(\"ndc\",\r\n        getLastPixelNDC.make()\r\n          .input(\"ndc\",\r\n            UVDepthToNDC.make()\r\n              .input(\"depth\", depth)\r\n              .input(\"uv\", graph.getVary(UvFragVary))\r\n          )\r\n          .input(\"VPMatrixInverse\", this.getPropertyUniform(\"VPMatrixInverse\"))\r\n          .input(\"LastVPMatrix\", innerUniform(InnerSupportUniform.LastVPMatrix))\r\n      )\r\n    )\r\n\r\n    graph.setFragmentRoot(\r\n      TAAMix.make()\r\n        .input(\"oldColor\", colorOld.swizzling(\"xyz\"))\r\n        .input(\"newColor\", texture(\"sceneResult\").fetch(vUV).swizzling(\"xyz\"))\r\n        .input(\"sampleCount\", this.getPropertyUniform(\"sampleCount\"))\r\n    )\r\n\r\n  }\r\n\r\n}","import { SceneNode } from \"../scene/scene-node\";\r\nimport { ShaderGraph } from \"../shader-graph/shader-graph\";\r\nimport { uniformFromValue } from \"../shader-graph/node-maker\";\r\nimport { ShaderUniformProvider, ShaderUniformDecorator } from \"./shading\";\r\nimport { ShaderCommonUniformInputNode, ShaderNode } from \"../shader-graph/shader-node\";\r\nimport { ShaderFunction } from \"../shader-graph/shader-function\";\r\nimport { Observable } from \"./observable\";\r\n\r\n// TODO I cant figure out right multi inheritance impl with strong type, code duplicate \r\n\r\nexport class Light<T> extends SceneNode\r\n  implements ShaderUniformProvider, ShaderUniformDecorator {\r\n  constructor() {\r\n    super();\r\n    // need check if has initialized by decorator\r\n    if (this.uniforms === undefined) {\r\n      this.uniforms = new Map();\r\n    }\r\n    if (this.propertyUniformNameMap === undefined) {\r\n      this.propertyUniformNameMap = new Map();\r\n    }\r\n  }\r\n\r\n  decorate(decorated: ShaderGraph): void {\r\n    decorated\r\n      .setFragmentRoot(\r\n        collectLight.make()\r\n          .input(\"base\", decorated.getFragRoot())\r\n          .input(\"light\", this.produceLightFragEffect(decorated))\r\n      )\r\n  }\r\n\r\n  foreachProvider(visitor: (p: ShaderUniformProvider) => any) {\r\n    return visitor(this);\r\n  }\r\n\r\n  produceLightFragEffect(_graph: ShaderGraph): ShaderNode {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n\r\n  notifyNeedRedecorate: Observable<ShaderUniformDecorator> = new Observable()\r\n\r\n  hasAnyUniformChanged: boolean;\r\n\r\n  uniforms: Map<string, any>;\r\n\r\n  propertyUniformNameMap: Map<string, string>;\r\n\r\n  getPropertyUniform(name: keyof T): ShaderCommonUniformInputNode {\r\n    const uniformName = this.propertyUniformNameMap.get(name as string);\r\n    const value = this[name as string];\r\n    if (value === undefined) {\r\n      throw \"uniform value not given\"\r\n    }\r\n    return uniformFromValue(uniformName, value);\r\n  }\r\n}\r\n\r\nexport const collectLight = new ShaderFunction({\r\n  source: `\r\n  vec4 add(\r\n    vec4 base,\r\n    vec4 light){\r\n      return base + light;\r\n  }\r\n  `\r\n});","import { ShaderFunction } from \"../shader-graph/shader-function\";\r\nimport { Light } from \"../core/light\";\r\nimport { MapUniform } from \"../core/shading\";\r\nimport { Vector3 } from \"../math\";\r\nimport { ShaderGraph } from \"../shader-graph/shader-graph\";\r\n\r\nconst ambientLightShading = new ShaderFunction({\r\n  source:\r\n    `\r\n    vec4 ambientLight(\r\n      vec3 color\r\n      ){\r\n        return vec4(color, 1.0);\r\n    }\r\n  `\r\n})\r\n\r\nexport class AmbientLight extends Light<AmbientLight> {\r\n\r\n  produceLightFragEffect(_decorated: ShaderGraph) {\r\n    return ambientLightShading.make()\r\n      .input(\"color\", this.getPropertyUniform('color'))\r\n  }\r\n\r\n  @MapUniform(\"color\")\r\n  color: Vector3 = new Vector3(1, 1, 1)\r\n\r\n}\r\n","import { ShaderFunction } from \"../shader-graph/shader-function\";\r\nimport { Light } from \"../core/light\";\r\nimport { ShaderGraph } from \"../artgl\";\r\nimport { WorldPositionFragVary, NormalFragVary } from \"../shader-graph/shader-graph\";\r\nimport { MapUniform } from \"../core/shading\";\r\nimport { Vector3 } from \"../math\";\r\n\r\nconst directionalLightShading = new ShaderFunction({\r\n  source:\r\n    `\r\n    vec4 dirLight(\r\n      vec3 fragPosition,\r\n      vec3 fragNormal,\r\n      vec3 lightDirection, \r\n      vec3 color\r\n      ){\r\n        float light = max(0.0, dot(fragNormal, lightDirection));\r\n        return vec4(light * color, 1.0);\r\n    }\r\n  `\r\n})\r\n\r\n\r\nexport class DirectionalLight extends Light<DirectionalLight> {\r\n\r\n  produceLightFragEffect(decorated: ShaderGraph) {\r\n    return directionalLightShading.make()\r\n      .input(\"fragPosition\", decorated.getVary(WorldPositionFragVary))\r\n      .input(\"fragNormal\", decorated.getVary(NormalFragVary))\r\n      .input(\"lightDirection\", this.getPropertyUniform('direction'))\r\n      .input(\"color\", this.getPropertyUniform('color'))\r\n  }\r\n\r\n  @MapUniform(\"u_directionalLight_color\")\r\n  color: Vector3 = new Vector3(1, 1, 1)\r\n\r\n  @MapUniform(\"u_directionalLight_direction\")\r\n  direction: Vector3 = new Vector3(1, 1, 1).normalize()\r\n\r\n}\r\n","import { ShaderFunction } from \"../shader-graph/shader-function\";\r\nimport { Light } from \"../core/light\";\r\nimport { WorldPositionFragVary, NormalFragVary, ShaderGraph } from \"../shader-graph/shader-graph\";\r\nimport { MapUniform } from \"../core/shading\";\r\nimport { Vector3 } from \"../math\";\r\n\r\nconst pointLightShading = new ShaderFunction({\r\n  source:\r\n    `\r\n    vec4 pointLight(\r\n      vec3 fragPosition,\r\n      vec3 fragNormal,\r\n      vec3 lightPosition, \r\n      vec3 color,\r\n      float radius ){\r\n        float distance = length(fragPosition - lightPosition);\r\n        if( distance < radius){\r\n          return vec4(color * (1.0 - distance / radius), 0.0);\r\n        }\r\n        return vec4(0.0);\r\n    }\r\n  `\r\n})\r\n\r\nexport class PointLight extends Light<PointLight> {\r\n\r\n  produceLightFragEffect(decorated: ShaderGraph) {\r\n    return pointLightShading.make()\r\n      .input(\"fragPosition\", decorated.getVary(WorldPositionFragVary))\r\n      .input(\"fragNormal\", decorated.getVary(NormalFragVary))\r\n      .input(\"lightPosition\", this.getPropertyUniform('position'))\r\n      .input(\"color\", this.getPropertyUniform('color'))\r\n      .input(\"radius\", this.getPropertyUniform('radius'))\r\n  }\r\n\r\n  @MapUniform(\"u_pointLight_color\")\r\n  color: Vector3 = new Vector3(1, 1, 1)\r\n\r\n  // TODO bind this to scene node transformation\r\n  @MapUniform(\"u_pointLight_lightPosition\")\r\n  position: Vector3 = new Vector3(0, 0, 0)\r\n\r\n  @MapUniform(\"u_pointLight_lightRadius\")\r\n  radius: number = 3\r\n}\r\n","\r\nimport { Vector3 } from '../../math/index';\r\nimport { StandardGeometry } from '../standard-geometry';\r\n\r\n\r\nexport class SphereGeometry extends StandardGeometry {\r\n  constructor(radius?: number, widthSegments?: number, heightSegments?: number,\r\n    phiStart?: number, phiLength?: number, thetaStart?: number, thetaLength?: number) {\r\n    super();\r\n    this.radius = radius !== undefined ? radius : 1;\r\n    this.widthSegments = Math.max(3, Math.floor(widthSegments) || 8);\r\n    this.heightSegments = Math.max(2, Math.floor(heightSegments) || 6);\r\n    this.phiStart = phiStart !== undefined ? phiStart : 0;\r\n    this.phiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n    this.thetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n    this.thetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n    this.thetaEnd = this.thetaStart + this.thetaLength;\r\n\r\n    this.buildShape();\r\n  }\r\n  name = 'SphereGeometry'\r\n  radius = 1;\r\n  widthSegments = 10;\r\n  heightSegments = 10;\r\n  phiStart = 0;\r\n  phiLength = Math.PI * 2;\r\n  thetaStart = 0;\r\n  thetaLength = Math.PI * 2;\r\n  thetaEnd: number;\r\n\r\n  shape() {\r\n\r\n    let ix: number, iy: number;\r\n    let index = 0;\r\n    let grid = [];\r\n    let vertex = new Vector3(0, 0, 0);\r\n    let normal = new Vector3(0, 0, 0);\r\n\r\n    // buffers\r\n\r\n    let indices = [];\r\n    let vertices = [];\r\n    let normals = [];\r\n    let uvs = [];\r\n\r\n    for (iy = 0; iy <= this.heightSegments; iy++) {\r\n      let verticesRow = [];\r\n      let v = iy / this.heightSegments;\r\n      for (ix = 0; ix <= this.widthSegments; ix++) {\r\n        let u = ix / this.widthSegments;\r\n        // vertex\r\n        vertex.x = - this.radius * Math.cos(this.phiStart + u * this.phiLength) * Math.sin(this.thetaStart + v * this.thetaLength);\r\n        vertex.y = this.radius * Math.cos(this.thetaStart + v * this.thetaLength);\r\n        vertex.z = this.radius * Math.sin(this.phiStart + u * this.phiLength) * Math.sin(this.thetaStart + v * this.thetaLength);\r\n        vertices.push(vertex.x, vertex.y, vertex.z);\r\n        // normal\r\n        normal.set(vertex.x, vertex.y, vertex.z).normalize();\r\n        normals.push(normal.x, normal.y, normal.z);\r\n        // uv\r\n        uvs.push(u, 1 - v);\r\n        verticesRow.push(index++);\r\n      }\r\n      grid.push(verticesRow);\r\n    }\r\n\r\n    // indices\r\n    for (iy = 0; iy < this.heightSegments; iy++) {\r\n      for (ix = 0; ix < this.widthSegments; ix++) {\r\n        let a = grid[iy][ix + 1];\r\n        let b = grid[iy][ix];\r\n        let c = grid[iy + 1][ix];\r\n        let d = grid[iy + 1][ix + 1];\r\n        if (iy !== 0 || this.thetaStart > 0) indices.push(a, b, d);\r\n        if (iy !== this.heightSegments - 1 || this.thetaEnd < Math.PI) indices.push(b, c, d);\r\n      }\r\n    }\r\n\r\n    this.create(indices, vertices, normals, uvs);\r\n\r\n  }\r\n\r\n}\r\n","import { StandardGeometry } from \"../standard-geometry\";\r\nimport { Vector3 } from \"../../math\";\r\n\r\n// https://github.com/mrdoob/three.js/blob/dev/src/geometries/BoxGeometry.js\r\n\r\nexport class CubeGeometry extends StandardGeometry {\r\n  constructor(width?: number, height?: number, depth?: number,\r\n    widthSegments?: number, heightSegments?: number, depthSegments?: number) {\r\n    super();\r\n    if (width !== undefined) { this.width = width; }\r\n    if (height !== undefined) { this.height = height; }\r\n    if (depth !== undefined) { this.depth = depth; }\r\n    if (widthSegments !== undefined) { this.widthSegments = widthSegments; }\r\n    if (heightSegments !== undefined) { this.heightSegments = heightSegments; }\r\n    if (depthSegments !== undefined) { this.depthSegments = depthSegments; }\r\n\r\n    this.buildShape();\r\n  }\r\n\r\n  width: number = 1;\r\n  height: number = 1;\r\n  depth: number = 1;\r\n  widthSegments: number = 1;\r\n  heightSegments: number = 1;\r\n  depthSegments: number = 1;\r\n\r\n  shape() {\r\n\r\n    const indices = [];\r\n    const vertices = [];\r\n    const normals = [];\r\n    const uvs = [];\r\n\r\n    let numberOfVertices = 0;\r\n\r\n    function buildPlane(\r\n      u: string,\r\n      v: string,\r\n      w: string,\r\n      udir: number,\r\n      vdir: number,\r\n      width: number,\r\n      height: number,\r\n      depth: number,\r\n      gridX: number,\r\n      gridY: number,\r\n    ) {\r\n      const segmentWidth = width / gridX;\r\n      const segmentHeight = height / gridY;\r\n\r\n      const widthHalf = width / 2;\r\n      const heightHalf = height / 2;\r\n      const depthHalf = depth / 2;\r\n\r\n      const gridX1 = gridX + 1;\r\n      const gridY1 = gridY + 1;\r\n\r\n      let ix: number, iy: number;\r\n\r\n      const vector = new Vector3();\r\n      let vertexCounter = 0;\r\n\r\n      // generate vertices, normals and uvs\r\n\r\n      for (iy = 0; iy < gridY1; iy++) {\r\n        var y = iy * segmentHeight - heightHalf;\r\n        for (ix = 0; ix < gridX1; ix++) {\r\n          var x = ix * segmentWidth - widthHalf;\r\n\r\n          // set values to correct vector component\r\n          vector[u] = x * udir;\r\n          vector[v] = y * vdir;\r\n          vector[w] = depthHalf;\r\n\r\n          // now apply vector to vertex buffer\r\n          vertices.push(vector.x, vector.y, vector.z);\r\n\r\n          // set values to correct vector component\r\n          vector[u] = 0;\r\n          vector[v] = 0;\r\n          vector[w] = depth > 0 ? 1 : - 1;\r\n\r\n          // now apply vector to normal buffer\r\n          normals.push(vector.x, vector.y, vector.z);\r\n\r\n          // uvs\r\n          uvs.push(ix / gridX);\r\n          uvs.push(1 - (iy / gridY));\r\n\r\n          vertexCounter += 1;\r\n        }\r\n      }\r\n\r\n      // indices\r\n      // 1. you need three indices to draw a single face\r\n      // 2. a single segment consists of two faces\r\n      // 3. so we need to generate six (2*3) indices per segment\r\n      for (iy = 0; iy < gridY; iy++) {\r\n        for (ix = 0; ix < gridX; ix++) {\r\n          var a = numberOfVertices + ix + gridX1 * iy;\r\n          var b = numberOfVertices + ix + gridX1 * (iy + 1);\r\n          var c = numberOfVertices + (ix + 1) + gridX1 * (iy + 1);\r\n          var d = numberOfVertices + (ix + 1) + gridX1 * iy;\r\n\r\n          // faces\r\n          indices.push(a, b, d);\r\n          indices.push(b, c, d);\r\n        }\r\n      }\r\n\r\n      numberOfVertices += vertexCounter;\r\n    }\r\n\r\n    // build each side of the box geometry\r\n\r\n    buildPlane('z', 'y', 'x', - 1, - 1, this.depth, this.height, this.width, this.depthSegments, this.heightSegments); // px\r\n    buildPlane('z', 'y', 'x', 1, - 1, this.depth, this.height, -  this.width, this.depthSegments, this.heightSegments); // nx\r\n    buildPlane('x', 'z', 'y', 1, 1, this.width, this.depth, this.height, this.widthSegments, this.depthSegments); // py\r\n    buildPlane('x', 'z', 'y', 1, - 1, this.width, this.depth, -  this.height, this.widthSegments, this.depthSegments); // ny\r\n    buildPlane('x', 'y', 'z', 1, - 1, this.width, this.height, this.depth, this.widthSegments, this.heightSegments); // pz\r\n    buildPlane('x', 'y', 'z', - 1, - 1, this.width, this.height, -  this.depth, this.widthSegments, this.heightSegments); // nz\r\n\r\n    this.create(indices, vertices, normals, uvs);\r\n  }\r\n\r\n\r\n}","\r\nimport { Interactor } from \"./interactor\";\r\n\r\n// controller is about how to manipulate camera easily\r\nexport class Controller{\r\n  constructor() {\r\n  }\r\n\r\n  public interactor: Interactor;\r\n\r\n}","import { Vector3 } from './vector3';\r\nimport { MathUtil } from './util';\r\n\r\nexport class Spherical {\r\n\r\n  public center = new Vector3();\r\n  public radius: number;\r\n  public polar: number;\r\n  public azim: number;\r\n\r\n  constructor(radius?: number, polar?: number, azim?: number) {\r\n    this.radius = radius !== undefined ? radius : 1;\r\n    this.polar = polar !== undefined ? polar : 0;\r\n    this.azim = azim !== undefined ? azim : 0;\r\n  }\r\n\r\n  public set(radius: number, polar: number, azim: number): Spherical {\r\n    this.radius = radius;\r\n    this.polar = polar;\r\n    this.azim = azim;\r\n    return this;\r\n  }\r\n\r\n  public copy(s: Spherical): Spherical {\r\n    return this.set(s.radius, s.polar, s.azim);\r\n  }\r\n\r\n  public clone(): Spherical {\r\n    return new Spherical(this.radius, this.polar, this.azim);\r\n  }\r\n\r\n  public setFromVector(v: Vector3): Spherical {\r\n    this.radius = v.length();\r\n    if (this.radius === 0) {\r\n      this.polar = 0;\r\n      this.azim = 0;\r\n    } else {\r\n      this.polar = Math.acos(MathUtil.clamp((v.y / this.radius), -1, 1));\r\n      this.azim = Math.atan2(v.x, v.z);\r\n    }\r\n    return this;\r\n  }\r\n}","import { Controller } from \"./controller\";\r\nimport { Spherical } from \"../math/spherical\";\r\nimport { Interactor } from \"./interactor\";\r\nimport { Vector2 } from \"../math/vector2\";\r\nimport { Vector3, MathUtil } from \"../math/index\";\r\nimport { PerspectiveCamera } from \"../camera/perspective-camera\";\r\n\r\n\r\nconst tempVec = new Vector3();\r\n\r\nexport class OrbitController extends Controller {\r\n\r\n  constructor(public camera: PerspectiveCamera) {\r\n    super();\r\n    this.camera = camera;\r\n\r\n    const v = new Vector3();\r\n    v.copy(camera.transform.position).sub(this.spherical.center);\r\n    this.spherical.setFromVector(v);\r\n  }\r\n\r\n  spherical: Spherical = new Spherical();\r\n\r\n  rotateAngleFactor = 0.2\r\n  panFactor = 0.0002\r\n  zoomFactor = 0.3;\r\n\r\n  // restriction\r\n  maxPolarAngle = 179 / 180 * Math.PI;\r\n  minPolarAngle = 0.1;\r\n\r\n  // damping\r\n  sphericalDelta: Spherical = new Spherical(0, 0, 0);\r\n  zooming: number = 1;\r\n  panOffset: Vector3 = new Vector3();\r\n\r\n  enableDamping = true;\r\n  zoomingDampingFactor = 0.1;\r\n  rotateDampingFactor = 0.1;\r\n  panDampingFactor = 0.1;\r\n\r\n\r\n  public registerInteractor(interactor: Interactor) {\r\n    if (this.interactor !== undefined) {\r\n      this.interactor.unbindControllerAllListener(this);\r\n    }\r\n    this.interactor = interactor;\r\n    this.interactor.bindLeftMouseMove(this, this.rotate);\r\n    this.interactor.bindRightMouseMove(this, this.move);\r\n    this.interactor.bindMouseWheel(this, this.zoom);\r\n  }\r\n\r\n\r\n  // operate methods\r\n  rotate = (offset: Vector2) => {\r\n    const viewWidth = this.camera.width * 5000;\r\n    const viewHeight = this.camera.height * 5000;\r\n\r\n    this.sphericalDelta.polar += offset.y / viewHeight * Math.PI * this.rotateAngleFactor\r\n    this.sphericalDelta.azim += offset.x / viewWidth * Math.PI * this.rotateAngleFactor\r\n\r\n    this.needUpdate = true;\r\n  }\r\n  zoom = (factor: number) => {\r\n    this.zooming = 1 + (factor - 1) * this.zoomFactor;\r\n    this.needUpdate = true;\r\n  }\r\n  move = (offset: Vector2) => {\r\n    offset.rotate(-this.spherical.azim).multiplyScalar(this.spherical.radius * this.panFactor);\r\n\r\n\r\n    this.panOffset.x += offset.x;\r\n    this.panOffset.z += offset.y;\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  public needUpdate: boolean = true;\r\n\r\n\r\n  public update() {\r\n\r\n    if (Math.abs(this.sphericalDelta.azim) > 0.0001 ||\r\n      Math.abs(this.sphericalDelta.polar) > 0.0001 ||\r\n      Math.abs(this.sphericalDelta.radius) > 0.0001 ||\r\n      Math.abs(this.zooming - 1) > 0.0001 ||\r\n      this.panOffset.mag() > 0.0001\r\n    ) {\r\n      this.needUpdate = true;\r\n    }\r\n\r\n\r\n    if (this.needUpdate) {\r\n      this.spherical.radius *= this.zooming;\r\n\r\n      this.spherical.azim += this.sphericalDelta.azim;\r\n\r\n      this.spherical.polar = MathUtil.clamp(\r\n        this.spherical.polar + this.sphericalDelta.polar,\r\n        this.minPolarAngle, this.maxPolarAngle);\r\n\r\n      this.spherical.center.add(this.panOffset);\r\n\r\n      tempVec.setFromSpherical(this.spherical).add(this.spherical.center);\r\n      this.camera.transform.position.copy(tempVec);\r\n      this.camera.lookAt(this.spherical.center);\r\n    }\r\n    this.needUpdate = false;\r\n\r\n    // update damping effect\r\n    if (this.enableDamping === true) {\r\n      this.sphericalDelta.azim *= (1 - this.rotateDampingFactor);\r\n      this.sphericalDelta.polar *= (1 - this.rotateDampingFactor);\r\n      this.zooming = this.zooming + (1 - this.zooming) * this.zoomingDampingFactor;\r\n      this.panOffset.multiplyScalar(1 - this.panDampingFactor);\r\n    } else {\r\n      this.sphericalDelta.set(0, 0, 0);\r\n      this.zooming = 1;\r\n      this.panOffset.set(0, 0, 0);\r\n    }\r\n  }\r\n\r\n}","import { Vector3 } from \"../math/index\";\r\n\r\nconst v1 = new Vector3();\r\nconst v2 = new Vector3();\r\nconst v3 = new Vector3();\r\nconst v12 = new Vector3();\r\nconst v13 = new Vector3();\r\nconst n = new Vector3();\r\n\r\nexport function generateNormalFromPosition(vertices: Float32Array): Float32Array {\r\n  const vertices_length = vertices.length;\r\n  const step = 9;\r\n  const normals = new Float32Array(vertices_length);\r\n\r\n  for (let i = 0; i < vertices_length; i += step) {\r\n      v1.set(vertices[i + 0], vertices[i + 1], vertices[i + 2]);\r\n      v2.set(vertices[i + 3], vertices[i + 4], vertices[i + 5]);\r\n      v3.set(vertices[i + 6], vertices[i + 7], vertices[i + 8]);\r\n      v12.copy(v2).sub(v1);\r\n      v13.copy(v3).sub(v1);\r\n      n.crossVectors(v12, v13);\r\n      n.normalize();\r\n      normals[i + 0] = n.x;\r\n      normals[i + 1] = n.y;\r\n      normals[i + 2] = n.z;\r\n      normals[i + 3] = n.x;\r\n      normals[i + 4] = n.y;\r\n      normals[i + 5] = n.z;\r\n      normals[i + 6] = n.x;\r\n      normals[i + 7] = n.y;\r\n      normals[i + 8] = n.z;\r\n  }\r\n\r\n  return normals;\r\n}","import { Geometry } from \"./geometry\";\r\n\r\n/**\r\n * Base class for resource loader \r\n * Any loader should extends this for comprehensive usage\r\n *\r\n * @export\r\n * @abstract\r\n * @class Loader\r\n */\r\nexport abstract class Loader {\r\n  name: string = \"unnamed loader\";\r\n\r\n  /**\r\n   * This regExp is for matching giving file extension name\r\n   * whether should be use with this loader\r\n   *\r\n   * @type {RegExp}\r\n   * @memberof Loader\r\n   */\r\n  fileSuffixReg?: RegExp;\r\n  abstract parse(input: string | ArrayBuffer): any;\r\n}\r\n\r\nexport abstract class GeometryLoader extends Loader{\r\n  abstract parse(input: string | ArrayBuffer): Geometry;\r\n}","import { Geometry } from \"../core/geometry\";\r\nimport { Vector3 } from \"../math/vector3\";\r\nimport { Vector2 } from \"../math/vector2\";\r\nimport { loadStringFromFile } from \"../util/file-io\";\r\nimport { generateNormalFromPosition } from \"../util/normal-generation\";\r\nimport { StandardGeometry } from \"../geometry/standard-geometry\";\r\nimport { GeometryLoader } from \"../core/loader\";\r\n\r\nexport async function loadObjFile(): Promise<Geometry> {\r\n  const loader = new OBJLoader();\r\n  const str = await loadStringFromFile();\r\n  return loader.parse(str);\r\n}\r\n\r\nexport class OBJLoader extends GeometryLoader{\r\n  private vertexPattern = /v( +[\\d|\\.|\\+|\\-|e|E]+)( +[\\d|\\.|\\+|\\-|e|E]+)( +[\\d|\\.|\\+|\\-|e|E]+)/;\r\n  // vn float float float\r\n\r\n  private normalPattern = /vn( +[\\d|\\.|\\+|\\-|e|E]+)( +[\\d|\\.|\\+|\\-|e|E]+)( +[\\d|\\.|\\+|\\-|e|E]+)/;\r\n  // vt float float\r\n\r\n  private uvPattern = /vt( +[\\d|\\.|\\+|\\-|e|E]+)( +[\\d|\\.|\\+|\\-|e|E]+)/;\r\n  // f vertex vertex vertex ...\r\n\r\n  private facePattern1 = /f\\s+(([\\d]{1,}[\\s]?){3,})+/;\r\n  // f vertex/uvs vertex/uvs vertex/uvs ...\r\n\r\n  private facePattern2 = /f\\s+((([\\d]{1,}\\/[\\d]{1,}[\\s]?){3,})+)/;\r\n  // f vertex/uvs/normal vertex/uvs/normal vertex/uvs/normal ...\r\n\r\n  private facePattern3 = /f\\s+((([\\d]{1,}\\/[\\d]{1,}\\/[\\d]{1,}[\\s]?){3,})+)/;\r\n  // f vertex//normal vertex//normal vertex//normal ...\r\n\r\n  private facePattern4 = /f\\s+((([\\d]{1,}\\/\\/[\\d]{1,}[\\s]?){3,})+)/;\r\n\r\n  private collectTriangle(faces: string[]): string[] {\r\n    const triangles: string[] = [];\r\n    this.getTriangles(faces, 1, triangles);\r\n    return triangles;\r\n  }\r\n\r\n  private getTriangles(face: string[], v: number, triangleList: string[]) {\r\n    //Work for each element of the array\r\n    //Result obtained after 2 iterations:\r\n    //Pattern1 => triangle = [\"1\",\"2\",\"3\",\"1\",\"3\",\"4\"];\r\n    //Pattern2 => triangle = [\"1/1\",\"2/2\",\"3/3\",\"1/1\",\"3/3\",\"4/4\"];\r\n    //Pattern3 => triangle = [\"1/1/1\",\"2/2/2\",\"3/3/3\",\"1/1/1\",\"3/3/3\",\"4/4/4\"];\r\n    //Pattern4 => triangle = [\"1//1\",\"2//2\",\"3//3\",\"1//1\",\"3//3\",\"4//4\"];\r\n    if (v + 1 < face.length) {\r\n      //Add on the triangle variable the indexes to obtain triangles\r\n      triangleList.push(face[0], face[v], face[v + 1]);\r\n      //Incrementation for recursion\r\n      v += 1;\r\n      //Recursion\r\n      this.getTriangles(face, v, triangleList);\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    this.positions = [];\r\n    this.normals = [];\r\n    this.uvs = [];\r\n    this.indicesForArtgl = [];\r\n    this.wrappedPositionForArtgl = [];\r\n    this.wrappedUvsForArtgl = [];\r\n    this.wrappedNormalsForArtgl = [];\r\n    this.tuplePosNorm = [];\r\n    this.curPositionInIndices = 0;\r\n  }\r\n\r\n  private positions: Vector3[] = [];\r\n  private normals: Vector3[] = [];\r\n  private uvs: Vector2[] = [];\r\n\r\n  private indicesForArtgl: number[] = [];         //The list of indices for VertexData\r\n  private wrappedPositionForArtgl: Vector3[] = [];//The list of position in vectors\r\n  private wrappedUvsForArtgl: Vector2[] = [];     //Array with all value of uvs to match with the indices\r\n  private wrappedNormalsForArtgl: Vector3[] = []; //Array with all value of normals to match with the indices\r\n  //Create a tuple with indices of Position, Normal, UV  [pos, norm, uvs]\r\n  private tuplePosNorm: Array<{ normals: Array<number>; idx: Array<number> }> = [];\r\n  private curPositionInIndices: number = 0;\r\n\r\n  private isInArray(position: number, normal: number) {\r\n    if (!this.tuplePosNorm[position]) {\r\n      this.tuplePosNorm[position] = { normals: [], idx: [] };\r\n    }\r\n    const idx = this.tuplePosNorm[position].normals.indexOf(normal);\r\n    return idx === -1 ? -1 : this.tuplePosNorm[position].idx[idx];\r\n    ``\r\n  };\r\n\r\n  private setData(\r\n    indicePositionFromObj: number,\r\n    indiceUvsFromObj: number,\r\n    indiceNormalFromObj: number,\r\n    positionVectorFromOBJ: Vector3,\r\n    textureVectorFromOBJ: Vector2,\r\n    normalsVectorFromOBJ: Vector3\r\n  ) {\r\n    //Check if this tuple already exists in the list of tuples\r\n    // const index = this.isInArray(indicePositionFromObj, indiceNormalFromObj);\r\n    const index = -1\r\n    \r\n    //If it not exists\r\n    if (index === -1) {\r\n      //Add an new indice.\r\n      //The array of indices is only an array with his length equal to the number of triangles - 1.\r\n      //We add vertices data in this order\r\n      this.indicesForArtgl.push(this.wrappedPositionForArtgl.length);\r\n      this.wrappedPositionForArtgl.push(positionVectorFromOBJ);\r\n      this.wrappedUvsForArtgl.push(textureVectorFromOBJ);\r\n      this.wrappedNormalsForArtgl.push(normalsVectorFromOBJ);\r\n      //Add the tuple in the comparison list\r\n      // this.tuplePosNorm[indicePositionFromObj].normals.push(indiceNormalFromObj);\r\n      // this.tuplePosNorm[indicePositionFromObj].idx.push(this.curPositionInIndices);\r\n      this.curPositionInIndices++\r\n    } else {\r\n      //The tuple already exists\r\n      //Add the index of the already existing tuple\r\n      //At this index we can get the value of position, normal and uvs of vertex\r\n      this.indicesForArtgl.push(index);\r\n    }\r\n  };\r\n\r\n  private setDataForCurrentFaceWithPattern1(face: string[]) {\r\n    const triangleStrs = this.collectTriangle(face);\r\n    //For each element in the triangles array.\r\n    //This var could contains 1 to an infinity of triangles\r\n    for (var k = 0; k < triangleStrs.length; k++) {\r\n      // Set position indice\r\n      var indicePositionFromObj = parseInt(triangleStrs[k]) - 1;\r\n      this.setData(\r\n        indicePositionFromObj,\r\n        0, 0,                                  //In the pattern 1, normals and uvs are not defined\r\n        this.positions[indicePositionFromObj], //Get the vectors data\r\n        new Vector2(), new Vector3(0, 1, 0)      //Create default vectors\r\n      );\r\n    }\r\n  };\r\n\r\n  private setDataForCurrentFaceWithPattern2(face: string[]) {\r\n    const triangleStrs = this.collectTriangle(face);\r\n    for (var k = 0; k < triangleStrs.length; k++) {\r\n      //triangle[k] = \"1/1\"\r\n      //Split the data for getting position and uv\r\n      var point = triangleStrs[k].split(\"/\"); // [\"1\", \"1\"]\r\n      //Set position indice\r\n      var indicePositionFromObj = parseInt(point[0]) - 1;\r\n      //Set uv indice\r\n      var indiceUvsFromObj = parseInt(point[1]) - 1;\r\n\r\n      this.setData(\r\n        indicePositionFromObj,\r\n        indiceUvsFromObj,\r\n        0,                                  //Default value for normals\r\n        this.positions[indicePositionFromObj],   //Get the values for each element\r\n        this.uvs[indiceUvsFromObj],\r\n        new Vector3(0, 1, 0)                //Default value for normals\r\n      );\r\n    }\r\n  }\r\n\r\n  private setDataForCurrentFaceWithPattern3(face: string[]) {\r\n    const triangleStrs = this.collectTriangle(face);\r\n    for (var k = 0; k < triangleStrs.length; k++) {\r\n      //triangle[k] = \"1/1/1\"\r\n      //Split the data for getting position, uv, and normals\r\n      var point = triangleStrs[k].split(\"/\"); // [\"1\", \"1\", \"1\"]\r\n      // Set position indice\r\n      var indicePositionFromObj = parseInt(point[0]) - 1;\r\n      // Set uv indice\r\n      var indiceUvsFromObj = parseInt(point[1]) - 1;\r\n      // Set normal indice\r\n      var indiceNormalFromObj = parseInt(point[2]) - 1;\r\n\r\n      this.setData(\r\n        indicePositionFromObj, indiceUvsFromObj, indiceNormalFromObj,\r\n        this.positions[indicePositionFromObj],\r\n        this.uvs[indiceUvsFromObj],\r\n        this.normals[indiceNormalFromObj] //Set the vector for each component\r\n      );\r\n\r\n    }\r\n  };\r\n\r\n  private setDataForCurrentFaceWithPattern4 = (face: string[]) => {\r\n    const triangleStrs = this.collectTriangle(face);\r\n    for (var k = 0; k < triangleStrs.length; k++) {\r\n      //triangle[k] = \"1//1\"\r\n      //Split the data for getting position and normals\r\n      var point = triangleStrs[k].split(\"//\"); // [\"1\", \"1\"]\r\n      // We check indices, and normals\r\n      var indicePositionFromObj = parseInt(point[0]) - 1;\r\n      var indiceNormalFromObj = parseInt(point[1]) - 1;\r\n\r\n      this.setData(\r\n        indicePositionFromObj,\r\n        1, //Default value for uv\r\n        indiceNormalFromObj,\r\n        this.positions[indicePositionFromObj], //Get each vector of data\r\n        new Vector2(0, 0),\r\n        this.normals[indiceNormalFromObj]\r\n      );\r\n    }\r\n  };\r\n\r\n  parse(objStr: string, fileName?: string): StandardGeometry {\r\n    this.reset();\r\n\r\n    //Split the file into lines\r\n    const lines = objStr.split('\\n');\r\n    for (let i = 0; i < lines.length; i++) {\r\n      const line = lines[i].trim();\r\n      let result: string[] | null;\r\n\r\n      //Comment or newLine\r\n      if (line.length === 0 || line.charAt(0) === '#') {\r\n        continue;\r\n\r\n      } else if ((result = this.vertexPattern.exec(line)) !== null) {\r\n        this.positions.push(new Vector3(\r\n          parseFloat(result[1]),\r\n          parseFloat(result[2]),\r\n          parseFloat(result[3])\r\n        ));\r\n      } else if ((result = this.normalPattern.exec(line)) !== null) {\r\n        this.normals.push(new Vector3(\r\n          parseFloat(result[1]),\r\n          parseFloat(result[2]),\r\n          parseFloat(result[3])\r\n        ));\r\n\r\n      } else if ((result = this.uvPattern.exec(line)) !== null) {\r\n        this.uvs.push(new Vector2(\r\n          parseFloat(result[1]),\r\n          parseFloat(result[2])\r\n        ));\r\n      } else if ((result = this.facePattern3.exec(line)) !== null) {\r\n        //Value of result:\r\n        //[\"f 1/1/1 2/2/2 3/3/3\", \"1/1/1 2/2/2 3/3/3\"...]\r\n\r\n        //Set the data for this face\r\n        this.setDataForCurrentFaceWithPattern3(\r\n          result[1].trim().split(\" \"), // [\"1/1/1\", \"2/2/2\", \"3/3/3\"]\r\n        );\r\n\r\n      } else if ((result = this.facePattern4.exec(line)) !== null) {\r\n        //Value of result:\r\n        //[\"f 1//1 2//2 3//3\", \"1//1 2//2 3//3\"...]\r\n\r\n        //Set the data for this face\r\n        this.setDataForCurrentFaceWithPattern4(\r\n          result[1].trim().split(\" \"), // [\"1//1\", \"2//2\", \"3//3\"]\r\n        );\r\n\r\n      } else if ((result = this.facePattern2.exec(line)) !== null) {\r\n        //Value of result:\r\n        //[\"f 1/1 2/2 3/3\", \"1/1 2/2 3/3\"...]\r\n\r\n        //Set the data for this face\r\n        this.setDataForCurrentFaceWithPattern2(\r\n          result[1].trim().split(\" \"), // [\"1/1\", \"2/2\", \"3/3\"]\r\n        );\r\n\r\n      } else if ((result = this.facePattern1.exec(line)) !== null) {\r\n        //Value of result\r\n        //[\"f 1 2 3\", \"1 2 3\"...]\r\n\r\n        //Set the data for this face\r\n        this.setDataForCurrentFaceWithPattern1(\r\n          result[1].trim().split(\" \"), // [\"1\", \"2\", \"3\"]\r\n        );\r\n\r\n        //Define a mesh or an object\r\n        //Each time this keyword is analysed, create a new Object with all data for creating a ArtglMesh\r\n      } else {\r\n        //If there is another possibility\r\n        console.log(\"Unhandled expression at line : \" + line);\r\n      }\r\n\r\n    }\r\n    const position: number[] = [];\r\n    this.wrappedPositionForArtgl.forEach(po => {\r\n      position.push(po.x);\r\n      position.push(po.y);\r\n      position.push(po.z);\r\n    })\r\n\r\n\r\n    const uv: number[] = [];\r\n    this.wrappedUvsForArtgl.forEach(po => {\r\n      uv.push(po.x);\r\n      uv.push(po.y);\r\n    })\r\n\r\n    let normal: number[] = [];\r\n    const useGeneratedNormal = false;\r\n    if (useGeneratedNormal) {\r\n      normal = Array.from(generateNormalFromPosition(new Float32Array(position)));\r\n    } else {\r\n      normal = [];\r\n      this.wrappedNormalsForArtgl.forEach(po => {\r\n        normal.push(po.x);\r\n        normal.push(po.y);\r\n        normal.push(po.z);\r\n      })\r\n    }\r\n\r\n    const geometry = StandardGeometry.create(\r\n      this.indicesForArtgl, position, normal, uv);\r\n    \r\n    if (fileName) {\r\n      geometry.name = \"ObjFile-\" + fileName;\r\n    } else {\r\n      geometry.name = \"ObjFile-unnamed\";\r\n    }\r\n\r\n    return geometry;\r\n  }\r\n}","import { BaseEffectShading, MapUniform, MarkNeedRedecorate } from \"../../core/shading\";\r\nimport { ShaderFunction } from \"../../shader-graph/shader-function\";\r\nimport { ShaderGraph } from \"../../shader-graph/shader-graph\";\r\nimport { vec4, constValue } from \"../../shader-graph/node-maker\";\r\n\r\nconst controlExposureShading = new ShaderFunction({\r\n  source:\r\n    `vec3 LinearToneMapping(vec3 intensity, float toneMappingExposure){\r\n      return toneMappingExposure * intensity;\r\n    }`\r\n})\r\n\r\nconst Uncharted2Helper = new ShaderFunction({\r\n  source:\r\n    `\r\n    vec3 Uncharted2Helper(vec3 x){\r\n      return max(((x * (0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02) / (x * (0.15 * x + 0.50) + 0.20 * 0.30)) - 0.02/0.30, vec3(0.0));\r\n    }\r\n    `\r\n})\r\n\r\nconst Uncharted2ToneMapping = new ShaderFunction({\r\n  source:\r\n    `\r\n    vec3 Uncharted2ToneMapping(\r\n      vec3 intensity, \r\n      float toneMappingExposure,\r\n      float toneMappingWhitePoint\r\n      ) {\r\n        intensity *= toneMappingExposure;\r\n        return Uncharted2Helper(intensity) / Uncharted2Helper(vec3(toneMappingWhitePoint));\r\n    }\r\n    `,\r\n  description: `John Hable's filmic operator from Uncharted 2 video game`,\r\n  dependFunction: [Uncharted2Helper]\r\n})\r\n\r\nexport enum ToneMapType {\r\n  Linear = \"Linear\",\r\n  Uncharted2ToneMapping= \"Uncharted2ToneMapping\",\r\n\r\n}\r\n\r\nconsole.log(ToneMapType);\r\n\r\nexport class ExposureController extends BaseEffectShading<ExposureController> {\r\n\r\n  @MapUniform(\"toneMappingExposure\")\r\n  toneMappingExposure: number = 1 / 1;\r\n\r\n  @MapUniform(\"toneMappingWhitePoint\")\r\n  toneMappingWhitePoint: number = 1;\r\n\r\n  @MarkNeedRedecorate()\r\n  toneMapType: ToneMapType = ToneMapType.Uncharted2ToneMapping;\r\n\r\n  getToneMapFunction() {\r\n    switch (this.toneMapType) {\r\n\r\n      case ToneMapType.Linear:\r\n         return  controlExposureShading.make()\r\n          .input(\"toneMappingExposure\", this.getPropertyUniform(\"toneMappingExposure\"))\r\n      \r\n      case ToneMapType.Uncharted2ToneMapping:\r\n          return  Uncharted2ToneMapping.make()\r\n            .input(\"toneMappingExposure\", this.getPropertyUniform(\"toneMappingExposure\"))\r\n            .input(\"toneMappingWhitePoint\", this.getPropertyUniform(\"toneMappingWhitePoint\"))\r\n    }\r\n  }\r\n\r\n  decorate(graph: ShaderGraph): void {\r\n    graph\r\n      .setFragmentRoot(\r\n        vec4(\r\n          this.getToneMapFunction()\r\n            .input(\"intensity\", graph.getFragRoot().swizzling(\"xyz\")),\r\n          constValue(1)\r\n        )\r\n      )\r\n  }\r\n\r\n}","import {\r\n  SphereGeometry, PlaneGeometry, AmbientLight, Mesh, SceneNode,\r\n  Shading, CubeGeometry, Vector3, DirectionalLight\r\n} from '../../../src/artgl';\r\nimport { PointLight } from '../../../src/light/point-light';\r\nimport { ExposureController, ToneMapType } from '../../../src/shading/basic-lib/exposurer';\r\nimport { RenderConfig } from '@/components/conf/interface';\r\nimport { Application } from '../application';\r\n\r\nexport default function (root: SceneNode, app: Application): RenderConfig {\r\n  const sphereGeo = new SphereGeometry(1, 40, 40);\r\n  const planeGeo = new PlaneGeometry(10, 10, 10, 10);\r\n  const cubeGeo = new CubeGeometry(5, 3, 4)\r\n\r\n  const pointLight = new PointLight();\r\n  pointLight.position = new Vector3(0, 3, 0);\r\n  pointLight.color = new Vector3(0.9, 0.8, 0.5);\r\n  pointLight.radius = 10;\r\n\r\n  const ambient = new AmbientLight();\r\n  ambient.color = new Vector3(0.3, 0.3, 0.4);\r\n\r\n  const dirLight = new DirectionalLight();\r\n  dirLight.color = new Vector3(0.3, 0.6, 0.4);\r\n  dirLight.direction = new Vector3(1, 1, -1).normalize();\r\n\r\n  const exposureController = new ExposureController();\r\n\r\n  let shading = new Shading()\r\n    // .decorate(new NormalShading())\r\n    .decorate(pointLight)\r\n    .decorate(ambient)\r\n    .decorate(dirLight)\r\n    .decorate(exposureController)\r\n  \r\n  console.log(exposureController)\r\n\r\n  shading.afterShaderCompiled.add((config) => {\r\n    console.log(config);\r\n  })\r\n\r\n  const planeMesh = new Mesh().g(planeGeo).s(shading)\r\n  root.addChild(planeMesh);\r\n\r\n  const ground = new Mesh().g(planeGeo).s(shading)\r\n  ground.transform.position.y = -2;\r\n  ground.transform.rotation.x = - Math.PI / 4;\r\n  ground.transform.rotation.y = - Math.PI / 4;\r\n  root.addChild(ground);\r\n\r\n  const boxMesh = new Mesh().g(cubeGeo).s(shading)\r\n  boxMesh.transform.position.y = -2;\r\n  root.addChild(boxMesh);\r\n\r\n  const arraySize = 5;\r\n  const grid = 1;\r\n  for (let i = 0; i < arraySize; i++) {\r\n    const node = new SceneNode();\r\n    node.transform.position.x = i * grid;\r\n    root.addChild(node);\r\n    for (let j = 0; j < arraySize; j++) {\r\n      const node2 = new SceneNode();\r\n      node2.transform.position.y = j * grid;\r\n      node.addChild(node2);\r\n      for (let k = 0; k < arraySize; k++) {\r\n\r\n        const testMesh = new Mesh().g(sphereGeo).s(shading)\r\n        testMesh.transform.position.z = k * grid;\r\n        testMesh.transform.scale.setAll(0.3);\r\n        // testMesh.transform.scale.set(0.3 + i * 0.1, 0.3 + j * 0.1, 0.3 + k * 0.1);\r\n        node2.addChild(testMesh);\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    name: 'exposureControl',\r\n    value: [\r\n      {\r\n        name: 'exposureMax',\r\n        value: 1 / exposureController.toneMappingExposure,\r\n        onChange: (value: number) => {\r\n          exposureController.toneMappingExposure = 1 / value;\r\n          app.pipeline.resetSample();\r\n        },\r\n        editors: [\r\n          {\r\n            type: 'slider',\r\n            min: 0,\r\n            max: 5,\r\n            step: 0.1\r\n          },\r\n        ]\r\n      },\r\n      {\r\n        name: 'exposureWhitePoint',\r\n        value: exposureController.toneMappingWhitePoint,\r\n        onChange: (value: number) => {\r\n          exposureController.toneMappingWhitePoint = value;\r\n          app.pipeline.resetSample();\r\n        },\r\n        editors: [\r\n          {\r\n            type: 'slider',\r\n            min: 0,\r\n            max: 5,\r\n            step: 0.1\r\n          },\r\n        ]\r\n      },\r\n      {\r\n        name: 'exposureToneMapType',\r\n        value: exposureController.toneMapType,\r\n        valueConfig: {\r\n          type: \"select\",\r\n          selectItem: Object.keys(ToneMapType)\r\n        },\r\n        onChange: (value: ToneMapType) => {\r\n          exposureController.toneMapType = value;\r\n          app.pipeline.resetSample();\r\n        },\r\n      }\r\n    ]\r\n  }\r\n\r\n}\r\n","import { RenderConfig } from './components/conf/interface'\r\nimport { RenderEngine } from '../../src/artgl';\r\nimport { RenderPipeline } from './RenderPipeline';\r\n\r\nexport function createConf(engine: RenderEngine, pipeline: RenderPipeline): RenderConfig {\r\n  return {\r\n    name: 'root',\r\n    type: 'folder',\r\n    value: [\r\n      {\r\n        name: 'canvas',\r\n        value: [\r\n          {\r\n            name: 'renderSize',\r\n            value: [\r\n              {\r\n                name: 'width',\r\n                value: engine.renderer.width,\r\n                onChange: (value: number) => {\r\n                  pipeline.resetSample();\r\n                  engine.setActualSize(value, engine.renderer.height);\r\n                },\r\n                editors: [\r\n                  {\r\n                    type: 'slider',\r\n                    min: 10,\r\n                    max: 500,\r\n                    step: 1\r\n                  },\r\n                ]\r\n              },\r\n              {\r\n                name: 'height',\r\n                value: engine.renderer.height,\r\n                onChange: (value: number) => {\r\n                  pipeline.resetSample();\r\n                  engine.setActualSize(engine.renderer.width, value);\r\n                },\r\n                editors: [\r\n                  {\r\n                    type: 'slider',\r\n                    min: 10,\r\n                    max: 500,\r\n                    step: 1\r\n                  },\r\n                ]\r\n              },\r\n            ]\r\n          },\r\n        ]\r\n      },\r\n      {\r\n        name: 'engine',\r\n        value: [\r\n          {\r\n            name: 'preferUseVAO',\r\n            value: engine.preferVAO,\r\n            onChange: (value: boolean) => {\r\n              engine.preferVAO = value\r\n            },\r\n          },\r\n          {\r\n            name: 'enableUniformDiffUpload',\r\n            value: engine.renderer.enableUniformDiff,\r\n            onChange: (value: boolean) => {\r\n              engine.renderer.enableUniformDiff = value\r\n            },\r\n            description: 'this is a demo description'\r\n          },\r\n          {\r\n            name: 'TAA',\r\n            value: [\r\n              {\r\n                name: 'enable',\r\n                value: pipeline.enableTAA,\r\n                onChange: (value: boolean) => {\r\n                  pipeline.enableTAA = value;\r\n                  if (!value) {\r\n                    pipeline.resetSample();\r\n                  }\r\n                },\r\n              },\r\n            ]\r\n          },\r\n          {\r\n            name: 'TSSAO',\r\n            value: [\r\n              {\r\n                name: 'enable',\r\n                value: pipeline.enableTSSAO,\r\n                onChange: (value: boolean) => {\r\n                  pipeline.enableTSSAO = value;\r\n                  if (value) {\r\n                    pipeline.composeShading.tssaoComposeRate = 1;\r\n                  } else {\r\n                    pipeline.composeShading.tssaoComposeRate = 0;\r\n                  }\r\n                },\r\n              },\r\n              {\r\n                name: 'composeRate',\r\n                value: pipeline.composeShading.tssaoComposeRate,\r\n                onChange: (value: number) => {\r\n                  pipeline.composeShading.tssaoComposeRate = value;\r\n                },\r\n                editors: [\r\n                  {\r\n                    type: 'slider',\r\n                    min: 0,\r\n                    max: 4,\r\n                    step: 0.1\r\n                  },\r\n                ]\r\n              },\r\n              {\r\n                name: 'composeThreshold',\r\n                value: pipeline.composeShading.tssaoComposeThreshold,\r\n                onChange: (value: number) => {\r\n                  pipeline.composeShading.tssaoComposeThreshold = value;\r\n                },\r\n                editors: [\r\n                  {\r\n                    type: 'slider',\r\n                    min: 0,\r\n                    max: 4,\r\n                    step: 0.1\r\n                  },\r\n                ]\r\n              },\r\n              {\r\n                name: 'radius',\r\n                value: pipeline.tssaoShading.aoRadius,\r\n                onChange: (value: number) => {\r\n                  pipeline.tssaoShading.aoRadius = value;\r\n                  pipeline.resetSample();\r\n                },\r\n                editors: [\r\n                  {\r\n                    type: 'slider',\r\n                    min: 0.1,\r\n                    max: 10,\r\n                    step: 0.1\r\n                  },\r\n                ]\r\n              },\r\n              {\r\n                name: 'sample_count_to_show',\r\n                value: pipeline.composeShading.tssaoShowThreshold,\r\n                onChange: (value: number) => {\r\n                  pipeline.composeShading.tssaoShowThreshold = value;\r\n                },\r\n                editors: [\r\n                  {\r\n                    type: 'slider',\r\n                    min: 1,\r\n                    max: 1000,\r\n                    step: 20\r\n                  },\r\n                ]\r\n              },\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n    ]\r\n\r\n  }\r\n}\r\n","import {\r\n  RenderGraph, TAAShading,\r\n  TSSAOShading, TSSAOBlendShading, Matrix4,\r\n  InnerSupportUniform, DepthShading, Scene, RenderEngine, Shading\r\n} from \"../../src/artgl\";\r\nimport { EffectComposer } from '../../src/render-graph/render-graph';\r\nimport { RenderConfig } from './components/conf/interface';\r\nimport { createConf } from './conf';\r\n\r\nexport class RenderPipeline{\r\n  config: RenderConfig\r\n\r\n  graph: RenderGraph = new RenderGraph();\r\n  composer: EffectComposer = new EffectComposer();\r\n\r\n  enableTAA = true;\r\n  taaShading = new TAAShading()\r\n  taaShader: Shading = new Shading().decorate(this.taaShading);\r\n\r\n  enableTSSAO = true;\r\n  tssaoShading = new TSSAOShading();\r\n  tssaoShader: Shading = new Shading().decorate(this.tssaoShading);\r\n\r\n  composeShading = new TSSAOBlendShading()\r\n  composeShader: Shading = new Shading().decorate(this.composeShading);\r\n  depthShader = new Shading().decorate(new DepthShading());\r\n\r\n  private sampleCount: number = 0;\r\n\r\n  resetSample() {\r\n    this.sampleCount = 0;\r\n  }\r\n\r\n  private tickNum = 0;\r\n  get isEvenTick() {\r\n    return this.tickNum % 2 === 0;\r\n  }\r\n\r\n  render(engine: RenderEngine, scene: Scene) {\r\n    this.tickNum++;\r\n\r\n    engine.connectCamera();\r\n    if (engine.isCameraChanged || scene.isFrameChange) {\r\n      this.sampleCount = 0;\r\n    } else {\r\n      if (this.enableTAA) {\r\n        engine.jitterProjectionMatrix();\r\n      }\r\n    }\r\n\r\n    // if (this.sampleCount <= 100) {\r\n    this.graph.update(engine, this.composer);\r\n    this.composer.render(engine, this.graph);\r\n    // }\r\n  }\r\n\r\n  build(engine: RenderEngine, scene: Scene) {\r\n    this.config = createConf(engine, this);\r\n    this.graph.defineGraph(\r\n      this.composer,\r\n      {\r\n      renderTargets: [\r\n        {\r\n          name: RenderGraph.screenRoot,\r\n          from: () => 'CopyToScreen',\r\n        },\r\n        {\r\n          name: 'sceneResult',\r\n          from: () => 'SceneOrigin',\r\n        },\r\n        {\r\n          name: 'depthResult',\r\n          from: () => 'Depth',\r\n        },\r\n        {\r\n          name: 'TAAHistoryA',\r\n          from: () => this.isEvenTick ? null : 'TAA',\r\n        },\r\n        {\r\n          name: 'TAAHistoryB',\r\n          from: () => this.isEvenTick ? 'TAA' : null,\r\n        },\r\n        {\r\n          name: 'TSSAOHistoryA',\r\n          from: () => this.isEvenTick ? null : 'TSSAO',\r\n        },\r\n        {\r\n          name: 'TSSAOHistoryB',\r\n          from: () => this.isEvenTick ? 'TSSAO' : null,\r\n        },\r\n      ],\r\n      passes: [\r\n        { // general scene origin\r\n          name: \"SceneOrigin\",\r\n          source: [scene],\r\n        },\r\n        { // depth\r\n          name: \"Depth\",\r\n          shading: this.depthShader,\r\n          source: [scene],\r\n        },\r\n        { // mix new render and old samples\r\n          name: \"TAA\",\r\n          inputs: () => {\r\n            return {\r\n              sceneResult: \"sceneResult\",\r\n              depthResult: \"depthResult\",\r\n              TAAHistoryOld: this.isEvenTick ? \"TAAHistoryA\" : \"TAAHistoryB\",\r\n            }\r\n          },\r\n          shading: this.taaShader,\r\n          source: [RenderGraph.quadSource],\r\n          enableColorClear: false,\r\n          beforePassExecute: () => {\r\n            engine.unJit();\r\n            const VP: Matrix4 = engine.getGlobalUniform(InnerSupportUniform.VPMatrix).value\r\n            this.taaShading.VPMatrixInverse = this.taaShading.VPMatrixInverse.getInverse(VP, true); // TODO maybe add watch\r\n            this.taaShading.sampleCount = this.sampleCount;\r\n          },\r\n        },\r\n        {\r\n          name: \"TSSAO\",\r\n          inputs: () => {\r\n            return {\r\n              depthResult: \"depthResult\",\r\n              AOAcc: this.isEvenTick ? \"TSSAOHistoryA\" : \"TSSAOHistoryB\",\r\n            }\r\n          },\r\n          shading: this.tssaoShader,\r\n          source: [RenderGraph.quadSource],\r\n          enableColorClear: false,\r\n          beforePassExecute: () => {\r\n            const VP: Matrix4 = engine.getGlobalUniform(InnerSupportUniform.VPMatrix).value\r\n            this.tssaoShading.VPMatrixInverse = this.tssaoShading.VPMatrixInverse.getInverse(VP, true);\r\n            this.tssaoShading.sampleCount = this.sampleCount;\r\n          },\r\n        },\r\n        { // copy to screen\r\n          name: \"CopyToScreen\",\r\n          enableColorClear: false,\r\n          inputs: () => {\r\n            let basic: string;\r\n            let tssao: string;\r\n            if (this.enableTAA) {\r\n              basic = this.isEvenTick ? \"TAAHistoryB\" : \"TAAHistoryA\"\r\n            } else {\r\n              basic = \"sceneResult\"\r\n            }\r\n            if (this.enableTSSAO) {\r\n              tssao = this.isEvenTick ? \"TSSAOHistoryB\" : \"TSSAOHistoryA\"\r\n            } else {\r\n              tssao = \"sceneResult\" // TODO consider design a way to bind default empty source? or recompile shader?\r\n            }\r\n            return { basic, tssao }\r\n          },\r\n          beforePassExecute: () => {\r\n            this.composeShading.sampleCount = this.sampleCount;\r\n          },\r\n          afterPassExecute: () => {\r\n            this.sampleCount++;``\r\n          },\r\n          shading: this.composeShader,\r\n          source: [RenderGraph.quadSource],\r\n        },\r\n      ]\r\n    })\r\n  }\r\n}\r\n","import { Vector3, Matrix4 } from \"../../math\";\r\nimport { Sphere } from \"./sphere\";\r\n\r\nconst diff = new Vector3();\r\nconst edge1 = new Vector3();\r\nconst edge2 = new Vector3();\r\nconst normal = new Vector3();\r\n\r\nconst v1 = new Vector3();\r\n\r\nexport class Ray {\r\n  origin: Vector3;\r\n  direction: Vector3;\r\n\r\n  constructor(origin?: Vector3, direction?: Vector3) {\r\n    this.origin = (origin !== undefined) ? origin : new Vector3();\r\n    this.direction = (direction !== undefined) ? direction : new Vector3(0, 0, 1);\r\n  }\r\n\r\n  clone() {\r\n    return new Ray().copy(this);\r\n  }\r\n\r\n  copy(ray: Ray) {\r\n    this.origin.copy(ray.origin);\r\n    this.direction.copy(ray.direction);\r\n    return this;\r\n  }\r\n\r\n  lookAt(v: Vector3) {\r\n    this.direction.copy(v).sub(this.origin).normalize();\r\n    return this;\r\n  }\r\n\r\n  at(t: number, target: Vector3) {\r\n    return target.copy(this.direction).multiplyScalar(t).add(this.origin);\r\n  }\r\n\r\n  intersectTriangle(\r\n    a: Vector3, b: Vector3, c: Vector3,\r\n    backfaceCulling: boolean, target: Vector3) {\r\n    // from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\r\n    edge1.subVectors(b, a);\r\n    edge2.subVectors(c, a);\r\n    normal.crossVectors(edge1, edge2);\r\n\r\n    // Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n    // E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n    //   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n    //   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n    //   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n    var DdN = this.direction.dot(normal);\r\n    var sign;\r\n\r\n    if (DdN > 0) {\r\n      if (backfaceCulling) return null;\r\n      sign = 1;\r\n    } else if (DdN < 0) {\r\n      sign = - 1;\r\n      DdN = - DdN;\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n    diff.subVectors(this.origin, a);\r\n    var DdQxE2 = sign * this.direction.dot(edge2.crossVectors(diff, edge2));\r\n\r\n    // b1 < 0, no intersection\r\n    if (DdQxE2 < 0) {\r\n      return null;\r\n    }\r\n\r\n    var DdE1xQ = sign * this.direction.dot(edge1.cross(diff));\r\n\r\n    // b2 < 0, no intersection\r\n    if (DdE1xQ < 0) {\r\n      return null;\r\n    }\r\n\r\n    // b1+b2 > 1, no intersection\r\n    if (DdQxE2 + DdE1xQ > DdN) {\r\n      return null;\r\n    }\r\n\r\n    // Line intersects triangle, check if ray does.\r\n    var QdN = - sign * diff.dot(normal);\r\n\r\n    // t < 0, no intersection\r\n    if (QdN < 0) {\r\n      return null;\r\n    }\r\n\r\n    // Ray intersects triangle.\r\n    return this.at(QdN / DdN, target);\r\n\r\n  }\r\n\r\n  ifIntersectSphere(sphere: Sphere) {\r\n    return this.distanceSqToPoint(sphere.center) <= (sphere.radius * sphere.radius);\r\n  }\r\n\r\n  distanceToPoint(point: Vector3) {\r\n    return Math.sqrt(this.distanceSqToPoint(point));\r\n  }\r\n\r\n  distanceSqToPoint(point: Vector3) {\r\n    var directionDistance = v1.subVectors(point, this.origin).dot(this.direction);\r\n\r\n    // point behind the ray\r\n    if (directionDistance < 0) {\r\n      return this.origin.distanceToSquared(point);\r\n    }\r\n\r\n    v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);\r\n    return v1.distanceToSquared(point);\r\n  }\r\n\r\n  applyMatrix4(matrix4: Matrix4) {\r\n    this.origin.applyMatrix4(matrix4);\r\n    this.direction.transformDirection(matrix4);\r\n    return this;\r\n  }\r\n\r\n}","import { Vector3, Matrix4 } from \"../math/index\";\r\nimport { Nullable } from \"../type\";\r\nimport { Ray } from \"../math/entity/ray\";\r\nimport { RenderSource, foreachRenderableInSource } from \"../engine/render-engine\";\r\nimport { RenderObject } from \"./render-object\";\r\n\r\n\r\n\r\nexport interface RayCasterable {\r\n\r\n  /**\r\n   * mark this obj is raycasterable\r\n   */\r\n  raycasterable: true\r\n\r\n  /**\r\n   * check if this obj has any hit, should early return.\r\n   */\r\n  raycastIfHit(raycaster: Raycaster): boolean\r\n\r\n  /**\r\n   * get all raycast point on this obj, push the results in results array\r\n   */\r\n  raycast(raycaster: Raycaster, results: RayCastResult[]): RayCastResult[];\r\n\r\n  /**\r\n   * get first raycast point on this obj, return null if not hit\r\n   */\r\n  raycastFirst(raycaster: Raycaster): Nullable<RayCastResult>\r\n}\r\n\r\n\r\n/**\r\n * A general raycast result\r\n */\r\nexport interface RayCastResult {\r\n\r\n  /**\r\n   * hit object\r\n   */\r\n  object: RenderObject\r\n\r\n  /**\r\n  * The hit position in object's local space.\r\n  * When you need world space position, just multiply the world matrix from\r\n  * the object. This is done by your self for saving unnecessary computation\r\n  */\r\n  hitLocalPosition: Vector3\r\n}\r\n\r\nexport interface ScreenSpaceRayProvider {\r\n  updateRaycaster(caster: Raycaster, xRate: number, yRate: number): void;\r\n}\r\n\r\n\r\n/**\r\n * For raycast a given render source\r\n */\r\nexport class Raycaster {\r\n  near: number = 0;\r\n  far: number = 1;\r\n  worldRay: Ray = new Ray();\r\n  private localRay: Ray = new Ray();\r\n\r\n  update(rayProvider: ScreenSpaceRayProvider, xRate: number, yRate: number) {\r\n    rayProvider.updateRaycaster(this, xRate, yRate);\r\n  }\r\n\r\n  getLocalRay(worldMatrix: Matrix4): Readonly<Ray> {\r\n    return this.localRay.copy(this.worldRay).applyMatrix4(worldMatrix);\r\n  }\r\n\r\n  pick(source: RenderSource, preFilter?: (obj: RenderObject) => boolean) {\r\n    const results: RayCastResult[] = [];\r\n    foreachRenderableInSource(source, (obj) => {\r\n\r\n      if ((obj as unknown as RayCasterable).raycasterable !== true) {\r\n        return\r\n      }\r\n\r\n      if (preFilter !== undefined && !preFilter(obj)) {\r\n        return;\r\n      }\r\n\r\n      (obj as unknown as RayCasterable).raycast(this, results);\r\n\r\n    })\r\n    return results;\r\n  }\r\n\r\n  pickFirst(source: RenderSource, preFilter?: (obj: RenderObject) => boolean) {\r\n\r\n  }\r\n}","import {\r\n  RenderEngine, Mesh, PerspectiveCamera, OrbitController,\r\n  OBJLoader, Scene, Observable, Framer, Vector4\r\n} from '../../src/artgl';\r\n\r\nimport hierarchyBallBuilder from './scene/hierarchy-balls';\r\nimport { RenderPipeline } from './RenderPipeline';\r\nimport { Raycaster } from '../../src/core/raycaster';\r\n\r\nexport const STATIC_SERVER = \"http://localhost:3000/\"\r\n\r\nexport class Application {\r\n  pipeline: RenderPipeline;\r\n  engine: RenderEngine;\r\n  framer: Framer = new Framer();\r\n  el: HTMLCanvasElement;\r\n  hasInitialized: boolean = false;\r\n  scene: Scene = new Scene();\r\n  orbitController: OrbitController;\r\n  raycaster: Raycaster = new Raycaster();\r\n  backgroundColor: Vector4 = new Vector4();\r\n\r\n  initialize(canvas: HTMLCanvasElement) {\r\n    this.el = canvas;\r\n    this.engine = new RenderEngine(canvas);\r\n    this.pipeline = new RenderPipeline();\r\n    this.pipeline.build(this.engine, this.scene);\r\n    this.engine.camera.transform.position.set(20, 10, 10)\r\n    this.orbitController = new OrbitController(this.engine.camera as PerspectiveCamera);\r\n    this.orbitController.registerInteractor(this.engine.interactor);\r\n    this.hasInitialized = true;\r\n    this.createScene(this.scene);\r\n\r\n    window.addEventListener('resize', this.onContainerResize);\r\n    this.onContainerResize();\r\n    this.framer.setFrame(this.render);\r\n  }\r\n\r\n  unintialize() {\r\n    window.removeEventListener('resize', this.onContainerResize);\r\n    this.engine = null;\r\n    this.pipeline = null;\r\n    this.framer.stop();\r\n    this.framer.setFrame(null);\r\n    this.el = null;\r\n  }\r\n\r\n  private onContainerResize = () => {\r\n    const width = this.el.offsetWidth;\r\n    const height = this.el.offsetHeight;\r\n    this.engine.setSize(width, height);\r\n    (this.engine.camera as PerspectiveCamera).aspect = width / height;\r\n\r\n    // this.taaTech.uniforms.get('screenPixelXStep').setValue(1 / (2 * window.devicePixelRatio * width));\r\n    // this.taaTech.uniforms.get('screenPixelYStep').setValue(1 / (2 * window.devicePixelRatio * height));\r\n  }\r\n  notifyResize() {\r\n    this.onContainerResize();\r\n  }\r\n\r\n  sampleCount = 0;\r\n  beforeRender: Observable<RenderEngine> = new Observable();\r\n  afterRender: Observable<RenderEngine> = new Observable();\r\n  render = () => {\r\n    this.beforeRender.notifyObservers(this.engine);\r\n    this.orbitController.update();\r\n\r\n    this.engine.renderer.state.colorbuffer.setClearColor(this.backgroundColor);\r\n    this.pipeline.render(this.engine, this.scene);\r\n\r\n    this.afterRender.notifyObservers(this.engine);\r\n    this.engine.renderer.stat.reset();\r\n\r\n  }\r\n\r\n  pickColor(x: number, y: number) {\r\n    const f = this.engine.renderer.framebufferManager.getFramebuffer(\"sceneResult\");\r\n    const result = new Uint8Array(10);\r\n    f.readPixels(\r\n      x * this.engine.renderer.width,\r\n      y * this.engine.renderer.height,\r\n      1, 1, result);\r\n    console.log(`${result[0]}`)\r\n\r\n    this.raycaster.update(this.engine.camera as PerspectiveCamera, x * 2 - 1, y * 2 - 1);\r\n    const resultCast = this.raycaster.pick(this.scene);\r\n    console.log(resultCast);\r\n    // console.log(resultCast.map(re => re.object.geometry.constructor.name));\r\n  }\r\n\r\n  run() {\r\n    this.engine.interactor.enabled = true;\r\n    this.framer.run();\r\n  }\r\n\r\n  stop() {\r\n    this.engine.interactor.enabled = false;\r\n    this.framer.stop();\r\n  }\r\n\r\n  step() {\r\n    this.framer.step();\r\n  }\r\n\r\n  createScene(scene: Scene): Scene {\r\n    const config = hierarchyBallBuilder(scene.root, this);\r\n    // this.loadOBJFromURL();\r\n    this.pipeline.config.value.push(config);\r\n    return scene;\r\n  }\r\n\r\n  async loadOBJFromURL() {\r\n    const objLoader = new OBJLoader();\r\n    const response = await fetch(STATIC_SERVER + 'obj/chair.obj');\r\n    const result = await response.text();\r\n    const geo = objLoader.parse(result);\r\n    const mesh = new Mesh();\r\n    mesh.geometry = geo;\r\n    this.scene.root.addChild(mesh);\r\n  }\r\n\r\n}\r\n\r\nexport let GLApp: Application = new Application();","\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport Config from '../components/conf/config.vue';\r\nimport { GLApp } from '../application';\r\n@Component({\r\n  components:{\r\n    Config\r\n  }\r\n})\r\nexport default class ConfigPanel extends Vue {\r\n  @Prop() appConfig;\r\n  $store: any;\r\n\r\n  async hide(){\r\n    this.$store.state.showConfigPanel = false;\r\n    await this.$nextTick()\r\n    GLApp.notifyResize();\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config-panel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./config-panel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./config-panel.vue?vue&type=template&id=035897bd&scoped=true&\"\nimport script from \"./config-panel.vue?vue&type=script&lang=ts&\"\nexport * from \"./config-panel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./config-panel.vue?vue&type=style&index=0&id=035897bd&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"035897bd\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"scene-panel\"},[(!true)?_c('ObjectPanel'):_vm._e(),_c('div',{staticClass:\"panel-title\"},[_vm._v(\"Scene explorer\\n    \"),_c('button',{on:{\"click\":_vm.sync}},[_vm._v(\"sync\")]),_c('button',{on:{\"click\":_vm.hide}},[_vm._v(\"hide\")])]),_c('nav',{staticClass:\"scene-nav\"},_vm._l((_vm.nav),function(navitem){return _c('div',{key:navitem,class:{'current-nav': navitem===_vm.currentNav},on:{\"click\":function($event){_vm.currentNav = navitem}}},[_vm._v(_vm._s(navitem))])}),0),(_vm.sceneView)?_c('div',{staticClass:\"view-wrap\"},[(_vm.currentNav === 'hierarchy')?_c('NodeView',{attrs:{\"view\":_vm.sceneView.root},on:{\"nodeChange\":_vm.catchChange}}):_vm._e(),(_vm.currentNav === 'geometry')?_c('GeometryViewPanel',{attrs:{\"view\":_vm.sceneView}}):_vm._e(),(_vm.currentNav === 'material')?_c('MaterialViewPanel',{attrs:{\"view\":_vm.sceneView}}):_vm._e()],1):_vm._e(),_c('div',{staticClass:\"render-info\"},[_c('div',{staticClass:\"panel-title\"},[_vm._v(\"RenderInfo\")]),(_vm.renderView)?_c('div',{staticClass:\"render-info-group\"},[_c('div',[_vm._v(\"\\n        activeProgramCount: \"+_vm._s(_vm.renderView.compiledPrograms)+\"\\n      \")]),_c('div',[_vm._v(\"\\n        programswitch: \"+_vm._s(_vm.renderView.programSwitchCount)+\"\\n      \")]),_c('div',[_vm._v(\"\\n        drawcall: \"+_vm._s(_vm.renderView.drawcall)+\"\\n      \")]),_c('div',[_vm._v(\"\\n        uniformUpload: \"+_vm._s(_vm.renderView.uniformUpload)+\"\\n      \")]),_c('div',[_vm._v(\"\\n        faceDraw: \"+_vm._s(_vm.renderView.faceDraw)+\"\\n      \")]),_c('div',[_vm._v(\"\\n        vertexDraw: \"+_vm._s(_vm.renderView.vertexDraw)+\"\\n      \")])]):_c('div',{staticClass:\"render-info-group\"},[_vm._v(\"\\n      sync scene to get synced render info stat\\n    \")])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Vector3 } from '../../../src/math';\r\nimport { SceneNode } from '../../../src/scene/scene-node';\r\nimport { Scene } from '../../../src/scene/scene';\r\nimport { Mesh, OBJLoader, NormalShading, Geometry, Material, Shading } from '../../../src/artgl';\r\nimport { loadStringFromFile } from '../../../src/util/file-io';\r\n\r\n \r\nconst objLoader = new OBJLoader();\r\n\r\ninterface BufferView{\r\n  name: string\r\n  type: string,\r\n  dataByteSize: number;\r\n}\r\nexport class GeometryView{\r\n  uuid: string;\r\n  name: string;\r\n  buffers: BufferView[]\r\n  static create(geometry: Geometry): GeometryView {\r\n    const view = new GeometryView();\r\n    view.uuid = geometry.uuid;\r\n    view.name = geometry.name === undefined ? 'unnamed' : geometry.name;\r\n    view.buffers = [];\r\n    for (const key in geometry._bufferDatum) {\r\n      if (geometry._bufferDatum.hasOwnProperty(key)) {\r\n        const bufferdata = geometry._bufferDatum[key];\r\n        view.buffers.push({\r\n          name: key,\r\n          type: 'bufferdata',\r\n          dataByteSize: bufferdata.getDataSizeByte()\r\n        })\r\n      }\r\n    }\r\n    if (geometry.indexBuffer) {\r\n      view.buffers.push({\r\n        name: 'index',\r\n        type: 'indexbuffer',\r\n        dataByteSize: geometry.indexBuffer.getDataSizeByte()\r\n      })\r\n    }\r\n    return view;\r\n  }\r\n}\r\n\r\nexport class MaterialView{\r\n  uuid: string;\r\n  name: string;\r\n  static create(material: Material): MaterialView {\r\n    const view = new MaterialView();\r\n    view.uuid = material.uuid;\r\n    // view.name = geometry.name === undefined ? 'unnamed' : geometry.name;\r\n    // view.buffers = [];\r\n    // for (const key in geometry.bufferDatum) {\r\n    //   if (geometry.bufferDatum.hasOwnProperty(key)) {\r\n    //     const bufferdata = geometry.bufferDatum[key];\r\n    //     view.buffers.push({\r\n    //       name: key,\r\n    //       type: 'bufferdata',\r\n    //       dataByteSize: bufferdata.getDataSizeByte()\r\n    //     })\r\n    //   }\r\n    // }\r\n    return view;\r\n  }\r\n}\r\n\r\nexport class SceneView{\r\n  root: SceneNodeView\r\n  geometries: Map<string, GeometryView> = new Map();\r\n  materials: Map<string, MaterialView> = new Map();\r\n  \r\n  collectEntity(node: SceneNode) {\r\n    if (node instanceof Mesh) {\r\n      const geometry = node.geometry;\r\n      const material = node.material;\r\n      if (geometry !== undefined) {\r\n        if (!this.geometries.has(geometry.uuid)) {\r\n          this.geometries.set(geometry.uuid, GeometryView.create(geometry));\r\n        }\r\n      }\r\n      if (material !== undefined) {\r\n        if (!this.geometries.has(material.uuid)) {\r\n          this.materials.set(material.uuid, MaterialView.create(material));\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  static create(scene: Scene): SceneView {\r\n    const view = new SceneView();\r\n    view.root = scene.root.map((node: SceneNode) => {\r\n      view.collectEntity(node);\r\n      return SceneNodeView.create(node);\r\n    })\r\n    return view;\r\n  }\r\n\r\n  static deleteNode(id: string, scene: Scene) {\r\n    const result = scene.root.findSubNode(id);\r\n    if (result === undefined) {\r\n      return;\r\n    }\r\n    if (result.parent) {\r\n      result.parent.removeChild(result);\r\n    } else { // scene root\r\n      scene.setRootNode(new SceneNode())\r\n    }\r\n  }\r\n\r\n  static async loadObj(id: string, scene: Scene) {\r\n    const node = scene.root.findSubNode(id);\r\n    if (node === undefined) {\r\n      return;\r\n    }\r\n    const objstr = await loadStringFromFile();\r\n    if(!objstr && objstr.length === 0){\r\n      return ;\r\n    }\r\n    const geo = objLoader.parse(objstr);\r\n    const mesh = new Mesh();\r\n    mesh.geometry = geo;\r\n    mesh.shading = new Shading().decorate(new NormalShading());\r\n    node.addChild(mesh);\r\n  }\r\n}\r\n\r\nexport class SceneNodeView{\r\n  position = new Vector3();\r\n  uuid: string;\r\n  type = 'node';\r\n  \r\n  children: SceneNodeView[] = [];\r\n  static create(node: SceneNode): SceneNodeView{\r\n    const nodeview = new SceneNodeView();\r\n    nodeview.position.copy(node.transform.position);\r\n    nodeview.uuid = node.uuid;\r\n    if (node instanceof Mesh) {\r\n      nodeview.type = 'mesh'\r\n    }\r\n    return nodeview;\r\n  }\r\n\r\n}","import { RenderEngine } from '../../../src/artgl';\r\n\r\nexport class RenderView{\r\n  compiledPrograms: number;\r\n  programSwitchCount: number;\r\n  uniformUpload: number;\r\n  drawcall: number;\r\n\r\n  faceDraw: number = 0;\r\n  vertexDraw: number = 0;\r\n\r\n  static create(engine: RenderEngine) {\r\n    const renderer = engine.renderer;\r\n    const view = new RenderView;\r\n    view.compiledPrograms = renderer.programManager.compiledProgramsCount;\r\n    view.updateFrameInfo(engine);\r\n    return view;\r\n  }\r\n\r\n  updateFrameInfo(engine: RenderEngine) {\r\n    this.programSwitchCount = engine.renderer.stat.programSwitch;\r\n    this.uniformUpload = engine.renderer.stat.uniformUpload;\r\n    this.drawcall = engine.renderer.stat.drawcall;\r\n    this.faceDraw = engine.renderer.stat.faceDraw;\r\n    this.vertexDraw = engine.renderer.stat.vertexDraw;\r\n  }\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"geometry-view\"},_vm._l((_vm.geometrylist),function(geometry){return _c('div',{key:geometry.uuid},[_c('span',[_vm._v(\"\\n    \"+_vm._s(geometry.name)+\"-\"+_vm._s(geometry.uuid.slice(0, 6))+\"\\n  \")]),(_vm.expandDetail)?_c('div',{staticClass:\"buffer-detail\"},_vm._l((geometry.buffers),function(bufferinfo){return _c('div',{key:bufferinfo.name},[_vm._v(\"\\n      \"+_vm._s(bufferinfo.name)+\" - \"+_vm._s(Math.ceil(bufferinfo.dataByteSize / 1024 * 10)/ 10)+\"KB\\n      \")])}),0):_vm._e()])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { SceneView, GeometryView } from \"../../model/scene-view\";\r\n\r\n@Component({\r\n  components: {\r\n  }\r\n})\r\nexport default class GeometryViewPanel extends Vue {\r\n  @Prop() view: SceneView\r\n\r\n  expandDetail = true;\r\n\r\n  get geometrylist(){\r\n    const list = [];\r\n    this.view.geometries.forEach(geo =>{\r\n      list.push(geo);\r\n    })\r\n    return list;\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./geometry-view.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./geometry-view.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./geometry-view.vue?vue&type=template&id=6d5074e5&scoped=true&\"\nimport script from \"./geometry-view.vue?vue&type=script&lang=ts&\"\nexport * from \"./geometry-view.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./geometry-view.vue?vue&type=style&index=0&id=6d5074e5&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6d5074e5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"material-view\"},[(_vm.materiallist.length===0)?_c('div',[_vm._v(\"\\n    no material found\\n  \")]):_vm._e(),_vm._l((_vm.materiallist),function(material){return _c('div',{key:material.uuid},[_c('span',[_vm._v(\"\\n      \"+_vm._s(material.name)+\"-\"+_vm._s(material.uuid.slice(0, 6))+\"\\n    \")]),(_vm.expandDetail)?_c('div',{staticClass:\"channel-detail\"}):_vm._e()])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('button',[_vm._v(\"upload\")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nexport default class ChannelEditor extends Vue {\r\n\r\n}\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./channel-editor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./channel-editor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./channel-editor.vue?vue&type=template&id=533c6709&\"\nimport script from \"./channel-editor.vue?vue&type=script&lang=ts&\"\nexport * from \"./channel-editor.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { SceneView, MaterialView } from \"../../model/scene-view\";\r\nimport ChannelEditor from \"./channel-editor.vue\";\r\n\r\n@Component({\r\n  components: {\r\n    ChannelEditor\r\n  }\r\n})\r\nexport default class materialViewPanel extends Vue {\r\n  @Prop() view: SceneView\r\n\r\n  expandDetail = true;\r\n\r\n  get materiallist(){\r\n    const list = [];\r\n    this.view.materials.forEach(mat =>{\r\n      list.push(mat);\r\n    })\r\n    return list;\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./material-view.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./material-view.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./material-view.vue?vue&type=template&id=2b822b43&scoped=true&\"\nimport script from \"./material-view.vue?vue&type=script&lang=ts&\"\nexport * from \"./material-view.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2b822b43\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"object-panel\"},[_c('button',[_vm._v(\"X\")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\n@Component({\r\n  components:{\r\n  }\r\n})\r\nexport default class ObjectPanel extends Vue {\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./object-panel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./object-panel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./object-panel.vue?vue&type=template&id=1d29f434&scoped=true&\"\nimport script from \"./object-panel.vue?vue&type=script&lang=ts&\"\nexport * from \"./object-panel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./object-panel.vue?vue&type=style&index=0&id=1d29f434&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1d29f434\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"node-view\"},[_c('div',{staticClass:\"title\"},[_c('div',{class:{'expandable': _vm.hasChildren},on:{\"click\":function($event){_vm.isExpand = !_vm.isExpand}}},[(_vm.hasChildren && !_vm.isExpand)?_c('span',[_vm._v(\" + \")]):_vm._e(),(_vm.hasChildren && _vm.isExpand)?_c('span',[_vm._v(\" = \")]):_vm._e(),_vm._v(\"\\n\\n      \"+_vm._s(_vm.view.type)+\" - \"+_vm._s(_vm.clampId)+\"\\n    \")]),_c('button',{on:{\"click\":function($event){_vm.showMenu = true}}},[_vm._v(\"*\")])]),(_vm.showMenu)?_c('div',{staticClass:\"menu\"},[_c('button',{on:{\"click\":_vm.emitDelete}},[_vm._v(\"delete\")]),_c('button',{on:{\"click\":_vm.emitLoadObj}},[_vm._v(\"loadobj\")])]):_vm._e(),(_vm.showMenu)?_c('div',{staticClass:\"mask\",on:{\"click\":function($event){_vm.showMenu = false}}}):_vm._e(),(_vm.isExpand)?_c('div',{staticClass:\"children\"},_vm._l((_vm.view.children),function(child){return _c('scene-node-view',{key:child.uuid,attrs:{\"view\":child},on:{\"nodeChange\":_vm.emitChange}})}),1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport { SceneNodeView } from '../../model/scene-view';\r\n@Component({\r\n  name:'scene-node-view'\r\n})\r\nexport default class BooleanEditor extends Vue {\r\n  @Prop() view: SceneNodeView;\r\n\r\n  showMenu = false;\r\n\r\n  get clampId(){\r\n    return this.view.uuid.slice(0, 6);\r\n  }\r\n  isExpand:boolean = true;\r\n\r\n  get hasChildren(){\r\n    return this.view.children.length;\r\n  }\r\n\r\n  emitLoadObj(){\r\n    this.emitChange({\r\n      type: 'load',\r\n      id: this.view.uuid\r\n    })\r\n  }\r\n\r\n  emitDelete(){\r\n    this.emitChange({\r\n      type: 'delete',\r\n      id: this.view.uuid\r\n    })\r\n  }\r\n\r\n  emitChange(info){\r\n    this.$emit('nodeChange', info);\r\n    this.showMenu = false;\r\n  }\r\n}\r\n\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-node-view.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-node-view.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./scene-node-view.vue?vue&type=template&id=85464e1a&scoped=true&\"\nimport script from \"./scene-node-view.vue?vue&type=script&lang=ts&\"\nexport * from \"./scene-node-view.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./scene-node-view.vue?vue&type=style&index=0&id=85464e1a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"85464e1a\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { SceneView } from \"../../model/scene-view\";\r\nimport { RenderView } from \"../../model/render-view\";\r\nimport GeometryViewPanel from './geometry-view.vue';\r\nimport MaterialViewPanel from './material-view.vue';\r\nimport ObjectPanel from \"../object-panel/object-panel.vue\";\r\nimport { GLApp } from \"../../application\";\r\nimport NodeView from \"./scene-node-view.vue\";\r\nimport { Observer } from \"../../../../src/core/observable\";\r\nimport { RenderEngine } from \"../../../../src/artgl\";\r\n\r\n@Component({\r\n  components: {\r\n    NodeView,\r\n    ObjectPanel,\r\n    GeometryViewPanel,\r\n    MaterialViewPanel\r\n  }\r\n})\r\nexport default class ScenePanel extends Vue {\r\n  sceneView: SceneView = null;\r\n  renderView: RenderView = null;\r\n  afterObs:Observer<RenderEngine>\r\n\r\n  nav = ['hierarchy', 'technique','geometry','material'];\r\n  currentNav = 'hierarchy'\r\n  $store: any;\r\n\r\n  sync() {\r\n    this.sceneView = SceneView.create(GLApp.scene);\r\n    this.renderView = RenderView.create(GLApp.engine);\r\n    if(this.afterObs){\r\n      GLApp.afterRender.remove(this.afterObs);\r\n    }\r\n    this.afterObs = GLApp.afterRender.add((engine:RenderEngine)=>{\r\n      this.renderView.updateFrameInfo(engine);\r\n    });\r\n  }\r\n\r\n  async hide(){\r\n    this.$store.state.showScenePanel = false;\r\n    await this.$nextTick()\r\n    GLApp.notifyResize();\r\n  }\r\n\r\n  beforeDestroy(){\r\n    if(this.afterObs){\r\n      GLApp.afterRender.remove(this.afterObs);\r\n    }\r\n  }\r\n\r\n  async catchChange(info) {\r\n    if (info.type === \"delete\") {\r\n      SceneView.deleteNode(info.id, GLApp.scene);\r\n    } else if (info.type === \"load\") {\r\n      await SceneView.loadObj(info.id, GLApp.scene);\r\n    } else {\r\n      console.log(\"unkown change\");\r\n      console.log(info);\r\n    }\r\n    this.sync();\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-panel.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene-panel.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./scene-panel.vue?vue&type=template&id=2e8def07&scoped=true&\"\nimport script from \"./scene-panel.vue?vue&type=script&lang=ts&\"\nexport * from \"./scene-panel.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./scene-panel.vue?vue&type=style&index=0&id=2e8def07&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2e8def07\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"canvas-wrap\"},[_c('canvas',{attrs:{\"id\":\"viewer-canvas\"},on:{\"click\":_vm.pick}}),(!_vm.isRunning)?_c('div',{staticClass:\"stop-notation\"},[_vm._v(\"STOPPED\")]):_vm._e(),(_vm.showGraphViewer)?_c('div',{staticClass:\"graph-viewer-wrap\"},[_c('div',{staticStyle:{\"position\":\"absolute\",\"bottom\":\"0px\",\"pointer-events\":\"auto\"}},[_c('button',{on:{\"click\":_vm.layout}},[_vm._v(\"layout\")])]),_c('GraphView',{attrs:{\"board\":_vm.board},on:{\"updateAllViewport\":_vm.updateAllViewport}},_vm._l((_vm.nodes),function(nodeView){return _c('DAGNodeView',{key:nodeView.node.uuid,ref:\"vueNodes\",refInFor:true,attrs:{\"node\":nodeView.node,\"layout\":nodeView.layout,\"boardInfo\":_vm.board},on:{\"updateViewport\":_vm.updateViewport,\"updateLine\":_vm.updateLine}},[(_vm.isRenderTargetNode(nodeView.node))?_c('RenderTargetNodeView',{attrs:{\"node\":nodeView.node,\"layout\":nodeView.layout},on:{\"updateSize\":_vm.updateViewport}}):_vm._e()],1)}),1),_c('LineHUDCanvas',{attrs:{\"lines\":_vm.lines,\"boardInfo\":_vm.board}})],1):_vm._e(),_c('div',{staticClass:\"command-bar\"},[(!_vm.isRunning)?_c('button',{on:{\"click\":_vm.run}},[_vm._v(\"run\")]):_vm._e(),(_vm.isRunning)?_c('button',{on:{\"click\":_vm.stop}},[_vm._v(\"stop\")]):_vm._e(),(!_vm.isRunning)?_c('button',{on:{\"click\":_vm.step}},[_vm._v(\"step next frame\")]):_vm._e(),(!_vm.isRunning)?_c('button',{attrs:{\"disabled\":\"\"},on:{\"click\":_vm.screenshot}},[_vm._v(\"download screenshot\")]):_vm._e(),(!_vm.showGraphViewer)?_c('button',{on:{\"click\":_vm.inspectGraph}},[_vm._v(\"inspectGraph\")]):_vm._e(),(_vm.showGraphViewer)?_c('button',{on:{\"click\":_vm.closeGraphInspector}},[_vm._v(\"closeGraphViewer\")]):_vm._e(),_c('button',{on:{\"click\":_vm.showScenePanel}},[_vm._v(\"show scene panel\")]),_c('button',{on:{\"click\":_vm.showConfigPanel}},[_vm._v(\"show config panel\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"graph-viewer\",attrs:{\"tabindex\":\"-1\"}},[_c('div',{style:({\n        transform: _vm.transform\n      })},[_vm._t(\"default\")],2),(_vm.showMove)?_c('div',{staticClass:\"mask\",on:{\"mousedown\":_vm.startDrag}}):_vm._e(),_c('div',{staticClass:\"ops\"},[(!_vm.showMove)?_c('button',{on:{\"click\":function($event){_vm.showMove = true}}},[_vm._v(\"move\")]):_vm._e(),(_vm.showMove)?_c('button',{on:{\"click\":function($event){_vm.showMove = false}}},[_vm._v(\"unmove\")]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { Vector4 } from \"../../../../src/math\";\r\nimport { GraphBoardInfo } from \"../../model/graph-view\";\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class GraphViewer extends Vue {\r\n  @Prop({ required: true }) board: GraphBoardInfo;\r\n\r\n  get transform() {\r\n    return `translate(${this.board.transformX}px, ${this.board.transformY}px)`;\r\n  }\r\n\r\n  showMove = false;\r\n\r\n  isDragging = false;\r\n  originTransformX: number;\r\n  originTransformY: number;\r\n  screenOriginX: number;\r\n  screenOriginY: number;\r\n  startDrag(e) {\r\n    this.isDragging = true;\r\n    this.screenOriginX = e.screenX;\r\n    this.screenOriginY = e.screenY;\r\n    this.originTransformX = this.board.transformX;\r\n    this.originTransformY = this.board.transformY;\r\n    window.addEventListener(\"mousemove\", this.dragging);\r\n    window.addEventListener(\"mouseup\", e => {\r\n      this.isDragging = false;\r\n      window.removeEventListener(\"mousemove\", this.dragging);\r\n    });\r\n  }\r\n\r\n  dragging(e) {\r\n    this.board.transformX =\r\n      this.originTransformX + e.screenX - this.screenOriginX;\r\n    this.board.transformY =\r\n      this.originTransformY + e.screenY - this.screenOriginY;\r\n    this.$emit(\"updateAllViewport\");\r\n  }\r\n\r\n  mounted() {\r\n    this.updateBoard();\r\n    window.addEventListener(\"resize\", this.updateBoard)\r\n  }\r\n\r\n  beforeDestroy(){\r\n    window.removeEventListener(\"resize\", this.updateBoard)\r\n  }\r\n\r\n  updateBoard() {\r\n    this.board.width = this.$el.clientWidth;\r\n    this.board.height = this.$el.clientHeight;\r\n    this.$emit(\"updateAllViewport\");\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./graph-viewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./graph-viewer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./graph-viewer.vue?vue&type=template&id=20b4d88e&scoped=true&\"\nimport script from \"./graph-viewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./graph-viewer.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./graph-viewer.vue?vue&type=style&index=0&id=20b4d88e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"20b4d88e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"dag-node\",style:({\n  left: _vm.viewPositionX,\n  top: _vm.viewPositionY,\n  width: _vm.viewWidth,\n })},[_c('div',{staticClass:\"node-title\",style:({cursor: this.isDragging? 'grabbing': ''}),on:{\"mousedown\":_vm.startDrag}},[_c('span',[_vm._v(_vm._s(_vm.node.constructor.name)+\": \"+_vm._s(_vm.node.uuid.slice(0,4)))])]),_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { DAGNode } from '../../../src/core/dag-node';\r\n\r\nexport interface GraphBoardInfo {\r\n  width: number,\r\n  height: number,\r\n  transformX: number,\r\n  transformY: number,\r\n}\r\n\r\nexport interface NodeLayout {\r\n  absX: number,\r\n  absY: number,\r\n  width: number,\r\n  height: number,\r\n}\r\n\r\nexport function getRightEnd(layout: NodeLayout) {\r\n  return {\r\n    x: layout.absX + layout.width,\r\n    y: layout.absY + 10,\r\n  }\r\n}\r\n\r\nexport interface ViewNode {\r\n  node: DAGNode;\r\n  layout: NodeLayout;\r\n}\r\n\r\n\r\nexport function layoutGraph(\r\n  rootNode: DAGNode,\r\n  layoutNodeMap: { [index: string]: NodeLayout },\r\n  gridSize = 300\r\n) {\r\n\r\n  const horizonArray: Array<Array<DAGNode>> = [];\r\n  function removeItem(node: DAGNode) {\r\n    horizonArray.forEach((row: DAGNode[]) => {\r\n      const index = row.indexOf(node);\r\n      if (index !== -1) {\r\n        row.splice(index, 1)\r\n      }\r\n    })\r\n  }\r\n  function addNode(node: DAGNode, horizonPosition: number) {\r\n    let arr = horizonArray[horizonPosition];\r\n    if (arr === undefined) {\r\n      horizonArray[horizonPosition] = [];\r\n      arr = horizonArray[horizonPosition];\r\n    }\r\n    removeItem(node);\r\n    arr.push(node)\r\n\r\n    node.fromNodes.forEach(input => {\r\n      addNode(input, horizonPosition + 1);\r\n    })\r\n  }\r\n  addNode(rootNode, 0);\r\n  horizonArray.reverse().forEach((row, indexRow) => {\r\n    row.forEach((item, indexY) => {\r\n\r\n      const layout = layoutNodeMap[item.uuid]\r\n      if (layout === undefined) {\r\n        throw 'cant find nodes layout'\r\n      }\r\n\r\n      layout.absX = indexRow * gridSize;\r\n      layout.absY = indexY * gridSize\r\n    })\r\n  })\r\n}\r\n\r\n\r\nexport class ConnectionLine {\r\n  startX: number = 0;\r\n  startY: number = 0;\r\n  endX: number = 0;\r\n  endY: number = 0;\r\n\r\n  draw(hud: LinesHUD, boardInfo: GraphBoardInfo) {\r\n    const ctx = hud.ctx;\r\n    ctx.beginPath();\r\n    ctx.moveTo(this.startX + boardInfo.transformX, this.startY + boardInfo.transformY);\r\n    ctx.lineTo(this.endX + boardInfo.transformX, this.endY + boardInfo.transformY);\r\n    ctx.stroke();\r\n  }\r\n}\r\n\r\nexport class LinesHUD {\r\n  constructor(el: HTMLCanvasElement) {\r\n    this.el = el;\r\n    this.ctx = el.getContext('2d');\r\n  }\r\n  el: HTMLCanvasElement;\r\n  ctx: CanvasRenderingContext2D;\r\n  width: number = 0;\r\n  height: number = 0;\r\n\r\n  clear() {\r\n    this.ctx.clearRect(0, 0, this.width, this.height);\r\n  }\r\n\r\n  draw(lines: ConnectionLine[], boardInfo: GraphBoardInfo) {\r\n    this.clear();\r\n    lines.forEach(line => line.draw(this, boardInfo));\r\n  }\r\n}","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue, InjectReactive } from \"vue-property-decorator\";\r\nimport { ShaderGraph, ShaderNode, DAGNode } from \"../../../../src/artgl\";\r\nimport {\r\n  NodeLayout,\r\n  GraphBoardInfo,\r\n  ViewNode,\r\n  ConnectionLine,\r\n  getRightEnd\r\n} from \"../../model/graph-view\";\r\nimport { findFirst } from \"../../../../src/util/array\";\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class DAGNodeView extends Vue {\r\n  @InjectReactive() nodes: ViewNode[];\r\n  @InjectReactive() lines: ConnectionLine[];\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  node: DAGNode;\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  layout: NodeLayout;\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  boardInfo: GraphBoardInfo;\r\n\r\n  @Prop({\r\n    required: false,\r\n    default: true\r\n  })\r\n  editable: boolean;\r\n\r\n  getNodesLayout(node: DAGNode) {\r\n    return findFirst(this.nodes, vn => {\r\n      return vn.node === node;\r\n    }).layout;\r\n  }\r\n\r\n  getLines(): ConnectionLine[] {\r\n    return this.inputs.map(inputNode => {\r\n      const rightCenter = getRightEnd(this.getNodesLayout(inputNode));\r\n      const line = new ConnectionLine();\r\n      line.startX = rightCenter.x;\r\n      line.startY = rightCenter.y;\r\n      line.endX = this.layout.absX;\r\n      line.endY = this.layout.absY;\r\n      return line;\r\n    });\r\n  }\r\n\r\n  selfLines: ConnectionLine[] = [];\r\n  updateLine() {\r\n    this.selfLines.forEach(line => {\r\n      const position = this.lines.indexOf(line);\r\n      if (position !== -1) {\r\n        this.lines.splice(position, 1);\r\n      }\r\n    });\r\n    this.selfLines = this.getLines();\r\n    this.selfLines.forEach(line => {\r\n      this.lines.push(line);\r\n    });\r\n  }\r\n\r\n  mounted() {\r\n    this.updateLine();\r\n  }\r\n\r\n  get inputs(): DAGNode[] {\r\n    const results = [];\r\n    this.node.fromNodes.forEach(value => {\r\n      results.push(value);\r\n    });\r\n    return results;\r\n  }\r\n\r\n  get viewPositionX() {\r\n    return this.layout.absX + \"px\";\r\n  }\r\n  get viewPositionY() {\r\n    return this.layout.absY + \"px\";\r\n  }\r\n\r\n  get viewWidth() {\r\n    return this.layout.width + \"px\";\r\n  }\r\n  get viewHeight() {\r\n    return this.layout.height + \"px\";\r\n  }\r\n\r\n  isDragging: boolean = false;\r\n  originX = 0;\r\n  originY = 0;\r\n  screenOriginX = 0;\r\n  screenOriginY = 0;\r\n  startDrag(e: MouseEvent) {\r\n    this.isDragging = true;\r\n    this.originX = this.layout.absX;\r\n    this.originY = this.layout.absY;\r\n    this.screenOriginX = e.screenX;\r\n    this.screenOriginY = e.screenY;\r\n    window.addEventListener(\"mousemove\", this.dragging);\r\n    window.addEventListener(\"mouseup\", e => {\r\n      this.isDragging = false;\r\n      window.removeEventListener(\"mousemove\", this.dragging);\r\n    });\r\n  }\r\n\r\n  dragging(e: MouseEvent) {\r\n    this.layout.absX = this.originX + e.screenX - this.screenOriginX;\r\n    this.layout.absY = this.originY + e.screenY - this.screenOriginY;\r\n    this.$emit(\"updateViewport\", { node: this.node, layout: this.layout });\r\n    this.$emit(\"updateLine\", this.node)\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dag-node.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dag-node.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./dag-node.vue?vue&type=template&id=f08e55ee&scoped=true&\"\nimport script from \"./dag-node.vue?vue&type=script&lang=ts&\"\nexport * from \"./dag-node.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./dag-node.vue?vue&type=style&index=0&id=f08e55ee&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f08e55ee\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{staticClass:\"lines-hud\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { LinesHUD, ConnectionLine, GraphBoardInfo } from \"../model/graph-view\";\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class LineHUDCanvas extends Vue {\r\n  HUD: LinesHUD;\r\n  isRunning: boolean = true;\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  lines: ConnectionLine[];\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  boardInfo: GraphBoardInfo;\r\n\r\n  mounted() {\r\n    this.HUD = new LinesHUD(this.$el as HTMLCanvasElement);\r\n    window.addEventListener(\"resize\", this.updateSize);\r\n    window.requestAnimationFrame(this.draw);\r\n    this.updateSize();\r\n  }\r\n\r\n  beforeDestroy() {\r\n    this.isRunning = false;\r\n  }\r\n\r\n  updateSize() {\r\n    const el = this.$el as HTMLCanvasElement;\r\n    this.HUD.width = el.clientWidth;\r\n    this.HUD.height = el.clientHeight;\r\n    el.width = el.clientWidth;\r\n    el.height = el.clientHeight;\r\n  }\r\n\r\n  draw() {\r\n    this.HUD.draw(this.lines, this.boardInfo);\r\n    if (this.isRunning) {\r\n      window.requestAnimationFrame(this.draw);\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./line-hud-canvas.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./line-hud-canvas.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./line-hud-canvas.vue?vue&type=template&id=4cfbac3a&scoped=true&\"\nimport script from \"./line-hud-canvas.vue?vue&type=script&lang=ts&\"\nexport * from \"./line-hud-canvas.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./line-hud-canvas.vue?vue&type=style&index=0&id=4cfbac3a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4cfbac3a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\"\\n  \"+_vm._s(_vm.node.name)+\"\\n  \"),_c('button',{on:{\"click\":_vm.actualSize}},[_vm._v(\"actual size\")]),_c('button',{on:{\"click\":_vm.defaultSize}},[_vm._v(\"default size\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { DAGNode, RenderTargetNode } from \"../../../../../src/artgl\";\r\nimport { NodeLayout, GraphBoardInfo } from \"../../../model/graph-view\";\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class RenderTargetNodeView extends Vue {\r\n  @Prop({\r\n    required: true\r\n  })\r\n  node: RenderTargetNode;\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  layout: NodeLayout;\r\n  \r\n  actualSize() {\r\n    this.layout.width = this.node.widthAbs / 2 / window.devicePixelRatio;\r\n    this.layout.height = this.node.heightAbs / 2 / window.devicePixelRatio;\r\n    this.$emit(\"updateSize\", {\r\n      node: this.node,\r\n      layout: this.layout,\r\n    });\r\n  }\r\n\r\n  defaultSize() {\r\n    this.layout.width = 200;\r\n    this.layout.height = 200;\r\n    this.$emit(\"updateSize\", {\r\n      node: this.node,\r\n      layout: this.layout,\r\n    });\r\n  }\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/ts-loader/index.js??ref--12-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./render-target-node.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/ts-loader/index.js??ref--12-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./render-target-node.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./render-target-node.vue?vue&type=template&id=69d673c4&scoped=true&\"\nimport script from \"./render-target-node.vue?vue&type=script&lang=ts&\"\nexport * from \"./render-target-node.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"69d673c4\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue, ProvideReactive } from \"vue-property-decorator\";\r\nimport { GLApp } from \"../application\";\r\nimport GraphView from \"../components/graph/graph-viewer.vue\";\r\nimport DAGNodeView from \"../components/graph/dag-node.vue\";\r\nimport LineHUDCanvas from \"./line-hud-canvas.vue\";\r\nimport RenderTargetNodeView from \"../components/graph/nodes/render-target-node.vue\";\r\nimport {\r\n  GraphBoardInfo,\r\n  ViewNode,\r\n  layoutGraph,\r\n  NodeLayout,\r\n  ConnectionLine\r\n} from \"../model/graph-view\";\r\nimport { RenderTargetNode } from \"../../../src/render-graph/node/render-target-node\";\r\nimport { Vector4, DAGNode } from \"../../../src/artgl\";\r\n\r\n@Component({\r\n  components: {\r\n    GraphView,\r\n    DAGNodeView,\r\n    RenderTargetNodeView,\r\n    LineHUDCanvas\r\n  }\r\n})\r\nexport default class ViewerCanvas extends Vue {\r\n  isRunning: boolean = GLApp.framer.active;\r\n  $store: any;\r\n\r\n  async showScenePanel() {\r\n    this.$store.state.showScenePanel = true;\r\n    await this.$nextTick();\r\n    GLApp.notifyResize();\r\n  }\r\n\r\n  async showConfigPanel() {\r\n    this.$store.state.showConfigPanel = true;\r\n    await this.$nextTick();\r\n    GLApp.notifyResize();\r\n  }\r\n\r\n  pick(e: MouseEvent) {\r\n    const canvas = this.$el.querySelector(\"canvas\");\r\n    GLApp.pickColor(\r\n      e.offsetX / canvas.clientWidth, \r\n      (canvas.clientHeight - e.offsetY) / canvas.clientHeight\r\n    );\r\n  }\r\n\r\n  showGraphViewer: boolean = false;\r\n  board: GraphBoardInfo = {\r\n    width: 0,\r\n    height: 0,\r\n    transformX: 0,\r\n    transformY: 0\r\n  };\r\n\r\n  @ProvideReactive() nodes: ViewNode[] = [];\r\n  @ProvideReactive() lines: ConnectionLine[] = [];\r\n\r\n  updateViewport({ node, layout }) {\r\n    if (node instanceof RenderTargetNode) {\r\n      const viewport = new Vector4();\r\n      const l = layout as NodeLayout;\r\n      const n = node as RenderTargetNode;\r\n      viewport.set(\r\n        l.absX + this.board.transformX,\r\n        this.board.height - l.absY - l.height - this.board.transformY,\r\n        l.width,\r\n        l.height\r\n      );\r\n      viewport.multiplyScalar(window.devicePixelRatio);\r\n      n.debugViewPort.copy(viewport);\r\n    }\r\n  }\r\n\r\n  updateLine(node: DAGNode){\r\n    this.notifyNodeNeedUpdateLine(node)\r\n    node.toNodes.forEach(no =>{\r\n      this.notifyNodeNeedUpdateLine(no);\r\n    })\r\n  }\r\n\r\n  notifyNodeNeedUpdateLine(n: DAGNode){\r\n    if(this.$refs.vueNodes){\r\n      for (let i = 0; i < (this.$refs.vueNodes as Array<DAGNodeView>).length; i++) {\r\n        const v = this.$refs.vueNodes[i];\r\n        if(v.node === n){\r\n          v.updateLine();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  updateAllViewport() {\r\n    this.nodes.forEach(node => {\r\n      this.updateViewport(node);\r\n    });\r\n  }\r\n\r\n  layout() {\r\n    const map = {};\r\n    this.nodes.forEach(node => {\r\n      map[node.node.uuid] = node.layout;\r\n    });\r\n    layoutGraph(GLApp.pipeline.graph.screenNode, map);\r\n    this.updateAllViewport();\r\n    \r\n    this.nodes.forEach(node => this.updateLine(node.node))\r\n  }\r\n\r\n  isRenderTargetNode(node) {\r\n    return node instanceof RenderTargetNode;\r\n  }\r\n\r\n  inspectGraph() {\r\n    GLApp.pipeline.graph.enableDebuggingView = true;\r\n    const nodes = GLApp.pipeline.graph.nodes;\r\n    this.nodes = nodes.map(node => {\r\n      return {\r\n        node,\r\n        layout: {\r\n          absX: 0,\r\n          absY: 0,\r\n          width: 200,\r\n          height: 200\r\n        }\r\n      };\r\n    });\r\n    this.showGraphViewer = true;\r\n    this.layout();\r\n  }\r\n\r\n  closeGraphInspector() {\r\n    GLApp.pipeline.graph.enableDebuggingView = false;\r\n    this.showGraphViewer = false;\r\n  }\r\n\r\n  run() {\r\n    GLApp.run();\r\n    this.isRunning = true;\r\n  }\r\n\r\n  stop() {\r\n    GLApp.stop();\r\n    this.isRunning = false;\r\n  }\r\n\r\n  step() {\r\n    GLApp.step();\r\n  }\r\n\r\n  screenshot() {\r\n    GLApp.engine.downloadCurrentRender();\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer-canvas.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer-canvas.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./viewer-canvas.vue?vue&type=template&id=0bf133fc&scoped=true&\"\nimport script from \"./viewer-canvas.vue?vue&type=script&lang=ts&\"\nexport * from \"./viewer-canvas.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./viewer-canvas.vue?vue&type=style&index=0&id=0bf133fc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0bf133fc\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport ConfigPanel from './config-panel.vue'\r\nimport ScenePanel from './scene-panel/scene-panel.vue'\r\nimport ObjectPanel from './object-panel/object-panel.vue'\r\nimport ViewerCanvas from './viewer-canvas.vue'\r\nimport {GLApp} from '../application';\r\nimport { RenderConfig } from '../components/conf/interface';\r\n\r\n@Component({\r\n  components:{\r\n    ConfigPanel, ScenePanel, ViewerCanvas, ObjectPanel\r\n  }\r\n})\r\nexport default class Viewer extends Vue {\r\n  mounted(){\r\n    const canvas = this.$el.querySelector('#viewer-canvas') as HTMLCanvasElement;\r\n    GLApp.initialize(canvas);\r\n    this.appConf = GLApp.pipeline.config;\r\n  }\r\n\r\n  appConf: RenderConfig = {\r\n    name: 'root',\r\n    type: 'folder',\r\n    value: []\r\n  };\r\n\r\n  \r\n  beforeDestroy(){\r\n    GLApp.unintialize();\r\n  }\r\n\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./viewer.vue?vue&type=template&id=5760c40d&scoped=true&\"\nimport script from \"./viewer.vue?vue&type=script&lang=ts&\"\nexport * from \"./viewer.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./viewer.vue?vue&type=style&index=0&id=5760c40d&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5760c40d\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"shader-graph\"},[_c('div',{staticClass:\"editor\"},[_c('button',{on:{\"click\":_vm.layout}},[_vm._v(\"relayout\")]),_c('div',[_c('button',{on:{\"click\":_vm.addUniform}},[_vm._v(\"uniform\")]),_c('button',[_vm._v(\"attribute\")])]),_c('div',{staticStyle:{\"position\":\"absolute\",\"top\":\"0px\",\"width\":\"100%\",\"height\":\"100%\"}},[_c('LineHUDCanvas',{attrs:{\"lines\":_vm.lines,\"boardInfo\":_vm.board}}),_c('GraphView',{attrs:{\"board\":_vm.board}},_vm._l((_vm.nodes),function(nodeView){return _c('DAGNodeView',{key:nodeView.node.uuid,ref:\"vueNodes\",refInFor:true,attrs:{\"node\":nodeView.node,\"layout\":nodeView.layout,\"boardInfo\":_vm.board},on:{\"updateViewport\":function($event){return _vm.updateViewport(nodeView)},\"updateLine\":_vm.updateLine}},[(_vm.isShaderFunctionNode(nodeView.node))?_c('ShaderFunctionNodeView',{attrs:{\"node\":nodeView.node,\"layout\":nodeView.layout},on:{\"updateSize\":_vm.updateViewport}}):_vm._e()],1)}),1)],1)]),_c('div',{staticClass:\"viewer\"},[_c('h1',[_vm._v(\"viewer\")]),(_vm.showCode)?_c('button',{on:{\"click\":function($event){_vm.showCode = false}}},[_vm._v(\"canvas\")]):_c('button',{on:{\"click\":_vm.codeGen}},[_vm._v(\"view generated code\")]),_c('button',{on:{\"click\":_vm.updateTechnique}},[_vm._v(\"updateTechnique\")]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showCode),expression:\"showCode\"}],staticClass:\"code-result\"},[_c('pre',[_vm._v(_vm._s(_vm.codeGenResult))])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.showCode),expression:\"!showCode\"}],staticClass:\"canvas-wrap\",on:{\"mouseenter\":_vm.start,\"mouseleave\":_vm.end}},[_c('canvas',{attrs:{\"id\":\"shader-editor-canvas\"}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\nimport {\r\n  RenderEngine, Mesh, Interactor, OrbitController, Shading,\r\n  ShaderGraph, PerspectiveCamera, Scene, NormalShading, SphereGeometry\r\n} from '../../src/artgl';\r\n\r\nexport class ShaderApplication {\r\n\r\n  canvas: HTMLCanvasElement;\r\n  graph: ShaderGraph = new ShaderGraph();\r\n  scene: Scene = new Scene();\r\n\r\n  shader: Shading;\r\n  mesh: Mesh;\r\n  orbitController: OrbitController;\r\n\r\n  engine: RenderEngine;\r\n\r\n\r\n  init(canvas: HTMLCanvasElement) {\r\n    this.canvas = canvas;\r\n    this.engine = new RenderEngine(canvas);\r\n    this.engine.camera.transform.position.set(20, 10, 10)\r\n    this.orbitController = new OrbitController(this.engine.camera as PerspectiveCamera);\r\n    this.orbitController.registerInteractor(this.engine.interactor);\r\n    this.shader = new Shading().decorate(new NormalShading());\r\n    this.loadScene();\r\n    this.tick();\r\n    this.start();\r\n\r\n    window.addEventListener('resize', this.onContainerResize);\r\n    this.onContainerResize();\r\n  }\r\n\r\n  updateShader() {\r\n    // const newConf = this.graph.compile();\r\n    // console.log(newConf)\r\n    // this.technique = new Technique({\r\n    //   programConfig: newConf\r\n    // });\r\n    // this.mesh.technique = this.technique;\r\n  }\r\n\r\n  loadScene() {\r\n    let testGeo = new SphereGeometry(1, 40, 40);\r\n    const mesh = new Mesh();\r\n    mesh.geometry = testGeo;\r\n    mesh.shading = this.shader;\r\n    this.mesh = mesh;\r\n    this.scene.root.addChild(mesh);\r\n  }\r\n\r\n  canvasRun: boolean = false;\r\n  start() {\r\n    this.canvasRun = true;\r\n  }\r\n\r\n  tick = () => {\r\n    if (this.canvasRun) {\r\n      this.render();\r\n    }\r\n    window.requestAnimationFrame(this.tick);\r\n  }\r\n\r\n  render() {\r\n    this.orbitController.update();\r\n    this.engine.connectCamera();\r\n    this.engine.render(this.scene);\r\n  }\r\n\r\n  uninit() {\r\n    this.canvas = null;\r\n    this.engine = null;\r\n  }\r\n\r\n  private onContainerResize = () => {\r\n    const width = this.canvas.offsetWidth;\r\n    const height = this.canvas.offsetHeight;\r\n    this.engine.setSize(width, height);\r\n    (this.engine.camera as PerspectiveCamera).aspect = width / height;\r\n  }\r\n\r\n\r\n}\r\n\r\n\r\nexport let ShaderApp: ShaderApplication = new ShaderApplication();","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\"\\n  \"+_vm._s(_vm.node.factory.name)+\"\\n\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { DAGNode, RenderTargetNode, ShaderFunctionNode } from \"../../../../../src/artgl\";\r\nimport { NodeLayout, GraphBoardInfo } from \"../../../model/graph-view\";\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class ShaderFunctionNodeView extends Vue {\r\n  @Prop({\r\n    required: true\r\n  })\r\n  node: ShaderFunctionNode;\r\n\r\n  @Prop({\r\n    required: true\r\n  })\r\n  layout: NodeLayout;\r\n  \r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/ts-loader/index.js??ref--12-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shader-function-node.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/ts-loader/index.js??ref--12-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shader-function-node.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./shader-function-node.vue?vue&type=template&id=0f053584&scoped=true&\"\nimport script from \"./shader-function-node.vue?vue&type=script&lang=ts&\"\nexport * from \"./shader-function-node.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f053584\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue, ProvideReactive } from \"vue-property-decorator\";\r\nimport { ShaderApp } from \"../shader-application\";\r\nimport {\r\n  injectFragmentShaderHeaders,\r\n  GLDataType\r\n} from \"../../../src/webgl/shader-util\";\r\nimport {\r\n  ShaderGraph,\r\n  uniform,\r\n  DAGNode,\r\n  TSSAOShading,\r\n  Shading\r\n} from \"../../../src/artgl\";\r\nimport DAGNodeView from \"../components/graph/dag-node.vue\";\r\nimport ShaderFunctionNodeView from \"../components/graph/nodes/shader-function-node.vue\";\r\nimport GraphView from \"../components/graph/graph-viewer.vue\";\r\nimport { ShaderNode, ShaderFunctionNode } from \"../../../src/shader-graph/shader-node\";\r\nimport LineHUDCanvas from \"./line-hud-canvas.vue\";\r\nimport {\r\n  GraphBoardInfo,\r\n  NodeLayout,\r\n  ViewNode,\r\n  ConnectionLine,\r\n  layoutGraph\r\n} from \"../model/graph-view\";\r\n\r\n@Component({\r\n  components: {\r\n    DAGNodeView,\r\n    GraphView,\r\n    LineHUDCanvas,\r\n    ShaderFunctionNodeView\r\n  }\r\n})\r\nexport default class ShaderEditor extends Vue {\r\n  showCode: boolean = false;\r\n  graph: ShaderGraph = null;\r\n  codeGenResult: string = \"\";\r\n\r\n  board: GraphBoardInfo = {\r\n    width: 0,\r\n    height: 0,\r\n    transformX: 0,\r\n    transformY: 0\r\n  };\r\n\r\n  @ProvideReactive() nodes: ViewNode[] = [];\r\n  @ProvideReactive() lines: ConnectionLine[] = [];\r\n\r\n  mounted() {\r\n    const canvas = this.$el.querySelector(\"#shader-editor-canvas\");\r\n    ShaderApp.init(canvas as HTMLCanvasElement);\r\n    this.graph = ShaderApp.shader.graph;\r\n\r\n    this.board.width = canvas.clientWidth;\r\n    this.board.height = canvas.clientHeight;\r\n\r\n    const tssaoShading = new TSSAOShading();\r\n    const tssaoShader = new Shading().decorate(tssaoShading);\r\n    tssaoShader.getProgramConfig();\r\n    this.nodes = tssaoShader.graph.nodes.map(node => {\r\n      return {\r\n        node,\r\n        layout: {\r\n          absX: 0,\r\n          absY: 0,\r\n          width: 200,\r\n          height: 200\r\n        }\r\n      };\r\n    });\r\n    this.layout(tssaoShader);\r\n    // this.graphView = GraphView.createFromShaderGraph(ShaderApp.graph);\r\n    console.log(this.graph);\r\n  }\r\n\r\n  layout(tssaoShader: Shading) {\r\n    const map = {};\r\n    this.nodes.forEach(node => {\r\n      map[node.node.uuid] = node.layout;\r\n    });\r\n    layoutGraph(tssaoShader.graph.fragmentRoot, map);\r\n  }\r\n\r\n  updateViewport(view: ViewNode) {\r\n    console.log(\"upd\");\r\n  }\r\n\r\n  isShaderFunctionNode(node) {\r\n    return node instanceof ShaderFunctionNode;\r\n  }\r\n\r\n  codeGen() {\r\n    this.showCode = true;\r\n    // const result = ShaderApp.graph.compile();\r\n    // this.codeGenResult = injectFragmentShaderHeaders(result, result.fragmentShaderString);\r\n  }\r\n\r\n  updateLine(node: DAGNode){\r\n    console.log('l')\r\n    this.notifyNodeNeedUpdateLine(node)\r\n    node.toNodes.forEach(no =>{\r\n      this.notifyNodeNeedUpdateLine(no);\r\n    })\r\n  }\r\n\r\n  notifyNodeNeedUpdateLine(n: DAGNode){\r\n    if(this.$refs.vueNodes){\r\n      for (let i = 0; i < (this.$refs.vueNodes as Array<DAGNodeView>).length; i++) {\r\n        const v = this.$refs.vueNodes[i];\r\n        if(v.node === n){\r\n          v.updateLine();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  addUniform() {\r\n    this.nodes.push({\r\n      node: uniform(\"unnamed\", GLDataType.float),\r\n      layout: {\r\n        absX: 0,\r\n        absY: 0,\r\n        width: 100,\r\n        height: 100\r\n      }\r\n    });\r\n  }\r\n\r\n  updateTechnique() {\r\n    ShaderApp.updateShader();\r\n  }\r\n\r\n  start() {\r\n    ShaderApp.start();\r\n  }\r\n\r\n  end() {\r\n    ShaderApp.canvasRun = false;\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shader-editor.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./shader-editor.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./shader-editor.vue?vue&type=template&id=71476dfb&scoped=true&\"\nimport script from \"./shader-editor.vue?vue&type=script&lang=ts&\"\nexport * from \"./shader-editor.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./shader-editor.vue?vue&type=style&index=0&id=71476dfb&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"71476dfb\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\r\nimport { Component, Prop, Vue } from 'vue-property-decorator';\r\nimport { NormalShading, DepthShading, TSSAOShading, Shading } from '../../../src/artgl';\r\n@Component({\r\n})\r\nexport default class Debug extends Vue {\r\n  mounted(){\r\n    console.log(\"debug\")\r\n    const tssaoShading = new TSSAOShading();\r\n    const tssaoShader = new Shading().decorate(tssaoShading);\r\n    console.log(tssaoShader)\r\n    console.log(tssaoShader.getProgramConfig());\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./debug.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/ts-loader/index.js??ref--12-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./debug.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./debug.vue?vue&type=template&id=18ff3916&\"\nimport script from \"./debug.vue?vue&type=script&lang=ts&\"\nexport * from \"./debug.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(\"Examples\")]),_vm._l((_vm.examples),function(example){return _c('div',{key:example.name,staticClass:\"example-entry\",on:{\"click\":function($event){return _vm.gotoExample(example.name)}}},[_vm._v(_vm._s(example.name))])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\n\r\n@Component({\r\n  components: {}\r\n})\r\nexport default class ConfigPanel extends Vue {\r\n  $store: any;\r\n  $router: any;\r\n\r\n  get examples(){\r\n    return this.$store.state.examples;\r\n  }\r\n\r\n  mounted() {\r\n  }\r\n\r\n  gotoExample(name) {\r\n    console.log(\"goto\");\r\n    this.$store.state.viewExample = name;\r\n    this.$router.push({\r\n      name: \"example\",\r\n      params: {\r\n        name\r\n      }\r\n    });\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-page.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-page.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./example-page.vue?vue&type=template&id=049970b3&scoped=true&\"\nimport script from \"./example-page.vue?vue&type=script&lang=ts&\"\nexport * from \"./example-page.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./example-page.vue?vue&type=style&index=0&id=049970b3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"049970b3\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(_vm._s(_vm.example.name))]),_c('div'),_vm._m(0),(_vm.exampleHasBuild)?_c('div',[(!_vm.isRunning)?_c('button',{on:{\"click\":_vm.start}},[_vm._v(\"start\")]):_vm._e(),(!_vm.isRunning)?_c('button',{on:{\"click\":_vm.step}},[_vm._v(\"step\")]):_vm._e(),(_vm.isRunning)?_c('button',{on:{\"click\":_vm.stop}},[_vm._v(\"stop\")]):_vm._e()]):_c('div',[_vm._v(\"example is in building\")]),(_vm.config)?_c('div',[_c('Config',{attrs:{\"config\":_vm.config}})],1):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('canvas')])}]\n\nexport { render, staticRenderFns }","import { Framer } from \"../../src/artgl\";\r\nimport { RenderConfig } from '../../viewer/src/components/conf/interface';\r\n\r\nexport interface TestBridge{\r\n  screenShotCompareElement(element: HTMLElement, goldenPath: string);\r\n\r\n  framer: Framer\r\n  testConfig?: RenderConfig\r\n}\r\n\r\n\r\nexport class ViewerTestBridge implements TestBridge {\r\n  async screenShotCompareElement(element: HTMLElement, goldenPath: string) { }\r\n\r\n  framer: Framer = new Framer(); \r\n  testConfig?: RenderConfig;\r\n\r\n  reset() {\r\n    this.framer = new Framer();\r\n    this.testConfig = undefined;\r\n  }\r\n}\r\n\r\nexport class HeadlessTestBridge implements TestBridge {\r\n\r\n  async screenShotCompareElement(element: HTMLElement, goldenPath: string) {\r\n    await window.screenShotCompareElement(element, goldenPath);\r\n   }\r\n\r\n  framer: Framer = new Framer(); \r\n\r\n}\r\n\r\nwindow.HeadlessTestBridge = HeadlessTestBridge\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Prop, Vue } from \"vue-property-decorator\";\r\nimport { ViewerTestBridge } from \"../../../../example/contents/test-bridge\";\r\nimport Config from \"../../components/conf/config.vue\";\r\nimport { RenderConfig } from \"../../components/conf/interface\";\r\n\r\nconst bridge = new ViewerTestBridge();\r\n\r\n@Component({\r\n  components: { Config }\r\n})\r\nexport default class ConfigPanel extends Vue {\r\n  $store: any;\r\n  $router: any;\r\n  $route: any;\r\n\r\n  config: RenderConfig = {\r\n    name: 'example config',\r\n    type: 'folder',\r\n    value: []\r\n  };\r\n\r\n  get example() {\r\n    this.$store.state.viewExample = this.$route.params.name;\r\n    for (let i = 0; i < this.$store.state.examples.length; i++) {\r\n      const example = this.$store.state.examples[i];\r\n      if (example.name === this.$store.state.viewExample) {\r\n        return example;\r\n      }\r\n    }\r\n    throw \"cant find example\";\r\n  }\r\n\r\n  exampleHasBuild: boolean = false;\r\n  isRunning: boolean = false;\r\n\r\n  start() {\r\n    bridge.framer.run();\r\n    this.isRunning = true;\r\n  }\r\n\r\n  stop() {\r\n    bridge.framer.stop();\r\n    this.isRunning = false;\r\n  }\r\n\r\n  step() {\r\n    bridge.framer.step();\r\n  }\r\n\r\n  async mounted() {\r\n    bridge.reset();\r\n    \r\n    await this.example.build(bridge);\r\n\r\n    if(bridge.testConfig !== undefined){\r\n      this.config.value.push(bridge.testConfig)\r\n    }\r\n\r\n    this.exampleHasBuild = true;\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-item-page.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/ts-loader/index.js??ref--12-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-item-page.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./example-item-page.vue?vue&type=template&id=3b7292a6&scoped=true&\"\nimport script from \"./example-item-page.vue?vue&type=script&lang=ts&\"\nexport * from \"./example-item-page.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./example-item-page.vue?vue&type=style&index=0&id=3b7292a6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3b7292a6\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport Router from 'vue-router'\r\nimport Home from './views/home.vue'\r\nimport Viewer from './views/viewer.vue'\r\nimport ShaderEditor from './views/shader-editor.vue'\r\nimport Debug from './views/debug.vue'\r\nimport ExampleView from './views/example/example-page.vue'\r\nimport ExampleItemView from './views/example/example-item-page.vue'\r\n\r\nVue.use(Router)\r\n\r\nexport default new Router({\r\n  routes: [\r\n    {\r\n      path: '/',\r\n      name: 'home',\r\n      component: Home\r\n    },\r\n    {\r\n      path: '/debug',\r\n      name: 'debug',\r\n      component: Debug\r\n    },\r\n    {\r\n      path: '/viewer',\r\n      name: 'viewer',\r\n      component: Viewer\r\n    },\r\n    {\r\n      path: '/shader',\r\n      name: 'shader-editor',\r\n      component: ShaderEditor\r\n    },\r\n    {\r\n      path: '/examples',\r\n      name: 'examples',\r\n      component: ExampleView\r\n    },\r\n    {\r\n      path: '/example/:name',\r\n      name: 'example',\r\n      component: ExampleItemView\r\n    },\r\n    {\r\n      path: '/about',\r\n      name: 'about',\r\n      // route level code-splitting\r\n      // this generates a separate chunk (about.[hash].js) for this route\r\n      // which is lazy-loaded when the route is visited.\r\n      component: () => import(/* webpackChunkName: \"about\" */ './views/About.vue')\r\n    }\r\n  ]\r\n})\r\n","import { TestBridge } from './test-bridge';\r\nimport {\r\n  Vector3, RenderRange, Vector4, RenderEngine, CullSide,\r\n  Scene, SphereGeometry, Mesh, PerspectiveCamera, OrbitController\r\n} from '../../src/artgl';\r\n\r\nexport default async function test(testBridge: TestBridge) {\r\n\r\n  //==>\r\n\r\n  let canvas = document.querySelector('canvas');\r\n  const engine = new RenderEngine(canvas);\r\n\r\n  const scene = new Scene();\r\n\r\n  const mesh = new Mesh();\r\n\r\n  const geometry = new SphereGeometry();\r\n  mesh.geometry = geometry;\r\n\r\n  const range = RenderRange.fromStandardGeometry(geometry);\r\n  mesh.range = range;\r\n  mesh.state.cullSide = CullSide.CullFaceNone;\r\n\r\n  scene.root.addChild(mesh);\r\n\r\n  const camera = engine.camera as PerspectiveCamera;\r\n  camera.transform.position.set(0, 0, 5);\r\n  camera.lookAt(new Vector3(0, 0, 0))\r\n\r\n  function draw() {\r\n    engine.connectCamera();\r\n    engine.renderer.state.colorbuffer.setClearColor(new Vector4(0.9, 0.9, 0.9, 1.0))\r\n    engine.renderer.state.colorbuffer.clear()\r\n    engine.render(scene);\r\n  }\r\n\r\n  draw();\r\n\r\n  //==<\r\n\r\n  await testBridge.screenShotCompareElement(canvas, \"test\");\r\n\r\n  const orbitController = new OrbitController(camera as PerspectiveCamera);\r\n  orbitController.registerInteractor(engine.interactor);\r\n\r\n  let allCount = range.count\r\n\r\n  testBridge.testConfig = {\r\n    name: 'width',\r\n    value: range.count,\r\n    onChange: (value: number) => {\r\n      range.count = value;\r\n    },\r\n    editors: [\r\n      {\r\n        type: 'slider',\r\n        min: 0,\r\n        max: allCount,\r\n        step: 1\r\n      },\r\n    ]\r\n  }\r\n\r\n  testBridge.framer.setFrame(() => {\r\n    orbitController.update();\r\n    draw();\r\n  })\r\n}\r\n","import { TestBridge } from './test-bridge';\r\nimport {\r\n  Vector3, RenderEngine, Scene, SphereGeometry, Mesh,\r\n  Line, Points, PerspectiveCamera, Vector4, OrbitController\r\n} from '../../src/artgl';\r\n\r\nexport default async function test(testBridge: TestBridge) {\r\n\r\n  //==>\r\n\r\n  let canvas = document.querySelector('canvas');\r\n  const engine = new RenderEngine(canvas);\r\n\r\n  const scene = new Scene();\r\n\r\n  const geometry = new SphereGeometry();\r\n\r\n  const mesh = new Mesh();\r\n  const line = new Line();\r\n  const points = new Points();\r\n\r\n  mesh.geometry = geometry;\r\n  line.geometry = geometry;\r\n  points.geometry = geometry;\r\n\r\n  line.transform.position.x = -5;\r\n  points.transform.position.x = 5;\r\n\r\n  scene.root.addChild(mesh);\r\n  scene.root.addChild(line);\r\n  scene.root.addChild(points);\r\n\r\n  const camera = engine.camera as PerspectiveCamera;\r\n  camera.transform.position.set(0, 0, 15);\r\n  camera.lookAt(new Vector3(0,0,0))\r\n\r\n  function draw() {\r\n    engine.connectCamera();\r\n    engine.renderer.state.colorbuffer.setClearColor(new Vector4(0.9, 0.9, 0.9, 1.0))\r\n    engine.renderer.state.colorbuffer.clear()\r\n    engine.render(scene);\r\n  }\r\n\r\n  draw();\r\n\r\n\r\n  //==<\r\n\r\n  await testBridge.screenShotCompareElement(canvas, \"test\");\r\n\r\n  const orbitController = new OrbitController(camera as PerspectiveCamera);\r\n  orbitController.registerInteractor(engine.interactor);\r\n\r\n  testBridge.framer.setFrame(() => {\r\n    orbitController.update();\r\n    draw();\r\n  })\r\n}\r\n","import renderRange from './render-range'\r\nimport testDrawPrimitive from './draw-primitives'\r\nimport { HeadlessTestBridge } from './test-bridge'\r\n\r\ntype ConstructorTypeOf<T> = new (...args: any[]) => T;\r\n\r\n// This should impl by node puppeteer, and exposed on headless window\r\n// declare function screenShotCompareElement(element: HTMLElement, goldenPath: string);\r\ndeclare global {\r\n  interface Window {\r\n    artglExamples: Example[],\r\n    HeadlessTestBridge: ConstructorTypeOf<HeadlessTestBridge>;\r\n    screenShotCompareElement(element: HTMLElement, goldenPath: string);\r\n  }\r\n}\r\n\r\ninterface Example{\r\n  name: string, \r\n  build: Function\r\n}\r\n\r\nexport const examples: Example[] = [\r\n  {\r\n    name: \"primitive\",\r\n    build: testDrawPrimitive\r\n  },\r\n  {\r\n    name: \"render range\",\r\n    build: renderRange\r\n  },\r\n];\r\n\r\n\r\nwindow.artglExamples = examples;\r\nwindow.HeadlessTestBridge = HeadlessTestBridge\r\n\r\n","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\n\r\nimport { examples } from \"../../example/contents/exports\";\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n  state: {\r\n    showConfigPanel: false,\r\n    showScenePanel: false,\r\n    examples,\r\n    viewExample: \"\",\r\n  },\r\n  mutations: {\r\n\r\n  },\r\n  actions: {\r\n\r\n  }\r\n})\r\n","import Vue from 'vue'\r\nimport App from './App.vue'\r\nimport router from './router'\r\nimport store from './store'\r\n\r\nVue.config.productionTip = false\r\n\r\nnew Vue({\r\n  router,\r\n  store,\r\n  render: h => h(App)\r\n}).$mount('#app')\r\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dag-node.vue?vue&type=style&index=0&id=f08e55ee&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dag-node.vue?vue&type=style&index=0&id=f08e55ee&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-item-page.vue?vue&type=style&index=0&id=3b7292a6&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./example-item-page.vue?vue&type=style&index=0&id=3b7292a6&lang=scss&scoped=true&\""],"sourceRoot":""}